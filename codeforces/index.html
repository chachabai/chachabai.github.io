<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Codeforces 汇总 | dna049</title><meta name="description" content="最近感觉自己又行了。就很想重新开始打 Codeforces，这里罗列一下从 2020&#x2F;05&#x2F;16 开始提交的(不是特别水的）AC 代码。想有生之年上一次黄，先定个小目标上个 1900（最高 1854，当前 1829，换号了！新账号于 2020&#x2F;11&#x2F;18 达成 1900+ 成就，紫名:)也太好看了吧）菜鸡 dna049 加油 下班了！  不再打除了 codeforces, atcoder, 洛谷之"><meta name="keywords" content="Math,C++,Codeforces,图论"><meta name="author" content="dna049"><meta name="copyright" content="dna049"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/dna049.png"><link rel="canonical" href="https://dna049.com/codeforces/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta property="og:type" content="article"><meta property="og:title" content="Codeforces 汇总"><meta property="og:url" content="https://dna049.com/codeforces/"><meta property="og:site_name" content="dna049"><meta property="og:description" content="最近感觉自己又行了。就很想重新开始打 Codeforces，这里罗列一下从 2020&#x2F;05&#x2F;16 开始提交的(不是特别水的）AC 代码。想有生之年上一次黄，先定个小目标上个 1900（最高 1854，当前 1829，换号了！新账号于 2020&#x2F;11&#x2F;18 达成 1900+ 成就，紫名:)也太好看了吧）菜鸡 dna049 加油 下班了！  不再打除了 codeforces, atcoder, 洛谷之"><meta property="og:image" content="https://i.loli.net/2020/08/31/3K2pQYJoyl81Cwf.jpg"><meta property="article:published_time" content="2020-05-22T09:32:11.000Z"><meta property="article:modified_time" content="2020-12-31T13:56:38.106Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = '2'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?79cbe4231606af28625413fd5210e0b3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '4.2.0',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: {"text":"富强,民主,文明,和谐,自由,平等,公正,法治,爱国,敬业,诚信,友善","fontSize":"18px"},
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: true    
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-12-31 21:56:38'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="dna049" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="/img/dna049.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">84</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">23</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/templateOfCpp"><i class="fa-fw fas fa-heart"></i><span> C++模板</span></a></div><div class="menus_item"><a class="site-page" href="/random.html"><i class="fa-fw fa fa-random"></i><span> 随机文章</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heartbeat"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fas fa-calendar"></i><span> 工具类网站</span></a></div></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div id="sidebar"><i class="fas fa-arrow-right" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#准备工作"><span class="toc-number">1.</span> <span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#题集"><span class="toc-number">2.</span> <span class="toc-text">题集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1466A：线段上-n-个点，两两距离差值的所有可能个数"><span class="toc-number">2.1.</span> <span class="toc-text">1466A：线段上 $n$ 个点，两两距离差值的所有可能个数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1466E：求和"><span class="toc-number">2.2.</span> <span class="toc-text">1466E：求和</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1466F：-mathbb-Z-2-上-m-维向量线性无关组"><span class="toc-number">2.3.</span> <span class="toc-text">1466F：$\mathbb{Z}_2$ 上 $m$ 维向量线性无关组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1465D：观察结果题"><span class="toc-number">2.4.</span> <span class="toc-text">1465D：观察结果题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1465E：观察题"><span class="toc-number">2.5.</span> <span class="toc-text">1465E：观察题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1450H：圆上配对问题"><span class="toc-number">2.6.</span> <span class="toc-text">1450H：圆上配对问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1453D：简单概率题"><span class="toc-number">2.7.</span> <span class="toc-text">1453D：简单概率题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1455B：简单被卡题"><span class="toc-number">2.8.</span> <span class="toc-text">1455B：简单被卡题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1455E：好玩的问题"><span class="toc-number">2.9.</span> <span class="toc-text">1455E：好玩的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1456A：经典-DP"><span class="toc-number">2.10.</span> <span class="toc-text">1456A：经典 DP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1456B：XOR-问题"><span class="toc-number">2.11.</span> <span class="toc-text">1456B：XOR 问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AtCoder-abc184F：假-0-1-背包，Meet-in-Middle"><span class="toc-number">2.12.</span> <span class="toc-text">AtCoder abc184F：假 0-1 背包，Meet in Middle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1451E：交互题"><span class="toc-number">2.13.</span> <span class="toc-text">1451E：交互题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1451D：很好博弈问题"><span class="toc-number">2.14.</span> <span class="toc-text">1451D：很好博弈问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1451C"><span class="toc-number">2.15.</span> <span class="toc-text">1451C</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1452E：特别难的复杂度降低问题，经典问题，注意转化"><span class="toc-number">2.16.</span> <span class="toc-text">1452E：特别难的复杂度降低问题，经典问题，注意转化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1452F：经典观察贪心问题"><span class="toc-number">2.17.</span> <span class="toc-text">1452F：经典观察贪心问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1440C：模拟题"><span class="toc-number">2.18.</span> <span class="toc-text">1440C：模拟题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1440D：图论乱搞"><span class="toc-number">2.19.</span> <span class="toc-text">1440D：图论乱搞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1440E-线段树"><span class="toc-number">2.20.</span> <span class="toc-text">1440E: 线段树</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1447B：简单细节题"><span class="toc-number">2.21.</span> <span class="toc-text">1447B：简单细节题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1447C：经典问题：假-0-1-背包，真贪心"><span class="toc-number">2.22.</span> <span class="toc-text">1447C：经典问题：假 0-1 背包，真贪心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1447D：DP"><span class="toc-number">2.23.</span> <span class="toc-text">1447D：DP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#144E：思维题"><span class="toc-number">2.24.</span> <span class="toc-text">144E：思维题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AtCoder-ABC-183f：并查集-map"><span class="toc-number">2.25.</span> <span class="toc-text">AtCoder ABC 183f：并查集 + map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AtCoder-ABC-183e：经典-DP"><span class="toc-number">2.26.</span> <span class="toc-text">AtCoder ABC 183e：经典 DP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1438-数学场"><span class="toc-number">2.27.</span> <span class="toc-text">1438 数学场</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Atcoder-ABC182F：找钱问题"><span class="toc-number">2.28.</span> <span class="toc-text">Atcoder ABC182F：找钱问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#凸优化借助凸包解决"><span class="toc-number">2.29.</span> <span class="toc-text">凸优化借助凸包解决</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Atcoder-arc107C：并查集"><span class="toc-number">2.30.</span> <span class="toc-text">Atcoder arc107C：并查集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Atcoder-arc107D：经典计算，DP-优化"><span class="toc-number">2.31.</span> <span class="toc-text">Atcoder arc107D：经典计算，DP 优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1442D：经典分治问题"><span class="toc-number">2.32.</span> <span class="toc-text">1442D：经典分治问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1443D：经典问题"><span class="toc-number">2.33.</span> <span class="toc-text">1443D：经典问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1445D：一个-trival-的脑力问题"><span class="toc-number">2.34.</span> <span class="toc-text">1445D：一个 trival 的脑力问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1437C：经典问题之动态规划"><span class="toc-number">2.35.</span> <span class="toc-text">1437C：经典问题之动态规划</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1437E：最长递增子序列"><span class="toc-number">2.36.</span> <span class="toc-text">1437E：最长递增子序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1435C：经典选择问题"><span class="toc-number">2.37.</span> <span class="toc-text">1435C：经典选择问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1435D：经典进出问题"><span class="toc-number">2.38.</span> <span class="toc-text">1435D：经典进出问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AtCoder-arc106d：经典求和计算"><span class="toc-number">2.39.</span> <span class="toc-text">AtCoder arc106d：经典求和计算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1436E-MEX"><span class="toc-number">2.40.</span> <span class="toc-text">1436E: MEX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hdu-4747-MEX"><span class="toc-number">2.41.</span> <span class="toc-text">hdu 4747: MEX</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1433G-将某条边的权值置零下最短路径"><span class="toc-number">2.42.</span> <span class="toc-text">1433G: 将某条边的权值置零下最短路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#439D：三分法模板题"><span class="toc-number">2.43.</span> <span class="toc-text">439D：三分法模板题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三分法求凸函数最值"><span class="toc-number">2.44.</span> <span class="toc-text">三分法求凸函数最值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1421A：异或，和，交的关系"><span class="toc-number">2.45.</span> <span class="toc-text">1421A：异或，和，交的关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1421E：观察总结题"><span class="toc-number">2.46.</span> <span class="toc-text">1421E：观察总结题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1428D：模拟题"><span class="toc-number">2.47.</span> <span class="toc-text">1428D：模拟题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1428E：经典问题，正整数划分最值问题（可看作优先队列模板题）"><span class="toc-number">2.48.</span> <span class="toc-text">1428E：经典问题，正整数划分最值问题（可看作优先队列模板题）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1428F-经典-DP"><span class="toc-number">2.49.</span> <span class="toc-text">1428F: 经典 DP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1430F：反向-DP"><span class="toc-number">2.50.</span> <span class="toc-text">1430F：反向 DP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1430E：可以转化成求逆序数"><span class="toc-number">2.51.</span> <span class="toc-text">1430E：可以转化成求逆序数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#清华集训-2016-组合数问题"><span class="toc-number">2.52.</span> <span class="toc-text">清华集训 2016 组合数问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#清华集训-2016-求和"><span class="toc-number">2.53.</span> <span class="toc-text">清华集训 2016 求和</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZOJ-3820：树的重心-直径"><span class="toc-number">2.54.</span> <span class="toc-text">ZOJ 3820：树的重心 + 直径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1422D：堆优化-Dijkstra-复杂度-O-n-log-E"><span class="toc-number">2.55.</span> <span class="toc-text">1422D：堆优化 Dijkstra 复杂度 $O(n \log E)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1422C"><span class="toc-number">2.56.</span> <span class="toc-text">1422C</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Atcoder-ARC-104D"><span class="toc-number">2.57.</span> <span class="toc-text">Atcoder ARC 104D</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1408D：二维处理问题，经典重要问题"><span class="toc-number">2.58.</span> <span class="toc-text">1408D：二维处理问题，经典重要问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1408F：脑筋急转弯问题"><span class="toc-number">2.59.</span> <span class="toc-text">1408F：脑筋急转弯问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1408I"><span class="toc-number">2.60.</span> <span class="toc-text">1408I</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#453B：状态压缩-DP"><span class="toc-number">2.61.</span> <span class="toc-text">453B：状态压缩 DP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#662C：状态压缩-DP-FWT-模板"><span class="toc-number">2.62.</span> <span class="toc-text">662C：状态压缩 DP + FWT 模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1417E：异或问题和逆序数"><span class="toc-number">2.63.</span> <span class="toc-text">1417E：异或问题和逆序数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AtCoder-ACL2f-包容排斥原理-NFT"><span class="toc-number">2.64.</span> <span class="toc-text">AtCoder ACL2f: 包容排斥原理 + NFT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AtCoder-ACL2e：线段树模板题"><span class="toc-number">2.65.</span> <span class="toc-text">AtCoder ACL2e：线段树模板题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AtCoder-ABC178e：Manhattan-距离"><span class="toc-number">2.66.</span> <span class="toc-text">AtCoder ABC178e：Manhattan 距离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1406D：经典数学题"><span class="toc-number">2.67.</span> <span class="toc-text">1406D：经典数学题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1407B：GCD-问题"><span class="toc-number">2.68.</span> <span class="toc-text">1407B：GCD 问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1407C：第一次过真实的交互问题"><span class="toc-number">2.69.</span> <span class="toc-text">1407C：第一次过真实的交互问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1407D：贪心即可"><span class="toc-number">2.70.</span> <span class="toc-text">1407D：贪心即可</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1405D：树的直径"><span class="toc-number">2.71.</span> <span class="toc-text">1405D：树的直径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1405E：高端树状数组"><span class="toc-number">2.72.</span> <span class="toc-text">1405E：高端树状数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1401D：用-dfs-变成有根树，求出每条边的权重，存在第二次到达的节点上，然后给权重高的边赋大值即可"><span class="toc-number">2.73.</span> <span class="toc-text">1401D：用 dfs 变成有根树，求出每条边的权重，存在第二次到达的节点上，然后给权重高的边赋大值即可</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1401E"><span class="toc-number">2.74.</span> <span class="toc-text">1401E</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HDU-6838-Battle-for-Wosneth"><span class="toc-number">2.75.</span> <span class="toc-text">HDU 6838 Battle for Wosneth</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HDU-6842-Battle-for-Wosneth2"><span class="toc-number">2.76.</span> <span class="toc-text">HDU 6842 Battle for Wosneth2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1399D-01序列分组，使得各组相邻元素不同（主要考察复杂度，超级容易-TLE）"><span class="toc-number">2.77.</span> <span class="toc-text">1399D: 01序列分组，使得各组相邻元素不同（主要考察复杂度，超级容易 TLE）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1399E1：dfs-建树，然后就知道每条边的权重，然后有限队列贪心即可，注意是所有叶子节点到根的距离和"><span class="toc-number">2.78.</span> <span class="toc-text">1399E1：dfs 建树，然后就知道每条边的权重，然后有限队列贪心即可，注意是所有叶子节点到根的距离和</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1399E2-同-E1，只是贪心的时候，枚举费用为-2-的边的个数"><span class="toc-number">2.79.</span> <span class="toc-text">1399E2:  同 E1，只是贪心的时候，枚举费用为 2 的边的个数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1399F-区间-dp-问题"><span class="toc-number">2.80.</span> <span class="toc-text">1399F :  区间 dp 问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1389F：二分图"><span class="toc-number">2.81.</span> <span class="toc-text">1389F：二分图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1384D：两个人轮流取-n-个数，比较它们取的数的异或值，较大的赢"><span class="toc-number">2.82.</span> <span class="toc-text">1384D：两个人轮流取 $n$ 个数，比较它们取的数的异或值，较大的赢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1384B：很有意思的一道模拟题，我也不知道为什么我要想这么久，太菜了"><span class="toc-number">2.83.</span> <span class="toc-text">1384B：很有意思的一道模拟题，我也不知道为什么我要想这么久，太菜了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#洛谷-U122053-选择题：经典问题：每个人说另一个人是不是好人，-好人只说真话，坏人只说慌话，输出有多少种可能的情况，并输出可能的情况下，最多的好人和最少的好人数"><span class="toc-number">2.84.</span> <span class="toc-text">洛谷 U122053 选择题：经典问题：每个人说另一个人是不是好人， 好人只说真话，坏人只说慌话，输出有多少种可能的情况，并输出可能的情况下，最多的好人和最少的好人数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#洛谷-U122055-出生点-：简单包容排斥"><span class="toc-number">2.85.</span> <span class="toc-text">洛谷 U122055 出生点 ：简单包容排斥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#洛谷-U122054-强迫症-圆上-n-个点构成的无交错边的图的个数-f-n"><span class="toc-number">2.86.</span> <span class="toc-text">洛谷 U122054 强迫症 : 圆上 $n$ 个点构成的无交错边的图的个数 $f_n$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1382D-：0-1-背包问题"><span class="toc-number">2.87.</span> <span class="toc-text">1382D ：0-1 背包问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1382C-：设-f-0-1string-gt-0-1string将字符串-0-换成-1，1-换成-0，然后倒序。给定长度为-n-的字符串-a-b-。每次可以改变-a-的前缀，给出一种方案（不超过-3n-，或者不超过-2n-）"><span class="toc-number">2.88.</span> <span class="toc-text">1382C ：设 f: 0-1string ---&gt; 0-1string将字符串 0 换成 1，1 换成 0，然后倒序。给定长度为 $n$ 的字符串$a, b$ 。每次可以改变 $a$ 的前缀，给出一种方案（不超过 $3n$，或者不超过 $2n$ ）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#百度之星-2020-初赛-1008：数论函数题"><span class="toc-number">2.89.</span> <span class="toc-text">百度之星 2020 初赛 1008：数论函数题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Atcode：经典生成函数题"><span class="toc-number">2.90.</span> <span class="toc-text">Atcode：经典生成函数题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1215E：给定长度为-n-数据范围-1-20-的数组，求最少交换相邻位置元素使得相同的数字都紧挨着"><span class="toc-number">2.91.</span> <span class="toc-text">1215E：给定长度为 $n$ 数据范围 $[1,20]$ 的数组，求最少交换相邻位置元素使得相同的数字都紧挨着</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1228E：（二维）包容排斥原理"><span class="toc-number">2.92.</span> <span class="toc-text">1228E：（二维）包容排斥原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1148B：在一次转机的旅行中，取消-k-个航班，使得旅客最晚达到终点"><span class="toc-number">2.93.</span> <span class="toc-text">1148B：在一次转机的旅行中，取消 $k$ 个航班，使得旅客最晚达到终点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1251F-组成周长固定的先单调递增后单调递减的序列"><span class="toc-number">2.94.</span> <span class="toc-text">1251F:  组成周长固定的先单调递增后单调递减的序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1251E-花最少的钱，让所有人都投票给自己（选民跟风且贪财）"><span class="toc-number">2.95.</span> <span class="toc-text">1251E:  花最少的钱，让所有人都投票给自己（选民跟风且贪财）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1375D-MEX-once-more，通过修改数组的某一个值成-mex，使得数组最终非降"><span class="toc-number">2.96.</span> <span class="toc-text">1375D: MEX once more，通过修改数组的某一个值成 mex，使得数组最终非降</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1119C-选取-4-个角，反位，使得-A-矩阵变成-B-矩阵"><span class="toc-number">2.97.</span> <span class="toc-text">1119C: 选取 4 个角，反位，使得 A 矩阵变成 B 矩阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1110：打麻将-0-0"><span class="toc-number">2.98.</span> <span class="toc-text">1110：打麻将 0.0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1371E：给定长为-n-的数组和素数-p-，记满足-x-i-lt-a-sigma-i-0-leq-i-lt-n-的排列个数为-f-x-，输出所有-x-使得-p-not-n"><span class="toc-number">2.99.</span> <span class="toc-text">1371E：给定长为 $n$ 的数组和素数 $p$，记满足 $x+i &lt; a_{\sigma(i)},0\leq i&lt;n$ 的排列个数为 $f(x)$，输出所有 $x$ 使得 $p \not | n$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1245F：经典-XOR-递归"><span class="toc-number">2.100.</span> <span class="toc-text">1245F：经典 XOR 递归</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1373F：-f-x-表示非负整数-x-的十进制表示的各位数之和。求最小的非负整数-x-使得-sum-i-0-k-f-x-i-n"><span class="toc-number">2.101.</span> <span class="toc-text">1373F：$f(x)$ 表示非负整数 $x$ 的十进制表示的各位数之和。求最小的非负整数 $x$ 使得 $\sum_{i&#x3D;0} ^k f(x+i) &#x3D; n$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1355B-：贪心模仿加法进位"><span class="toc-number">2.102.</span> <span class="toc-text">1355B ：贪心模仿加法进位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1354C-：计算包含单位正-n-边形的最小正方形的边长"><span class="toc-number">2.103.</span> <span class="toc-text">1354C  ：计算包含单位正 $n$ 边形的最小正方形的边长</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1354D-：模拟操作：-加数字或删除第-k-小的数"><span class="toc-number">2.104.</span> <span class="toc-text">1354D ：模拟操作： 加数字或删除第 $k$ 小的数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1354F-：经典-DP-问题"><span class="toc-number">2.105.</span> <span class="toc-text">1354F ：经典 DP 问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1345F-：经典二分，利用二阶偏导（离散偏导，即增量）是常量"><span class="toc-number">2.106.</span> <span class="toc-text">1345F ：经典二分，利用二阶偏导（离散偏导，即增量）是常量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1325B：Set-的用法举例"><span class="toc-number">2.107.</span> <span class="toc-text">1325B：Set 的用法举例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1325D：（异或）位运算：判断是否有-n-个数，异或和为-u-和为-v"><span class="toc-number">2.108.</span> <span class="toc-text">1325D：（异或）位运算：判断是否有 $n$ 个数，异或和为 $u$, 和为 $v$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1358D：给定区间最值问题，但是可以写的很漂亮"><span class="toc-number">2.109.</span> <span class="toc-text">1358D：给定区间最值问题，但是可以写的很漂亮</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1358E：很有意思的数据处理题目，官方题解"><span class="toc-number">2.110.</span> <span class="toc-text">1358E：很有意思的数据处理题目，官方题解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1359C-读题被坑…-反正就是倒冷热水接近给定温度）"><span class="toc-number">2.111.</span> <span class="toc-text">1359C:  读题被坑…(反正就是倒冷热水接近给定温度）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1359D：线段树，但是由于数据特殊，可以不用线段树"><span class="toc-number">2.112.</span> <span class="toc-text">1359D：线段树，但是由于数据特殊，可以不用线段树</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1359E：找到公式后就是模素数组合数"><span class="toc-number">2.113.</span> <span class="toc-text">1359E：找到公式后就是模素数组合数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1363E：有根数，互换子树的节点位数到预定值，dfs-和图存储范例"><span class="toc-number">2.114.</span> <span class="toc-text">1363E：有根数，互换子树的节点位数到预定值，dfs 和图存储范例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1361E-：下面代码至今没过我也是没懂为什么"><span class="toc-number">2.115.</span> <span class="toc-text">1361E ：下面代码至今没过我也是没懂为什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1349F-：神奇的对应"><span class="toc-number">2.116.</span> <span class="toc-text">1349F ：神奇的对应</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1365E：这题其实没啥，但是比赛的时候竟然把-想成了-，很烦"><span class="toc-number">2.117.</span> <span class="toc-text">1365E：这题其实没啥，但是比赛的时候竟然把 | 想成了 ^ ，很烦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1312D：计算满足条件的数列个数"><span class="toc-number">2.118.</span> <span class="toc-text">1312D：计算满足条件的数列个数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1312E：经典-DP，解释放在"><span class="toc-number">2.119.</span> <span class="toc-text">1312E：经典 DP，解释放在 动态规划</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1295E：题解，相当精彩的线段树实例"><span class="toc-number">2.120.</span> <span class="toc-text">1295E：题解，相当精彩的线段树实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1295F：给定区间的非降序列概率（个数）"><span class="toc-number">2.121.</span> <span class="toc-text">1295F：给定区间的非降序列概率（个数）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1364C：已知-a-i-MEX-b-1-cdots-b-i-为不出现在-b-1-cdots-b-i-中的最小非负整数，在给定-0-leq-a-i-leq-i-a-i-lt-a-i-1-的情况下，给出一种-b-i-的方案"><span class="toc-number">2.122.</span> <span class="toc-text">1364C：已知 $a_i&#x3D;MEX({b_1,\cdots,b_i})$ 为不出现在 $b_1,\cdots,b_i$ 中的最小非负整数，在给定 $0\leq a_i \leq i,a_i&lt;a_{i+1}$ 的情况下，给出一种 $b_i$ 的方案</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1367E：不难但是很有趣的数学题"><span class="toc-number">2.123.</span> <span class="toc-text">1367E：不难但是很有趣的数学题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1367F：给定规则最小步骤使得数列有序"><span class="toc-number">2.124.</span> <span class="toc-text">1367F：给定规则最小步骤使得数列有序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1368B：简单的问题比赛的时候无语的想复杂了！然后就是参看-tourist-男神的优雅代码"><span class="toc-number">2.125.</span> <span class="toc-text">1368B：简单的问题比赛的时候无语的想复杂了！然后就是参看 tourist 男神的优雅代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1368D：一眼看出！哎要不是-B-题被卡了，我决定能上大分！好气"><span class="toc-number">2.126.</span> <span class="toc-text">1368D：一眼看出！哎要不是 B 题被卡了，我决定能上大分！好气</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1285D：比赛的时候想到了，但是怕复杂度过补了，能过复杂度是因为每个元素-a-最多递归-log-a-次"><span class="toc-number">2.127.</span> <span class="toc-text">1285D：比赛的时候想到了，但是怕复杂度过补了，能过复杂度是因为每个元素 $a$ 最多递归 $\log a$ 次</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1285C：找出使得-max-a-b-最小并使得-lcm-a-b-x-的最小-a-b"><span class="toc-number">2.128.</span> <span class="toc-text">1285C：找出使得$\max(a,b)$最小并使得$lcm(a,b)&#x3D;x$的最小$a,b$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1285F：一道很秀的-lcm-题，计算-displaystyle-max-1-leq-i-lt-j-leq-n-lcm-a-i-a-j"><span class="toc-number">2.129.</span> <span class="toc-text">1285F：一道很秀的 lcm 题，计算 $\displaystyle \max_{1\leq i&lt; j \leq n} lcm(a_i,a_j)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1370D：在长为-n-的序列中找一个长为-k-的子列，子列中奇数项最大值和偶数项最大值的最小值最小"><span class="toc-number">2.130.</span> <span class="toc-text">1370D：在长为 n 的序列中找一个长为 k 的子列，子列中奇数项最大值和偶数项最大值的最小值最小</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1370E：找出最少的轮换使得字符串-s-变成-t"><span class="toc-number">2.131.</span> <span class="toc-text">1370E：找出最少的轮换使得字符串 s 变成 t</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1263D：Set-lt-int-gt-集合操作范例"><span class="toc-number">2.132.</span> <span class="toc-text">1263D：Set&lt;int&gt; 集合操作范例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1369D-组合计数问题"><span class="toc-number">2.133.</span> <span class="toc-text">1369D:  组合计数问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1369F：博弈题"><span class="toc-number">2.134.</span> <span class="toc-text">1369F：博弈题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#300iq-Contest-3"><span class="toc-number">3.</span> <span class="toc-text">300iq Contest 3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#A-Airplane-Cliques"><span class="toc-number">3.1.</span> <span class="toc-text">A. Airplane Cliques</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#C-Cells-Blocking"><span class="toc-number">3.2.</span> <span class="toc-text">C. Cells Blocking</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#E-Easy-Win"><span class="toc-number">3.3.</span> <span class="toc-text">E. Easy Win</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#I-Ignore-Submasks"><span class="toc-number">3.4.</span> <span class="toc-text">I. Ignore Submasks</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#补充和强化知识"><span class="toc-number">4.</span> <span class="toc-text">补充和强化知识</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#图论"><span class="toc-number">5.</span> <span class="toc-text">图论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#图的存储"><span class="toc-number">5.1.</span> <span class="toc-text">图的存储</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DFS（深度优先搜索）"><span class="toc-number">5.2.</span> <span class="toc-text">DFS（深度优先搜索）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BFS（广度优先搜索）"><span class="toc-number">5.3.</span> <span class="toc-text">BFS（广度优先搜索）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#无根树的-Prufer-序列"><span class="toc-number">5.4.</span> <span class="toc-text">无根树的 Prufer 序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有根树的-Euler-序列"><span class="toc-number">5.5.</span> <span class="toc-text">有根树的 Euler 序列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最近公共祖先简称-LCA（Lowest-Common-Ancestor）"><span class="toc-number">5.6.</span> <span class="toc-text">最近公共祖先简称 LCA（Lowest Common Ancestor）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有向图的拓扑排序之-Kahn-算法"><span class="toc-number">5.7.</span> <span class="toc-text">有向图的拓扑排序之 Kahn 算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有向图最小生成树的-Kruskal-算法（更推荐）"><span class="toc-number">5.8.</span> <span class="toc-text">有向图最小生成树的 Kruskal 算法（更推荐）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（有向图）最小生成树的-Prim-算法"><span class="toc-number">5.9.</span> <span class="toc-text">（有向图）最小生成树的 Prim 算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#（有向图）的次小生成树（下次一定）"><span class="toc-number">5.10.</span> <span class="toc-text">（有向图）的次小生成树（下次一定）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最小树形图（有向图的最小生成树）的-朱刘算法"><span class="toc-number">5.11.</span> <span class="toc-text">最小树形图（有向图的最小生成树）的 朱刘算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#强连通分量的-Kosaraju-算法"><span class="toc-number">5.12.</span> <span class="toc-text">强连通分量的 Kosaraju 算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#强连通分量的-Tarjan-算法"><span class="toc-number">5.13.</span> <span class="toc-text">强连通分量的 Tarjan 算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二分图的匈牙利算法：dfs-硬搞"><span class="toc-number">5.14.</span> <span class="toc-text">二分图的匈牙利算法：dfs 硬搞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Kirchhoff-矩阵树定理：解决了一张图的生成树个数计数问题"><span class="toc-number">5.15.</span> <span class="toc-text">Kirchhoff 矩阵树定理：解决了一张图的生成树个数计数问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#生成函数"><span class="toc-number">6.</span> <span class="toc-text">生成函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#耻辱记录"><span class="toc-number">7.</span> <span class="toc-text">耻辱记录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#记录"><span class="toc-number">8.</span> <span class="toc-text">记录</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2020/08/31/3K2pQYJoyl81Cwf.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">dna049</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/templateOfCpp"><i class="fa-fw fas fa-heart"></i><span> C++模板</span></a></div><div class="menus_item"><a class="site-page" href="/random.html"><i class="fa-fw fa fa-random"></i><span> 随机文章</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heartbeat"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/tools/"><i class="fa-fw fas fa-calendar"></i><span> 工具类网站</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Codeforces 汇总</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-05-22T09:32:11.000Z" title="发表于 2020-05-22 17:32:11">2020-05-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-12-31T13:56:38.106Z" title="更新于 2020-12-31 21:56:38">2020-12-31</time></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">52.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>276分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>最近感觉自己又行了。就很想重新开始打 <a href="https://codeforces.com" target="_blank" rel="noopener">Codeforces</a>，这里罗列一下从 2020/05/16 开始提交的(不是特别水的）AC 代码。想有生之年上一次黄，先定个小目标上个 1900（最高 1854，当前 1829，换号了！新账号于 2020/11/18 达成 1900+ 成就，紫名:)也太好看了吧）菜鸡 dna049 <del>加油</del> 下班了！</p>
<blockquote>
<p>不再打除了 codeforces, atcoder, 洛谷之外的日常比赛。有空整理一下比赛，好的题目或比赛记得 star。<br><strong>优雅的代码极大的避免了低级错误</strong>，边界处理至少占三分之一的工作量！</p>
<p><strong>不要急着写代码，不要急着写代码，不要急着写代码，重要的事情说三遍！！！</strong><br>优先做 Codeforces, Atcoder, 其它平台的题目可以在 vjudge 中提交（洛谷和 UOJ 除外)，POJ 和 HDU 不在搞了。<br>不要为了补题，Rating，浪费太多的时间<br>把一个问题写成简洁清晰的代码，才算是真的理解了问题！代码能力是快速综合规划的能力。<br>至少先上 2100，再去写博客，分低会影响博客的质量！</p>
</blockquote>
<a id="more"></a>
<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>珍惜每一场比赛，不要怕掉分，<strong>提前 6 分钟</strong>，准备以下事情（加号表示有用次数，2021 年开始计算）：</p>
<ol>
<li>如果没注册，赶紧注册</li>
<li>闹钟（每个题不要长期思考，读完题没明显思路直接跳！） +1</li>
<li>纸和笔（ipad + pencil + 闹钟 亦可）+0（表示：永远有用）</li>
<li>SageMath，用于一些数据测试</li>
<li>打开自己的网站用于模板 +0</li>
<li>打开 VScode，查看 CF 比赛号，开始 <code>cf race CF 比赛号</code> +0</li>
<li>计算式要列的清晰，并且最好是好输入的（think twice, code once)。+1</li>
<li>不要膨胀，老老实实先做简单题，没思路就直接跳过（拒绝拖延，但是一定记得要回来把简单题补了！）</li>
<li>有思路赶紧写（但是思路清晰再写！无论问题难与否，大家都是一样的，打好自己！），不要觉得时间很多</li>
<li>开 room hack！锁题前检查边界，不要最后 RE 了</li>
<li>前面题目被卡会特别影响做后面题的心态！</li>
<li>注意到题目中简单的性质结论都应该写下来，拼一下可能就知道怎么做了。注意特殊问题的特殊解法。</li>
<li>WA 之后，很可能方法错了，或者代码有问题，没有本质修改的话，不要乱提交！</li>
<li>有子问题的题目，两个都会做，先交分数小的。</li>
<li><strong>不要写这样的代码</strong>：<code>if(a[j++]), while(a[j++])</code> 这种数列下标自加，特别容易出问题还不好查，特别在判断语句中。</li>
<li>$N=10^{18}$ 一般会有公式， $N = 2 \cdot 10^5$ 一般会用到排序、树状数组，线段树，等一系列 $O(n \log n)$ 算法，$N=1000$ 一般会用到 $dp$。模 <code>998244353</code> 可能会用到 NFT。</li>
</ol>
<p>Codeforces 比赛规则：每题有基础分数，每题的分数根据时间线性递减到一半（所以有些大佬先做 CD，再做 AB），在最后一次提交前每次提交减 50 分，然后按照分数排名，有 hack，但是只有你过了初例并且 <strong>锁定题目</strong> 才能 hack。<br>Eductional 比赛规则：与 ICPC 一致，不过一次非 AC 提交罚时为 10 分钟（ICPC 20 分钟），难度比 Div2 稍难，需要更细心。</p>
<p>Codeforces Gobal Round：<del>目前实力不支持做这个，容易掉分！</del> 正常发挥都是能加分的！</p>
<p><a href="https://codeforces.com/problemset/standings?friendsEnabled=on" target="_blank" rel="noopener">查看 Codeforces 上的过题数</a>，<a href="https://codeforces.com/contests/with/dna049" target="_blank" rel="noopener">查看比赛 rating 折线</a>，开始使用 <a href="https://github.com/xalanq/cf-tool/blob/master/README_zh_CN.md" target="_blank" rel="noopener">cf-tool</a> + WSL 打比赛（真香）。</p>
<h2 id="题集"><a href="#题集" class="headerlink" title="题集"></a>题集</h2><h3 id="1466A：线段上-n-个点，两两距离差值的所有可能个数"><a href="#1466A：线段上-n-个点，两两距离差值的所有可能个数" class="headerlink" title="1466A：线段上 $n$ 个点，两两距离差值的所有可能个数"></a><a href="https://codeforces.com/contest/1466/problem/A" target="_blank" rel="noopener">1466A</a>：线段上 $n$ 个点，两两距离差值的所有可能个数</h3><p>$n^2$ 的算法是显然的。</p>
<ol>
<li>利用 Bitset，也是 $n^2$ 的 dp，然后用 bitset 存储数据，就可以达到 $n^2/64$ 的复杂度啦。</li>
<li>如果距离的最大值区间为 $N$，那么 $\sum x^{a_i} \sum x^(N - a_i)$ 中非负系数个数就是答案（所以有 $O(N\log N)$ 的做法。</li>
</ol>
<h3 id="1466E：求和"><a href="#1466E：求和" class="headerlink" title="1466E：求和"></a><a href="https://codeforces.com/contest/1466/problem/E" target="_blank" rel="noopener">1466E</a>：求和</h3><script type="math/tex; mode=display">
\sum_{i=1}^n \sum_{j=1}^n \sum_{k=1}^n (x_i \, \& \, x_j) \cdot (x_j \, | \, x_k)</script><p>显然就是固定 $j$，每位每位的求和即可。</p>
<h3 id="1466F：-mathbb-Z-2-上-m-维向量线性无关组"><a href="#1466F：-mathbb-Z-2-上-m-维向量线性无关组" class="headerlink" title="1466F：$\mathbb{Z}_2$ 上 $m$ 维向量线性无关组"></a><a href="https://codeforces.com/contest/1466/problem/F" target="_blank" rel="noopener">1466F</a>：$\mathbb{Z}_2$ 上 $m$ 维向量线性无关组</h3><p>注意到题目中至多两个位置非零，因此就可以用 并查集（一般情况倒是不知道有啥好办法）。注意到官方题解，可以多加一个维度，使得有每次正好有两个位置非零。</p>
<h3 id="1465D：观察结果题"><a href="#1465D：观察结果题" class="headerlink" title="1465D：观察结果题"></a><a href="https://codeforces.com/contest/1465/problem/D" target="_blank" rel="noopener">1465D</a>：观察结果题</h3><p>题意：给定由 <code>0, 1, ?</code> 构成的字符串，将 <code>?</code> 变成 0 或 1，使得 01 字符和 10 字符权值和最小。（其中，01 权值为 x, 10 权值为 y）</p>
<blockquote>
<p>不妨假设 $x \leq y$, 否则将字符串反序（x, y 互换）</p>
</blockquote>
<p>做法：首先不考虑 <code>?</code>，此时我们可以通过当前位置为 0（看前方 1 的个数），当前位置为 1（看前置 0 的个数）得到基础权值 <code>W</code>，然后注意到 01 的权值低于 10 的权值，因此当 m 个 <code>?</code> 替换成 p 个 1 和 m - p 个 0 时候，把 0，放在最前面会让权值最小，因此我们可以考虑前缀问号给 0，后缀问号为 1 给答案的贡献。然后再加上基础权值 W 再加上 <code>m(m-p)x</code>。 </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> a;</span><br><span class="line">	LL x, y;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; x &gt;&gt; y;</span><br><span class="line">	<span class="keyword">if</span> (x &gt; y) &#123;</span><br><span class="line">		<span class="built_in">std</span>::swap(x, y);</span><br><span class="line">		<span class="built_in">std</span>::reverse(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> n = a.<span class="built_in">size</span>();</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p[<span class="number">2</span>], s[<span class="number">2</span>];</span><br><span class="line">	p[<span class="number">0</span>].resize(n + <span class="number">1</span>);</span><br><span class="line">	p[<span class="number">1</span>].resize(n + <span class="number">1</span>);</span><br><span class="line">	s[<span class="number">0</span>].resize(n + <span class="number">1</span>);</span><br><span class="line">	s[<span class="number">1</span>].resize(n + <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		p[<span class="number">0</span>][i + <span class="number">1</span>] = p[<span class="number">0</span>][i];</span><br><span class="line">		p[<span class="number">1</span>][i + <span class="number">1</span>] = p[<span class="number">1</span>][i];</span><br><span class="line">		<span class="keyword">if</span> (a[i] != <span class="string">'?'</span>) ++p[a[i] - <span class="string">'0'</span>][i + <span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">		s[<span class="number">0</span>][i] = s[<span class="number">0</span>][i + <span class="number">1</span>];</span><br><span class="line">		s[<span class="number">1</span>][i] = s[<span class="number">1</span>][i + <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span> (a[i] != <span class="string">'?'</span>) ++s[a[i] - <span class="string">'0'</span>][i];</span><br><span class="line">	&#125;</span><br><span class="line">	LL ord = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (a[i] == <span class="string">'0'</span>) ord += p[<span class="number">1</span>][i] * y;</span><br><span class="line">		<span class="keyword">if</span> (a[i] == <span class="string">'1'</span>) ord += p[<span class="number">0</span>][i] * x;</span><br><span class="line">	&#125;</span><br><span class="line">	std::vector&lt;LL&gt; pre(n + 1), suf(n + 1);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		pre[i + <span class="number">1</span>] = pre[i];</span><br><span class="line">		<span class="keyword">if</span> (a[i] == <span class="string">'?'</span>) pre[i + <span class="number">1</span>] += s[<span class="number">1</span>][i] * x + p[<span class="number">1</span>][i] * y;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">		suf[i] = suf[i + <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span> (a[i] == <span class="string">'?'</span>) suf[i] += s[<span class="number">0</span>][i] * y + p[<span class="number">0</span>][i] * x;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> cnt = <span class="built_in">std</span>::count(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>(), <span class="string">'?'</span>), tnc = <span class="number">0</span>;</span><br><span class="line">	LL r = ord + suf[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) <span class="keyword">if</span> (a[i] == <span class="string">'?'</span>) &#123;</span><br><span class="line">		++tnc;</span><br><span class="line">		r = <span class="built_in">std</span>::<span class="built_in">min</span>(r, ord + pre[i + <span class="number">1</span>] + suf[i + <span class="number">1</span>] + x * (cnt - tnc) * tnc);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1465E：观察题"><a href="#1465E：观察题" class="headerlink" title="1465E：观察题"></a><a href="https://codeforces.com/contest/1465/problem/E" target="_blank" rel="noopener">1465E</a>：观察题</h3><blockquote>
<p><a href="https://codeforces.com/blog/entry/85792" target="_blank" rel="noopener">官方题解</a> 清晰明了</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	LL s;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> a;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; s &gt;&gt; a;</span><br><span class="line">	s -= <span class="number">1</span> &lt;&lt; (a.back() - <span class="string">'a'</span>);</span><br><span class="line">	a.pop_back();</span><br><span class="line">	s += <span class="number">1</span> &lt;&lt; (a.back() - <span class="string">'a'</span>);</span><br><span class="line">	a.pop_back();</span><br><span class="line">	s = <span class="built_in">abs</span>(s);</span><br><span class="line">	LL cnt[<span class="number">26</span>]&#123;&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> x : a) ++cnt[x - <span class="string">'a'</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">25</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">		<span class="keyword">if</span> ((s &gt;&gt; i) &gt;= cnt[i]) s -= cnt[i] &lt;&lt; i;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> t = cnt[i] - (s &gt;&gt; i);</span><br><span class="line">			s -= (s &gt;&gt; i) &lt;&lt; i;</span><br><span class="line">			<span class="keyword">if</span> (t % <span class="number">2</span>) s = (<span class="number">1</span> &lt;&lt; i) - s;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (s == <span class="number">0</span> ? <span class="string">"Yes"</span> : <span class="string">"No"</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>用桶排序和取正处理，直接起飞，复杂度骤降为 $O(n)$。</p>
</blockquote>
<h3 id="1450H：圆上配对问题"><a href="#1450H：圆上配对问题" class="headerlink" title="1450H：圆上配对问题"></a><a href="https://codeforces.com/contest/1450/problem/H1" target="_blank" rel="noopener">1450H</a>：圆上配对问题</h3><blockquote>
<p><a href="https://codeforces.com/blog/entry/85348" target="_blank" rel="noopener">官方题解</a> 属实精彩。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">powMod</span><span class="params">(LL x, LL n)</span> </span>&#123;</span><br><span class="line">	LL r = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (n) &#123;</span><br><span class="line">		<span class="keyword">if</span> (n &amp; <span class="number">1</span>) r = r * x % M;</span><br><span class="line">		n &gt;&gt;= <span class="number">1</span>;   x = x * x % M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, m;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> s;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; s;</span><br><span class="line"></span><br><span class="line">	std::vector&lt;LL&gt; fac(n + 1), ifac(n + 1);</span><br><span class="line">	fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) fac[i] = fac[i - <span class="number">1</span>] * i % M;</span><br><span class="line">	ifac[n] = powMod(fac[n], M - <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i) ifac[i - <span class="number">1</span>] = ifac[i] * i % M;</span><br><span class="line">	<span class="keyword">auto</span> binom = [&amp;](<span class="keyword">int</span> n, <span class="keyword">int</span> k) &#123;</span><br><span class="line">		<span class="keyword">return</span> fac[n] * ifac[n - k] % M * ifac[k] % M;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> B[<span class="number">2</span>] = &#123;&#125;, res[<span class="number">2</span>] = &#123;&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (s[i] == <span class="string">'?'</span>) ++res[i % <span class="number">2</span>];</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (s[i] == <span class="string">'b'</span>) ++B[i % <span class="number">2</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> F = res[<span class="number">0</span>] + res[<span class="number">1</span>], x = B[<span class="number">1</span>] + res[<span class="number">1</span>] - B[<span class="number">0</span>];</span><br><span class="line">	</span><br><span class="line">	LL r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = (x + n) % <span class="number">2</span>; i &lt;= F; i += <span class="number">2</span>) &#123;</span><br><span class="line">		(r += <span class="built_in">abs</span>(x - i) * binom(F, i)) %= M;</span><br><span class="line">	&#125;</span><br><span class="line">	r = r * powMod(<span class="number">2L</span>L, F * (M - <span class="number">2</span>) % (M - <span class="number">1</span>)) % M;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>; </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1453D：简单概率题"><a href="#1453D：简单概率题" class="headerlink" title="1453D：简单概率题"></a><a href="https://codeforces.com/contest/1453/problem/D" target="_blank" rel="noopener">1453D</a>：简单概率题</h3><blockquote>
<p>这么简答的概率题，我竟然做了一个小时，被弱智的错误理解题意搞的头皮发麻！</p>
</blockquote>
<p>题意：对一个长度为 $n$ 的 0-1 序列（首位为 1），<code>0</code> 表示不存档 <code>1</code> 表示存档，如果我们在第 <code>i</code> 关打赢了，那么我们进入第 <code>i + 1</code> 关，否则我们回到最近的一次存档处。那么战斗次数的期望就确定的。现在问题是期望值 $k$，能否给一个 $0-1$ 序列。</p>
<p>首先如果 $n = 1$，那么此时期望为 $\displaystyle \sum_{i = 1}^n \frac{i}{2^i} = 2$. 注意到如果 <code>a[i] = 1</code>，一旦到达 <code>i</code> 位置，那么期望与前面的部分就无关了。所以其实我们只需考虑序列 <code>10...0</code>。记期望为 $p_n$。那么</p>
<script type="math/tex; mode=display">
p_n = \sum_{i = 1}^n \frac{i + p_n}{2^i} + \frac{n}{2^n}</script><p>化简可得 $p_n = 2 (2^n - 1)$. 因此只要 k 是 2 的倍数，必然序列存在。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		LL n;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		<span class="keyword">if</span> (n &amp; <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		n /= <span class="number">2</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a;</span><br><span class="line">		<span class="keyword">while</span> (n) &#123;</span><br><span class="line">			<span class="keyword">int</span> x = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">while</span> ((<span class="number">1L</span>L &lt;&lt; x) &lt;= n + <span class="number">1</span>) ++x;</span><br><span class="line">			--x;</span><br><span class="line">			n -= (<span class="number">1L</span>L &lt;&lt; x) - <span class="number">1</span>;</span><br><span class="line">			a.emplace_back(<span class="number">1</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; x; ++i) a.emplace_back(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; a.<span class="built_in">size</span>() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> x : a) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1455B：简单被卡题"><a href="#1455B：简单被卡题" class="headerlink" title="1455B：简单被卡题"></a><a href="https://codeforces.com/contest/1455/problem/B" target="_blank" rel="noopener">1455B</a>：简单被卡题</h3><p>题意：第 $k$ 次移动时，可以往前移动 $k$ 个位置，或往后移动一个位置，从 0 到 $n$ 最少多少步完成。</p>
<blockquote>
<p>一开始在想用 bfs 或者 dfs 或者 dp 来做，没有第一时间搞贪心。写完 bfs 之后，跑不动吐了。此题最多向后走一个位置即可。找到最小的 x 满足 $1 + \cdots x \geq n$，如果 $1 + \cdots x = n + 1$，那么答案就是 $x + 1$，否则为 $x$。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> x;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">		<span class="keyword">int</span> r = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (r * (r + <span class="number">1</span>) / <span class="number">2</span> &lt; x) ++ r;</span><br><span class="line">		<span class="keyword">if</span> (r * (r + <span class="number">1</span>) / <span class="number">2</span> == x + <span class="number">1</span>) ++r;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1455E：好玩的问题"><a href="#1455E：好玩的问题" class="headerlink" title="1455E：好玩的问题"></a><a href="https://codeforces.com/contest/1455/problem/E" target="_blank" rel="noopener">1455E</a>：好玩的问题</h3><p>给定四个不同的点，将它们分别移动，使得称为一个正方形，且边分别和轴平行。左上角，右上角，左下角，右下角四个点明确之后，那么坐标分开讨论。利用一个事实，就是线段上，距离端点长度之和为常量。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n = <span class="number">4</span>;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;pll&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[x, y] : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">		LL ans = INT64_MAX;</span><br><span class="line">		<span class="built_in">std</span>::sort(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			LL sum = <span class="number">0</span>;</span><br><span class="line">			<span class="comment">// 0 3</span></span><br><span class="line">			<span class="comment">// 1 2</span></span><br><span class="line">			sum += <span class="built_in">abs</span>(a[<span class="number">0</span>].first - a[<span class="number">1</span>].first);</span><br><span class="line">			sum += <span class="built_in">abs</span>(a[<span class="number">2</span>].first - a[<span class="number">3</span>].first);</span><br><span class="line">			sum += <span class="built_in">abs</span>(a[<span class="number">0</span>].second - a[<span class="number">3</span>].second);</span><br><span class="line">			sum += <span class="built_in">abs</span>(a[<span class="number">1</span>].second - a[<span class="number">2</span>].second);</span><br><span class="line">			LL xr = <span class="built_in">std</span>::<span class="built_in">max</span>(a[<span class="number">3</span>].first, a[<span class="number">2</span>].first) - <span class="built_in">std</span>::<span class="built_in">min</span>(a[<span class="number">1</span>].first, a[<span class="number">0</span>].first);</span><br><span class="line">			LL xl = <span class="built_in">std</span>::<span class="built_in">min</span>(a[<span class="number">3</span>].first, a[<span class="number">2</span>].first) - <span class="built_in">std</span>::<span class="built_in">max</span>(a[<span class="number">1</span>].first, a[<span class="number">0</span>].first);</span><br><span class="line">			LL yr = <span class="built_in">std</span>::<span class="built_in">max</span>(a[<span class="number">0</span>].second, a[<span class="number">3</span>].second) - <span class="built_in">std</span>::<span class="built_in">min</span>(a[<span class="number">1</span>].second, a[<span class="number">2</span>].second);</span><br><span class="line">			LL yl = <span class="built_in">std</span>::<span class="built_in">min</span>(a[<span class="number">0</span>].second, a[<span class="number">3</span>].second) - <span class="built_in">std</span>::<span class="built_in">max</span>(a[<span class="number">1</span>].second, a[<span class="number">2</span>].second);</span><br><span class="line">			ans = <span class="built_in">std</span>::<span class="built_in">min</span>(ans, sum + <span class="number">2</span> * <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0L</span>L, <span class="built_in">std</span>::<span class="built_in">max</span>(xl, yl) - <span class="built_in">std</span>::<span class="built_in">min</span>(xr, yr)));</span><br><span class="line">		&#125; <span class="keyword">while</span> (<span class="built_in">std</span>::next_permutation(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>()));</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>本场 1456 Div1, 我只能做 AB 两题，但是我可以做的快，做的优雅的，可是我没有！</p>
<h3 id="1456A：经典-DP"><a href="#1456A：经典-DP" class="headerlink" title="1456A：经典 DP"></a><a href="https://codeforces.com/contest/1456/problem/A" target="_blank" rel="noopener">1456A</a>：经典 DP</h3><p>题意：给定 0-1 字符串，需要让 $p, p + k, \cdots$ 位置都变成 1，每变一个位代价是 x，或者删除最开始的字符，这样做代价是 y。</p>
<p>做法：我们可以把字符串反过来，然后答案就是 <code>a[n - p]</code>，状态转移：不删字符的情况下，<code>a[i]</code> 为 $s[i], s[i - k], \cdots$ 中 0 的个数。$a[i] = \min_{1 \leq t \leq i}(a[i], a[i - t] + t * y)$，所以我们可以将 <code>a[i] - iy</code> 添加到 set 中，然后最小值加上 当前的 <code>iy</code> 就是真实的最小值。</p>
<blockquote>
<p>很早就想到了做法，实现的时候写的太急了，分析不过细致，把自己整吐了。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n, p, k, x, y;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">string</span> s;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; p &gt;&gt; k &gt;&gt; s &gt;&gt; x &gt;&gt; y; </span><br><span class="line">		<span class="built_in">std</span>::reverse(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>());</span><br><span class="line">		std::vector&lt;int&gt; a(n), cnt(k);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; S;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (s[i] == <span class="string">'0'</span>) ++cnt[i % k];</span><br><span class="line">			a[i] = cnt[i % k] * x;</span><br><span class="line">			<span class="keyword">if</span> (!S.empty()) a[i] = <span class="built_in">std</span>::<span class="built_in">min</span>(a[i], *S.<span class="built_in">begin</span>() + i * y);</span><br><span class="line">			S.insert(a[i] - i * y);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; a[n - p] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1456B：XOR-问题"><a href="#1456B：XOR-问题" class="headerlink" title="1456B：XOR 问题"></a><a href="https://codeforces.com/contest/1456/problem/B" target="_blank" rel="noopener">1456B</a>：XOR 问题</h3><p>题意：给定一个非降的序列，可以将相邻的两个变成它们的异或值，能否在最小的步数上，将这个序列不满足非降条件。</p>
<p>做法：注意到，如果有三个相邻的数最高位一致，那么答案必然是 1，因此本质上我们只需考虑 n = 60 的情况，所以，随便写就能过（所以我写的特别随便，然后被人 hack 了，我真的服了自己！）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i + <span class="number">2</span> &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> ((a[i] ^ a[i + <span class="number">1</span>]) &gt; a[i + <span class="number">2</span>]) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (a[i] &gt; (a[i + <span class="number">1</span>] ^ a[i + <span class="number">2</span>])) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> ans = INT_MAX;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; b, c;</span><br><span class="line">		<span class="keyword">int</span> nb = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">			nb ^= a[j];</span><br><span class="line">			b.emplace_back(nb);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> nc = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; n; ++j) &#123;</span><br><span class="line">			nc ^= a[j];</span><br><span class="line">			c.emplace_back(nc);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; b.<span class="built_in">size</span>(); ++j) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; c.<span class="built_in">size</span>(); ++k) <span class="keyword">if</span> (b[j] &gt; c[k]) &#123;</span><br><span class="line">				ans = <span class="built_in">std</span>::<span class="built_in">min</span>(ans, j + k);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans == INT_MAX ? <span class="number">-1</span> : ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; solve() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="AtCoder-abc184F：假-0-1-背包，Meet-in-Middle"><a href="#AtCoder-abc184F：假-0-1-背包，Meet-in-Middle" class="headerlink" title="AtCoder abc184F：假 0-1 背包，Meet in Middle"></a><a href="https://atcoder.jp/contests/abc184/tasks/abc184_f" target="_blank" rel="noopener">AtCoder abc184F</a>：假 0-1 背包，Meet in Middle</h3><p>题意：给定序列，求选择其中部分，使得它们和最大且不超过 t，这不就是 0-1 背包吗？但是数据范围 $0 \leq n \leq 40, 0 \leq a_i, t \leq 10^9$，此题即使是多重背包，也可以用下面各种方法来做</p>
<ol>
<li>Meet in Middle，但是实现的时候可以有以下几种实现细节：<ul>
<li>用是 set 或 unordered set 存和更新，然后用双指针，整体复杂度 $O(n 2 ^{\frac{n}{2}})$</li>
<li>用 Vector 存，之后排序（只需排序一个），然后用 <code>lower_bounded</code> 查找，复杂度同理</li>
<li>用 Vector 存，保持有序，最后用双指针，复杂度 $O(2 ^{\frac{n}{2}})$</li>
</ul>
</li>
<li>先 dfs 找到一个较好的解，然后每次更新解，用来剪枝。</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 有序 vector + 双指针，复杂度 $O(2 ^&#123;\frac&#123;n&#125;&#123;2&#125;&#125;)$</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n, t;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; t;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="built_in">std</span>::sort(a.rbegin(), a.rend());</span><br><span class="line">	<span class="keyword">auto</span> merge = [&amp;](<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; a, <span class="keyword">int</span> x) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; b;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">			<span class="keyword">while</span> (j &lt; a.<span class="built_in">size</span>() &amp;&amp; a[i] &lt; a[j] + x) &#123;</span><br><span class="line">				<span class="keyword">if</span> (a[j] + x &lt;= t) b.emplace_back(a[j] + x);</span><br><span class="line">				++j;</span><br><span class="line">			&#125;</span><br><span class="line">			b.emplace_back(a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		swap(a, b);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">auto</span> <span class="built_in">get</span> = [&amp;](<span class="keyword">int</span> l, <span class="keyword">int</span> r) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; x(<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; ++i) &#123;</span><br><span class="line">			merge(x, a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> x;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">auto</span> la = <span class="built_in">get</span>(<span class="number">0</span>, n / <span class="number">2</span>), lb = <span class="built_in">get</span>(n / <span class="number">2</span>, n);</span><br><span class="line">	<span class="keyword">int</span> ib = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = la.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">		<span class="keyword">while</span> (ib &lt; lb.<span class="built_in">size</span>() &amp;&amp; la[i] + lb[ib] &gt; t) ++ib;</span><br><span class="line">		<span class="keyword">if</span> (ib != lb.<span class="built_in">size</span>()) ans = <span class="built_in">std</span>::<span class="built_in">max</span>(ans, la[i] + lb[ib]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; solve() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dfs 剪枝，下述算法会被制造的数据吃掉，例如 t 为奇数，所有其它数为偶数，并且 t 很大，有特别多的解。</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n, t;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; t;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="built_in">std</span>::sort(a.rbegin(), a.rend());</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">b</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">0</span>; --i) b[i - <span class="number">1</span>] = a[i - <span class="number">1</span>] + b[i];</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(<span class="keyword">int</span>, <span class="keyword">int</span>)&gt; dfs = [&amp;](<span class="keyword">int</span> now, <span class="keyword">int</span> i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i &gt; n || ans == t || ans - now &gt;= b[i]) <span class="keyword">return</span>;</span><br><span class="line">		ans = <span class="built_in">std</span>::<span class="built_in">max</span>(ans, now);</span><br><span class="line">		<span class="keyword">if</span> (now + a[i] &lt;= t) dfs(now + a[i], i + <span class="number">1</span>);</span><br><span class="line">		dfs(now, i + <span class="number">1</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	dfs(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; solve() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1451E：交互题"><a href="#1451E：交互题" class="headerlink" title="1451E：交互题"></a><a href="https://codeforces.com/contest/1451/problem/E" target="_blank" rel="noopener">1451E</a>：交互题</h3><p>题意：给定 n（为 2 的幂次，且大于 2），猜测一个长为 n ，取值在 <code>[0, n - 1]</code> 的数列。每次可以询问，<code>XOR i j</code>，<code>OR i j</code>，<code>AND i j</code> 中的一种（$i \neq j$）。询问次数不超过 n + 1。</p>
<blockquote>
<p>上面 <code>OR</code> 和 <code>And</code> 用一个即可，我们这里用 <code>And</code>，<code>OR</code> 也类似。 </p>
</blockquote>
<p>做法：所有的数和第一个数异或（自己跟自己异或为 0，省一次查询），如果有相同的结果，那么做一个 AND 就知道第一个数为多少了，否则所有值都出现了，那么我们可以找到一个 i 使得 $r[1] \wedge r[i] = 2^n - 1$，此时 $r[1] \And r[i] = 0$，我们再找一个数 j，求 <code>r[i] &amp; r[j]</code> 以及 <code>r[1] &amp; r[j]</code> 再利用 <code>a + b = a ^ b + 2 (a &amp; b)</code> 就可以求出 <code>r[1]</code> 了。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"XOR 1 "</span> &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> x = <span class="number">-1</span>;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">b</span><span class="params">(n, <span class="number">-1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (b[a[i]] == <span class="number">-1</span>) b[a[i]] = i;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"AND "</span> &lt;&lt; b[a[i]] + <span class="number">1</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">			<span class="keyword">int</span> tmp;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; tmp;</span><br><span class="line">			x = tmp ^ a[i];</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">-1</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> t1, t2;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"AND "</span> &lt;&lt; b[<span class="number">1</span>] + <span class="number">1</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; b[n - <span class="number">1</span>] + <span class="number">1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; t1;</span><br><span class="line">		t1 = t1 * <span class="number">2</span> + n - <span class="number">2</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"AND "</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; b[<span class="number">1</span>] + <span class="number">1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; t2;</span><br><span class="line">		t2 = t2 * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">		x = (n - <span class="number">1</span> + t1 + t2) / <span class="number">2</span> - t1;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"! "</span> &lt;&lt; x;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; (x ^ a[i]);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>其实本题另一种处理技巧，不需要 $n$ 为 2 的幂次，只需考虑异或为 1 和 2 的 <code>i,j</code>。下面做法基于此想法</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"XOR 1 "</span> &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> x = <span class="number">-1</span>;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">b</span><span class="params">(n, <span class="number">-1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (b[a[i]] == <span class="number">-1</span>) b[a[i]] = i;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"AND "</span> &lt;&lt; b[a[i]] + <span class="number">1</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; i + <span class="number">1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">			<span class="keyword">int</span> tmp;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; tmp;</span><br><span class="line">			x = tmp ^ a[i];</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">-1</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> t1, t2;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"AND "</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; b[<span class="number">1</span>] + <span class="number">1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; t1;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"AND "</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; b[<span class="number">2</span>] + <span class="number">1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; t2;</span><br><span class="line">		x = t1 | (t2 &amp; <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"! "</span> &lt;&lt; x;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; (x ^ a[i]);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1451D：很好博弈问题"><a href="#1451D：很好博弈问题" class="headerlink" title="1451D：很好博弈问题"></a><a href="https://codeforces.com/contest/1451/problem/D" target="_blank" rel="noopener">1451D</a>：很好博弈问题</h3><p>题意：从 (0, 0) 开始，每次可以向上或向右走 k 个单位（但是和起点距离不能超过 d），两人轮流走，谁不能走了谁输。</p>
<p>显然可以简化成走一个单位，距离不超过 $\frac{d}{k}$. 没过一小会，我就想到了，若 $2 x^2 \leq \frac{d^2}{k^2} &lt; 2 (x + 1)^2$，那么，如果 $x^2 + (x + 1)^2 \leq \frac{d^2}{k^2}$，那么先手赢，否则先手输。</p>
<blockquote>
<p>注意到 $x^2 + (x + 2)^2 = 2 (x + 1)^2 + 2 &gt; d$</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		LL d, k;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; d &gt;&gt; k;</span><br><span class="line">		d = d * d / k / k;</span><br><span class="line">		LL x = <span class="built_in">std</span>::<span class="built_in">sqrt</span>(d / <span class="number">2</span> + <span class="number">0.1</span>);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (x * x + (x + <span class="number">1</span>) * (x + <span class="number">1</span>) &lt;= d ? <span class="string">"Ashish\n"</span> : <span class="string">"Utkarsh\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1451C"><a href="#1451C" class="headerlink" title="1451C"></a><a href="https://codeforces.com/contest/1451/problem/C" target="_blank" rel="noopener">1451C</a></h3><p>题意：给定长为 n 的由小写字母组成的字符串 <code>a, b</code>，可以将 <code>a</code> 相邻的位置互换（因此所有位置都可以互换），也可以将长为 $k$ 且每一位都相同的字母全部变成下一个字母。</p>
<p>做法：一开始想排序之和贪心（<a href="https://codeforces.com/contest/1451/submission/99143008" target="_blank" rel="noopener">这份代码</a>），后来发现 <code>n = 3, k = 2</code> 时 <code>aab</code> 变成 <code>zzy</code> 就会出问题。我还以为思路没问题，又交了一遍，属实天真。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> a, b;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; a &gt;&gt; b;</span><br><span class="line">	<span class="built_in">std</span>::sort(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line">	<span class="built_in">std</span>::sort(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line">	<span class="comment">// for (int i = 0; i &lt; n; ++i) if (a[i] &gt; b[i]) return 0;</span></span><br><span class="line">	<span class="keyword">int</span> sa = <span class="number">0</span>, sb = <span class="number">0</span>, t = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">auto</span> deal = [&amp;](<span class="keyword">char</span> c) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) a[sa - i] = c;</span><br><span class="line">		sa -= k;</span><br><span class="line">		--t;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">while</span> (sb &lt; n) &#123;</span><br><span class="line">		<span class="keyword">if</span> (sa == n) deal(b[sb]);</span><br><span class="line">		<span class="keyword">if</span> (a[sa] == b[sb]) &#123;</span><br><span class="line">			++sa;</span><br><span class="line">			++sb;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> (a[sa] &gt; b[sb]) &#123;</span><br><span class="line">			<span class="keyword">if</span> (t == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			deal(b[sb]);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (sa + k - <span class="number">1</span> &lt; n &amp;&amp; a[sa] == a[sa + k - <span class="number">1</span>]) &#123;</span><br><span class="line">				++t;</span><br><span class="line">				sa += k;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (solve() ? <span class="string">"Yes\n"</span> : <span class="string">"No\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>此题考虑每个数的个数会更简单！怪不得他们做的这么快…</p>
</blockquote>
<h3 id="1452E：特别难的复杂度降低问题，经典问题，注意转化"><a href="#1452E：特别难的复杂度降低问题，经典问题，注意转化" class="headerlink" title="1452E：特别难的复杂度降低问题，经典问题，注意转化"></a><a href="https://codeforces.com/contest/1452/problem/E" target="_blank" rel="noopener">1452E</a>：特别难的复杂度降低问题，经典问题，注意转化</h3><p>题意，有两个出题人各自连续讲 k 题，每个参赛者选择去听其中一个出题人讲题，参赛者感兴趣的题在一个区间 <code>[l, r]</code> 问每个参赛者能听的自己感兴趣的题目的总和最大值为多少，$n$：总题目数，$m$ 参赛人数。</p>
<p>首先这里有一个自然的 $O(n^2 m)$ 的做法，有些人利用 Codeforces 上支持的 GCC 指令过了题…。<br>官方题解说：对于每个参赛者的感兴趣区间 <code>[l, r]</code>，某一个出题人讲题区间 <code>[i, i + k - 1]</code>，当 <code>i</code> 在递增时，这两个区间的交会怎样变化呢？在脑子里把区间进行平移会发现，它先增，在它们的中间相交之后递减，并且还是对称的。也就是说，<strong>两个出题人它们区间的中点和参赛者近的会被参赛者选择</strong>。因此排序之后，第一个出题人拿前缀，后一个拿后缀。所以就是求前缀和和后缀和之和的最大值。总复杂度 $O(mn + m \log m)$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, m, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;pii&gt; <span class="title">a</span><span class="params">(m)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[l, r] : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r;</span><br><span class="line">	<span class="built_in">std</span>::sort(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>(), [](<span class="keyword">const</span> pii &amp;A, <span class="keyword">const</span> pii &amp;B) &#123;</span><br><span class="line">		<span class="keyword">return</span> A.first + A.second &lt; B.first + B.second;</span><br><span class="line">	&#125;);</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">sm</span><span class="params">(m + <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i + k &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> cur = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = m - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">			cur += <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0</span>, <span class="built_in">std</span>::<span class="built_in">min</span>(i + k, a[j].second) - <span class="built_in">std</span>::<span class="built_in">max</span>(i, a[j].first - <span class="number">1</span>));</span><br><span class="line">			sm[j] = <span class="built_in">std</span>::<span class="built_in">max</span>(sm[j], cur);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> ans = sm[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i + k &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> cur = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">			cur += <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0</span>, <span class="built_in">std</span>::<span class="built_in">min</span>(i + k, a[j].second) - <span class="built_in">std</span>::<span class="built_in">max</span>(i, a[j].first - <span class="number">1</span>));</span><br><span class="line">			ans = <span class="built_in">std</span>::<span class="built_in">max</span>(ans, cur + sm[j + <span class="number">1</span>]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>有人写了不排序的 $O(n m)$ 做法，反正我时没懂。</p>
</blockquote>
<h3 id="1452F：经典观察贪心问题"><a href="#1452F：经典观察贪心问题" class="headerlink" title="1452F：经典观察贪心问题"></a><a href="https://codeforces.com/contest/1452/problem/F" target="_blank" rel="noopener">1452F</a>：经典观察贪心问题</h3><p>题意：有 $a_i$ 个 $2^i$ 的数，每次可以把某个 $2^{i + 1}$ 分成两个 $2^i$，给定 $x,y$，问至少需要多少次操作可以有至少 $y$ 个数小于 $2^x$。</p>
<p>首先，如果一个数 $2 \leq 2^l \leq 2^x$，那么分一次多一个答案，这种称作小的，可以将 $2^l$ 分成 $2^{l - x}$ 个 $2^x$，需要的次数为 $2^{l - x} + 1$。首先注意到 $l &gt; k$ 时，分小的性价比较高，因此我们递增的考虑 $2^l &gt; 2^x$</p>
<ul>
<li>若 $2^{l - x} \leq k$，全部搞一下就可以了</li>
<li>否则，若 $2^{l - x} &gt; k$，这个时候我们可以看那些小的个数是否大于等于 $k$，如果是，那结束了，否则将 $2^l$ 分割成 两个 $2^{l - 1}$，再判断，若 $2^{l - 1 - x} &gt; k$，那么最多只会用到一个 $2^{l - 1}$，否则有一个 $2^{l - 1}$ 必然全部都拿来用了。那好了再次回到了这个判断上来了。经典！</li>
</ul>
<blockquote>
<p>一开始以为时线段树问题，后来一看 $n &lt; 30$，有一堆的观察之后才好下手的！每一步的观察都要准确！才能一步一步的走向正确的答案</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, q;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="keyword">auto</span> getans = [&amp;](<span class="keyword">int</span> x, LL y) -&gt; LL &#123;</span><br><span class="line">		LL small = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= x; ++i) &#123;</span><br><span class="line">			y -= a[i];</span><br><span class="line">			small += (a[i] &lt;&lt; i) - a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (y &lt;= <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">auto</span> add = [&amp;](<span class="keyword">int</span> i, LL t) &#123;</span><br><span class="line">			ans += (t &lt;&lt; i - x) - t;</span><br><span class="line">			y -= t &lt;&lt; i - x;</span><br><span class="line">			small += (t &lt;&lt; i) - (t &lt;&lt; i - x);</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">int</span> id = x + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (id &lt; n) &#123;</span><br><span class="line">			LL t = <span class="built_in">std</span>::<span class="built_in">min</span>(y &gt;&gt; id - x, a[id]);</span><br><span class="line">			<span class="keyword">if</span> (t &gt; <span class="number">0</span>) add(id, t);</span><br><span class="line">			<span class="keyword">if</span> (t &lt; a[id]) <span class="keyword">break</span>;</span><br><span class="line">			++id;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (id == n) <span class="keyword">return</span> y &gt; small ? <span class="number">-1</span> : y + ans;</span><br><span class="line">		<span class="keyword">while</span> (y &gt; small &amp;&amp; id &gt; x) &#123;</span><br><span class="line">			--id;</span><br><span class="line">			++ans;</span><br><span class="line">			<span class="keyword">if</span> (y &gt;&gt; id - x) add(id, <span class="number">1L</span>L);</span><br><span class="line">			<span class="keyword">if</span> (id == x &amp;&amp; y &gt; <span class="number">0</span>) add(id, <span class="number">1L</span>L);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> y + ans;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">while</span> (q--) &#123;</span><br><span class="line">		<span class="keyword">int</span> op, x;</span><br><span class="line">		LL y;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; op &gt;&gt; x &gt;&gt; y;</span><br><span class="line">		<span class="keyword">if</span> (op == <span class="number">1</span>) a[x] = y;</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; getans(x, y) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1440C：模拟题"><a href="#1440C：模拟题" class="headerlink" title="1440C：模拟题"></a><a href="https://codeforces.com/contest/1440/problem/C2" target="_blank" rel="noopener">1440C</a>：模拟题</h3><p>题意：给定 $n \times m$ 的 <code>0-1</code> 矩阵，每次操作改变 $2 \times 2$ 小方块中三个位置，要求在 $nm$ 步内使得所有方块为 0。首先显然每一行可以通过 $m$ 次操作置 0，每一列同理，所以最后转化成对 $2 \times 2$ 四次内变成全 0</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n, m;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; <span class="title">s</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : s) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; r;</span><br><span class="line">		<span class="keyword">auto</span> f = [](<span class="keyword">char</span> &amp;x) &#123;x = (x == <span class="string">'0'</span> ? <span class="string">'1'</span> : <span class="string">'0'</span>);&#125;;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt; <span class="number">1</span>; --i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = m - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) <span class="keyword">if</span> (s[i][j] == <span class="string">'1'</span>) &#123;</span><br><span class="line">				r.emplace_back(i, j);</span><br><span class="line">				r.emplace_back(i - <span class="number">1</span>, j);</span><br><span class="line">				f(s[i - <span class="number">1</span>][j]);</span><br><span class="line">				<span class="keyword">if</span> (j &gt; <span class="number">0</span>) &#123;</span><br><span class="line">					r.emplace_back(i - <span class="number">1</span>, j - <span class="number">1</span>);</span><br><span class="line">					f(s[i - <span class="number">1</span>][j - <span class="number">1</span>]);</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					r.emplace_back(i - <span class="number">1</span>, j + <span class="number">1</span>);</span><br><span class="line">					f(s[i - <span class="number">1</span>][j + <span class="number">1</span>]);</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = m - <span class="number">1</span>; j &gt; <span class="number">1</span>; --j) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i) &#123;</span><br><span class="line">				<span class="keyword">if</span> (s[i][j] == <span class="string">'1'</span>) &#123;</span><br><span class="line">					r.emplace_back(i, j);</span><br><span class="line">					r.emplace_back(i, j - <span class="number">1</span>);</span><br><span class="line">					r.emplace_back(<span class="number">1</span> - i, j - <span class="number">1</span>);</span><br><span class="line">					f(s[i][j - <span class="number">1</span>]);</span><br><span class="line">					f(s[<span class="number">1</span> - i][j - <span class="number">1</span>]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">deque</span>&lt;<span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; t[<span class="number">2</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; ++j) &#123;</span><br><span class="line">				t[s[i][j] - <span class="string">'0'</span>].emplace_back(i, j);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> g = [&amp;](<span class="keyword">int</span> i) &#123;</span><br><span class="line">			r.emplace_back(t[i].back());</span><br><span class="line">			t[<span class="number">1</span> - i].emplace_front(t[i].back());</span><br><span class="line">			t[i].pop_back();</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">if</span> (t[<span class="number">1</span>].<span class="built_in">size</span>() == <span class="number">4</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) g(<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (t[<span class="number">1</span>].<span class="built_in">size</span>() == <span class="number">1</span>) &#123;</span><br><span class="line">			g(<span class="number">1</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i) g(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (t[<span class="number">1</span>].<span class="built_in">size</span>() == <span class="number">2</span>) &#123;</span><br><span class="line">			g(<span class="number">1</span>);</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i) g(<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (t[<span class="number">1</span>].<span class="built_in">size</span>() == <span class="number">3</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i) g(<span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r.<span class="built_in">size</span>() / <span class="number">3</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i * <span class="number">3</span> &lt; r.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j) &#123;</span><br><span class="line">				<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r[i * <span class="number">3</span> + j].first + <span class="number">1</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; r[i * <span class="number">3</span> + j].second + <span class="number">1</span> &lt;&lt; <span class="string">" \n"</span>[j == <span class="number">2</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1440D：图论乱搞"><a href="#1440D：图论乱搞" class="headerlink" title="1440D：图论乱搞"></a><a href="https://codeforces.com/contest/1440/problem/D" target="_blank" rel="noopener">1440D</a>：图论乱搞</h3><p>题意：问一个图中是否存在 k-阶完全子图，或一个度数全大于 k 的子图。</p>
<blockquote>
<p>显然，我们可以把度数小于 $k - 1$ 的节点全部踢了。即从度数从小到大的遍历，小于 $k - 1$ 踢了，等于 $k - 1$, 看这 $k$ 个点能否成为完全图，能？结束，否则，继续，直到当前度数为 $k$，或者所有点都被剔除。</p>
</blockquote>
<p>没能在比赛的时候做出原因：</p>
<ul>
<li>没有注意到删点后更新度数的次数只和边数有关，所以当时觉得复杂度过不了！</li>
<li>在完全图判断时不够自信（单次复杂度 $k^2$，但是注意到边数小于 $\frac{(k - 1)k}{2}$ 时不可能为完全图）。</li>
<li>总复杂度 $O(m \sqrt{m} \log n)$，下面代码 998ms 飘过（在死亡的边缘疯狂试探）</li>
<li><code>unordered_set</code> 是基于 hash 表的，如果不需要集合按顺序输出，可以作为优先选择。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n, m, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">unordered_set</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">e</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x, y; i &lt; m; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">		--x; --y;</span><br><span class="line">		e[x].insert(y);</span><br><span class="line">		e[y].insert(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">set</span>&lt;<span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; d;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) d.insert(&#123;e[i].<span class="built_in">size</span>(), i&#125;);</span><br><span class="line">	<span class="keyword">auto</span> check = [&amp;](<span class="keyword">int</span> u) -&gt; <span class="keyword">bool</span> &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; tmp(e[u].<span class="built_in">begin</span>(), e[u].<span class="built_in">end</span>());</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tmp.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; ++j) &#123;</span><br><span class="line">				<span class="keyword">if</span> (e[tmp[i]].count(tmp[j]) == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>; </span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">auto</span> del = [&amp;](<span class="keyword">int</span> u) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> v : e[u]) &#123;</span><br><span class="line">			d.erase(&#123;e[v].<span class="built_in">size</span>(), v&#125;);</span><br><span class="line">			e[v].erase(u);</span><br><span class="line">			d.insert(&#123;e[v].<span class="built_in">size</span>(), v&#125;);</span><br><span class="line">			--m;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">while</span> (!d.empty()) &#123;</span><br><span class="line">		<span class="keyword">int</span> du = d.<span class="built_in">begin</span>()-&gt;first;</span><br><span class="line">		<span class="keyword">int</span> u = d.<span class="built_in">begin</span>()-&gt;second;</span><br><span class="line">		<span class="keyword">if</span> (du &gt;= k) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; d.<span class="built_in">size</span>() &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> it = d.<span class="built_in">begin</span>(); it != d.<span class="built_in">end</span>(); ++it) &#123;</span><br><span class="line">				<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (it-&gt;second + <span class="number">1</span>) &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (du == k - <span class="number">1</span> &amp;&amp; k - <span class="number">1</span> &lt;= m * <span class="number">2</span> / k &amp;&amp; check(u)) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="number">2</span> &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; u + <span class="number">1</span> &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> x : e[u]) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x + <span class="number">1</span> &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		d.erase(d.<span class="built_in">begin</span>());</span><br><span class="line">		del(u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"-1\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		solve();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1440E-线段树"><a href="#1440E-线段树" class="headerlink" title="1440E: 线段树"></a><a href="https://codeforces.com/contest/1440/problem/E" target="_blank" rel="noopener">1440E</a>: 线段树</h3><p>没能在比赛的时候做出原因：</p>
<ul>
<li>线段树模板不太好用</li>
<li>没有注意到数列必然单调递减，所以处理的时候处理复杂了</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SegmentTree</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; mn, tag;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; sm;</span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> lson l, m, 2 * p</span></span><br><span class="line">	<span class="meta">#<span class="meta-keyword">define</span> rson m + 1, r, 2 * p + 1</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">resize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		mn.resize(<span class="number">4</span> * n);</span><br><span class="line">		tag.resize(<span class="number">4</span> * n);</span><br><span class="line">		sm.resize(<span class="number">4</span> * n);</span><br><span class="line">	&#125;</span><br><span class="line">	SegmentTree(<span class="keyword">int</span> _n) : n(_n) &#123;</span><br><span class="line">		resize();</span><br><span class="line">	&#125;</span><br><span class="line">	SegmentTree(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;a) &#123;</span><br><span class="line">		n = a.<span class="built_in">size</span>();</span><br><span class="line">		resize();</span><br><span class="line">		<span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(<span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>)&gt; build = [&amp;](<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p) &#123;</span><br><span class="line">			<span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">				mn[p] = sm[p] = a[l - <span class="number">1</span>];</span><br><span class="line">				<span class="keyword">return</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">			build(lson);</span><br><span class="line">			build(rson);</span><br><span class="line">			pull(p);</span><br><span class="line">		&#125;;</span><br><span class="line">		build(<span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pull</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">		mn[p] = <span class="built_in">std</span>::<span class="built_in">min</span>(mn[<span class="number">2</span> * p], mn[<span class="number">2</span> * p + <span class="number">1</span>]);</span><br><span class="line">		sm[p] = sm[<span class="number">2</span> * p] + sm[<span class="number">2</span> * p + <span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">		tag[p] = mn[p] = v;</span><br><span class="line">		sm[p] = LL(r - l + <span class="number">1</span>) * v;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (tag[p]) &#123;</span><br><span class="line">			<span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">			<span class="built_in">set</span>(lson, tag[p]);</span><br><span class="line">			<span class="built_in">set</span>(rson, tag[p]);</span><br><span class="line">			tag[p] = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">rangeSet</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> v, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (L &lt;= l &amp;&amp; R &gt;= r) &#123;</span><br><span class="line">			<span class="built_in">set</span>(l, r, p, v);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">		push(l, r, p);</span><br><span class="line">		<span class="keyword">if</span> (L &lt;= m) rangeSet(L, R, v, lson);</span><br><span class="line">		<span class="keyword">if</span> (R &gt; m) rangeSet(L, R, v, rson);</span><br><span class="line">		pull(p);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span>&amp; y, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (mn[p] &gt; y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (x &lt;= l &amp;&amp; sm[p] &lt;= y) &#123;</span><br><span class="line">			y -= sm[p];</span><br><span class="line">			<span class="keyword">return</span> r - l + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">		push(l, r, p);</span><br><span class="line">		<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (x &lt;= m) ans += query(x, y, lson); </span><br><span class="line">		ans += query(x, y, rson);</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> query(x, y, <span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">bounded</span><span class="params">(<span class="keyword">int</span> v, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (mn[p] &gt;= v) <span class="keyword">return</span> r + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (l == r) <span class="keyword">return</span> l;</span><br><span class="line">		<span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span> (mn[<span class="number">2</span> * p] &gt;= v) <span class="keyword">return</span> bounded(v, rson);</span><br><span class="line">		<span class="keyword">return</span> bounded(v, lson);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">int</span> l = bounded(y, <span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span> (l &lt;= x) rangeSet(l, x, y, <span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, q;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x: a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="function">SegmentTree <span class="title">A</span><span class="params">(a)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (q--) &#123;</span><br><span class="line">		<span class="keyword">int</span> op, x, y;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; op &gt;&gt; x &gt;&gt; y;</span><br><span class="line">		<span class="keyword">if</span> (op == <span class="number">1</span>) A.modify(x, y);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; A.query(x, y) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1447B：简单细节题"><a href="#1447B：简单细节题" class="headerlink" title="1447B：简单细节题"></a><a href="https://codeforces.com/contest/1447/problem/B" target="_blank" rel="noopener">1447B</a>：简单细节题</h3><ul>
<li>很早就知道，任意两个可以换，要考虑非正数的个数是否为奇数。</li>
<li>然后为奇数时，绝对值总和减去 2 倍的最大的非正数（！！！这是错了）。</li>
<li>后来想了半天终于知道时减去绝对值最小的数。</li>
<li>然后再之前的内容上改，写出了下面屎一样的 RE 代码！还 PE 了，最后 RE，吐了！</li>
</ul>
<p><strong>此代码为 RE 代码！</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n, m;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">		n *= m;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a, b;</span><br><span class="line">		<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">			r += <span class="built_in">abs</span>(x);</span><br><span class="line">			<span class="keyword">if</span> (x &lt;= <span class="number">0</span>) a.emplace_back(-x);</span><br><span class="line">			<span class="keyword">else</span> b.emplace_back(x);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (a.<span class="built_in">size</span>() &amp; <span class="number">1</span>) &#123;</span><br><span class="line">			r -= <span class="built_in">std</span>::<span class="built_in">min</span>(*<span class="built_in">std</span>::min_element(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>()), *<span class="built_in">std</span>::min_element(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>())) * <span class="number">2</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1447C：经典问题：假-0-1-背包，真贪心"><a href="#1447C：经典问题：假-0-1-背包，真贪心" class="headerlink" title="1447C：经典问题：假 0-1 背包，真贪心"></a><a href="https://codeforces.com/contest/1447/problem/C" target="_blank" rel="noopener">1447C</a>：经典问题：假 0-1 背包，真贪心</h3><p>题意：给定 $n$ 件物品 $w_i$，给出一个 $k$ 件物品和在 $[\lfloor \frac{W}{2} \rfloor, W]$ 之间的一种方案</p>
<p>做法：对物品从大到小排序，然后贪心即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		LL w;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; w;</span><br><span class="line">		std::vector&lt;std::pair&lt;int, int&gt;&gt; a(n);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i].first;</span><br><span class="line">			a[i].second = i + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::sort(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>(), <span class="built_in">std</span>::greater&lt;&gt;());</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; x;</span><br><span class="line">		<span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">		LL s = <span class="number">0</span>, h = (w + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (s + a[i].first &lt;= w) &#123;</span><br><span class="line">				x.emplace_back(a[i].second);</span><br><span class="line">				s += a[i].first;</span><br><span class="line">				<span class="keyword">if</span> (s &gt;= h) &#123;</span><br><span class="line">					flag = <span class="literal">true</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (flag) &#123;</span><br><span class="line">			<span class="built_in">std</span>::sort(x.<span class="built_in">begin</span>(), x.<span class="built_in">end</span>());</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x.<span class="built_in">size</span>() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> i : x) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1447D：DP"><a href="#1447D：DP" class="headerlink" title="1447D：DP"></a><a href="https://codeforces.com/contest/1447/problem/D" target="_blank" rel="noopener">1447D</a>：DP</h3><blockquote>
<p>就是一个简单的 DP，写完我都有点虚…</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, m;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> a, b;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; a &gt;&gt; b;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">dp</span><span class="params">(n + <span class="number">1</span>, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(m + <span class="number">1</span>))</span></span>;</span><br><span class="line">	<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">			dp[i][j] = <span class="built_in">std</span>::<span class="built_in">max</span>(&#123;<span class="number">0</span>, dp[i - <span class="number">1</span>][j] - <span class="number">1</span>, dp[i][j - <span class="number">1</span>] - <span class="number">1</span>&#125;);</span><br><span class="line">			<span class="keyword">if</span> (a[i - <span class="number">1</span>] == b[j - <span class="number">1</span>]) dp[i][j] = <span class="built_in">std</span>::<span class="built_in">max</span>(dp[i][j], dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + <span class="number">2</span>);</span><br><span class="line">			r = <span class="built_in">std</span>::<span class="built_in">max</span>(r, dp[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="144E：思维题"><a href="#144E：思维题" class="headerlink" title="144E：思维题"></a><a href="https://codeforces.com/contest/1447/problem/E" target="_blank" rel="noopener">144E</a>：思维题</h3><ul>
<li>考虑最高位，如果最高位为 1，最高位为 0 的个数都大于 1，那么它们必然不连通，所以我们要将其中的一个变得不超过 1，注意不能贪心。并且注意到如果元素个数不超过 2，必然连通。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, <span class="keyword">int</span>)&gt; dfs = [&amp;](<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a, <span class="keyword">int</span> now) -&gt; <span class="keyword">int</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (now &lt; <span class="number">0</span> || a.<span class="built_in">size</span>() &lt;= <span class="number">2</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; b, c;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> x : a) &#123;</span><br><span class="line">			<span class="keyword">if</span> ((x &gt;&gt; now) &amp; <span class="number">1</span>) b.emplace_back(x);</span><br><span class="line">			<span class="keyword">else</span> c.emplace_back(x);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">std</span>::<span class="built_in">min</span>(dfs(b, now - <span class="number">1</span>) + <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0</span>, <span class="keyword">int</span>(c.<span class="built_in">size</span>() - <span class="number">1</span>)), dfs(c, now - <span class="number">1</span>) + <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0</span>, <span class="keyword">int</span>(b.<span class="built_in">size</span>() - <span class="number">1</span>)));</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; dfs(a, <span class="number">29</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="AtCoder-ABC-183f：并查集-map"><a href="#AtCoder-ABC-183f：并查集-map" class="headerlink" title="AtCoder ABC 183f：并查集 + map"></a><a href="https://atcoder.jp/contests/abc183/tasks/abc183_f" target="_blank" rel="noopener">AtCoder ABC 183f</a>：并查集 + map</h3><p>题意：N 个节点，每个节点有一个值，然后 Q 次操作：<code>1 a b</code> 是将 a, b 所在的群合并，<code>2 x y</code> 求 $x$ 所在的群中，值为 $y$ 的个数。细节优化</p>
<ul>
<li>尽量小的向大的合并，合并完小的记得清空</li>
<li><code>std::map</code> 优于 <code>std::multiset</code></li>
<li><code>std::vector&lt;std::map&lt;int, int&gt;&gt;</code> 优于 <code>std::map&lt;std::map&lt;int, int&gt;&gt;</code></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, q;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q;</span><br><span class="line">	std::vector&lt;int&gt; c(n), p(n);</span><br><span class="line">	<span class="built_in">std</span>::iota(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">	std::vector&lt;std::map&lt;int, int&gt;&gt; mp(n);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : c) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x, --x;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) ++mp[i][c[i]];</span><br><span class="line">	<span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span>)&gt; <span class="built_in">find</span> = [&amp;](<span class="keyword">int</span> x) -&gt; <span class="keyword">int</span> &#123;</span><br><span class="line">		<span class="keyword">int</span> ans = x;</span><br><span class="line">		<span class="keyword">while</span> (ans != p[ans]) ans = p[ans];</span><br><span class="line">		<span class="keyword">while</span> (x != ans) &#123;</span><br><span class="line">			<span class="keyword">int</span> t = p[x];</span><br><span class="line">			p[x] = ans;</span><br><span class="line">			x = t;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ans;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">auto</span> father = [&amp;](<span class="keyword">int</span> i, <span class="keyword">int</span> pi) &#123;</span><br><span class="line">		p[i] = pi;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> it = mp[i].<span class="built_in">begin</span>(); it != mp[i].<span class="built_in">end</span>(); ++it) &#123;</span><br><span class="line">			mp[pi][it-&gt;first] += it-&gt;second;</span><br><span class="line">		&#125;</span><br><span class="line">		mp[i].<span class="built_in">clear</span>();</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">auto</span> merge = [&amp;](<span class="keyword">int</span> i, <span class="keyword">int</span> j) &#123;</span><br><span class="line">		<span class="keyword">int</span> fi = <span class="built_in">find</span>(i), fj = <span class="built_in">find</span>(j);</span><br><span class="line">		<span class="keyword">if</span> (fi != fj) &#123;</span><br><span class="line">			<span class="keyword">if</span> (mp[fi].<span class="built_in">size</span>() &lt; mp[fj].<span class="built_in">size</span>()) father(fi, fj);</span><br><span class="line">			<span class="keyword">else</span> father(fj, fi);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">while</span> (q--) &#123;</span><br><span class="line">		<span class="keyword">int</span> op, a, b;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; op &gt;&gt; a &gt;&gt; b;</span><br><span class="line">		--a; --b;</span><br><span class="line">		<span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">			merge(a, b);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> fa = <span class="built_in">find</span>(a);</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; mp[fa][b] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="AtCoder-ABC-183e：经典-DP"><a href="#AtCoder-ABC-183e：经典-DP" class="headerlink" title="AtCoder ABC 183e：经典 DP"></a><a href="https://atcoder.jp/contests/abc183/tasks/abc183_e" target="_blank" rel="noopener">AtCoder ABC 183e</a>：经典 DP</h3><p>题意：在 $n \times m$ 的格点中，有些点可以走有些不行，每次能往右，下或右下中的一个方向走任意步（但是中间不能有非法点），问有多少种从左上角到右下角的走法。</p>
<blockquote>
<p>显然 DP，然后用类和优化</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, m;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	std::vector&lt;std::vector&lt;int&gt;&gt; a(n, std::vector&lt;int&gt;(m)), al(n, std::vector&lt;int&gt;(m)), au(n, std::vector&lt;int&gt;(m)), ad(n, std::vector&lt;int&gt;(m));</span><br><span class="line">	a[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; <span class="title">s</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : s) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (s[i][j] == <span class="string">'.'</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (j &gt; <span class="number">0</span>) (a[i][j] += al[i][j - <span class="number">1</span>]) %= M;</span><br><span class="line">				<span class="keyword">if</span> (i &gt; <span class="number">0</span>) (a[i][j] += au[i - <span class="number">1</span>][j]) %= M;</span><br><span class="line">				<span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; j &gt; <span class="number">0</span>) (a[i][j] += ad[i - <span class="number">1</span>][j - <span class="number">1</span>]) %= M;</span><br><span class="line">				al[i][j] = au[i][j] = ad[i][j] = a[i][j];</span><br><span class="line">				<span class="keyword">if</span> (j &gt; <span class="number">0</span>) (al[i][j] += al[i][j - <span class="number">1</span>]) %= M;</span><br><span class="line">				<span class="keyword">if</span> (i &gt; <span class="number">0</span>) (au[i][j] += au[i - <span class="number">1</span>][j]) %= M;</span><br><span class="line">				<span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; j &gt; <span class="number">0</span>) (ad[i][j] += ad[i - <span class="number">1</span>][j - <span class="number">1</span>]) %= M;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">				a[i][j] = al[i][j] = au[i][j] = ad[i][j] = <span class="number">0</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; a[n - <span class="number">1</span>][m - <span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1438-数学场"><a href="#1438-数学场" class="headerlink" title="1438 数学场"></a><a href="https://codeforces.com/contest/1438" target="_blank" rel="noopener">1438 数学场</a></h3><p>A 题：$a_i = 1$ 即可<br>B 题：若存在 $i \neq j$ 使得 $a_i = a_j$，则 YES，否则 NO（考虑二进制）<br>C 题：可以根据假设强制让 $a_{i + j}$ 与 $i + j$ 有相同的奇偶性，那么必然满足条件，此问题一般化 <a href="https://codeforces.com/contest/1438/submission/98431377" target="_blank" rel="noopener">解法</a><br>D 题：注意到首先我们可以让数列成对相等并且 $x \otimes x \otimes y = y$，所以如果 $n$ 为奇数，必然就 YES，若 $n$ 为偶数，我们成对这样搞之后，会有两个元素可能不等，又注意到它们相等当且仅当所有值异或为 0，所以搞定</p>
<blockquote>
<p>代码索然无味就不写了</p>
</blockquote>
<h3 id="Atcoder-ABC182F：找钱问题"><a href="#Atcoder-ABC182F：找钱问题" class="headerlink" title="Atcoder ABC182F：找钱问题"></a><a href="https://atcoder.jp/contests/abc182/tasks/abc182_f" target="_blank" rel="noopener">Atcoder ABC182F</a>：找钱问题</h3><p>给定 $n$ 种纸币，$1 = a_1 &lt; a_2 &lt; \cdots a_n$，且 $a_i | a_{i + 1}$，要买商品 $x$，那么可以给 $y \geq x$，找零 $y - x$，要求 $y$ 和 $y - x$ 的最少纸币表达中没有公共纸币。问所有的 $y$ 有没有种。</p>
<blockquote>
<p>注意到 $y$ 和 $(y_1, \cdots, y_n)$，(其中 $y_i * a_i &lt; a_{i + 1}$，且 $y = \sum a_i y_i$ 有一个一一对应。然后我们可以考虑 $x$ 的向量表达，然后再看 $y + x$ 和 $y$ 没公共非零项的做法。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	LL x;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; x;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	x %= a.back();</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">map</span>&lt;LL, LL&gt; mp;</span><br><span class="line">	mp.insert(&#123;x, <span class="number">1</span>&#125;);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">map</span>&lt;LL, LL&gt; mp2;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> it = mp.<span class="built_in">begin</span>(); it != mp.<span class="built_in">end</span>(); ++it) &#123;</span><br><span class="line">			mp2[it-&gt;first / a[i]] += it -&gt; second;</span><br><span class="line">			<span class="keyword">if</span> (it-&gt;first % a[i]) mp2[it-&gt;first / a[i] + <span class="number">1</span>] += it-&gt;second;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; ++j) a[j] /= a[i];</span><br><span class="line">		<span class="built_in">std</span>::swap(mp, mp2); <span class="comment">// 用 swap 更快！</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; mp[<span class="number">0</span>] + mp[<span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="凸优化借助凸包解决"><a href="#凸优化借助凸包解决" class="headerlink" title="凸优化借助凸包解决"></a><a href="https://vjudge.net/problem/Kattis-mobilization" target="_blank" rel="noopener">凸优化借助凸包解决</a></h3><blockquote>
<p>详细解释放在 <a href="https://izlyforever.com/spookywooky/" target="_blank" rel="noopener">izlyforever</a></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"><span class="keyword">using</span> pdd = <span class="built_in">std</span>::pair&lt;<span class="keyword">double</span>, <span class="keyword">double</span>&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-12</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dcmp</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">fabs</span>(x) &lt; eps ? <span class="number">0</span> : (x &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">crossLeft</span><span class="params">(<span class="keyword">const</span> pii &amp;op, <span class="keyword">const</span> pii &amp;sp, <span class="keyword">const</span> pii &amp;ep)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (sp.first - op.first) * (ep.second - op.second) </span><br><span class="line">	&lt; (sp.second - op.second) * (ep.first - op.first);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;pdd&gt; <span class="title">convexHull</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;pdd&gt; p)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::sort(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>());</span><br><span class="line">	p.erase(<span class="built_in">std</span>::unique(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>()), p.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">int</span> n = p.<span class="built_in">size</span>();</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;pdd&gt; <span class="title">q</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; crossLeft(q[top - <span class="number">1</span>], p[i], q[top - <span class="number">2</span>])) --top;</span><br><span class="line">		q[top++] = p[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> len = top;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">2</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">		<span class="keyword">while</span> (top &gt; len &amp;&amp; crossLeft(q[top - <span class="number">1</span>], p[i], q[top - <span class="number">2</span>])) --top;</span><br><span class="line">		q[top++] = p[i];</span><br><span class="line">	&#125;</span><br><span class="line">	top -= n &gt; <span class="number">1</span>;</span><br><span class="line">	q.resize(top);</span><br><span class="line">	<span class="keyword">return</span> q;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">// freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, d, c;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; d;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;pdd&gt; <span class="title">p</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[x, y] : p) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; c &gt;&gt; x &gt;&gt; y;</span><br><span class="line">		x = x * d / c;</span><br><span class="line">		y = y * d / c;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">auto</span> q = convexHull(p);</span><br><span class="line">	<span class="keyword">auto</span> cal = [](pdd p) &#123;</span><br><span class="line">		<span class="keyword">return</span> p.first * p.second;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">auto</span> deal = [](pdd a, pdd b) -&gt; <span class="keyword">double</span> &#123;</span><br><span class="line">		a.first -= b.first; a.second -= b.second;</span><br><span class="line">		<span class="keyword">if</span> (a.first * a.second &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">double</span> t = -(b.first / a.first + b.second / a.second) / <span class="number">2</span>;</span><br><span class="line">			<span class="keyword">if</span> (t &gt; <span class="number">0</span> &amp;&amp; t &lt; <span class="number">1</span>) <span class="keyword">return</span> (a.first * t + b.first) * (a.second * t + b.second);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">double</span> r = <span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : q) r = <span class="built_in">std</span>::<span class="built_in">max</span>(r, cal(x));</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != q.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		r = <span class="built_in">std</span>::<span class="built_in">max</span>(r, deal(q[i], q[(i + <span class="number">1</span>) % q.<span class="built_in">size</span>()]));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span>.precision(<span class="number">12</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::fixed &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Atcoder-arc107C：并查集"><a href="#Atcoder-arc107C：并查集" class="headerlink" title="Atcoder arc107C：并查集"></a><a href="https://atcoder.jp/contests/arc107/tasks/arc107_c" target="_blank" rel="noopener">Atcoder arc107C</a>：并查集</h3><p>首先，如果某两列和交换，那么给它们连边，那么只要任意两列可达，那么它们的位置最后就可以交换，也就是求每个连通分支的大小，直接广搜标记也可以做，当然了用并查集会更简单。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">fac</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">	fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) fac[i] = fac[i - <span class="number">1</span>] * i % M;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">a</span><span class="params">(n, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n))</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : x) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; i;</span><br><span class="line">	<span class="keyword">auto</span> f = [&amp;]() &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p(n);</span><br><span class="line">		<span class="built_in">std</span>::iota(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">auto</span> <span class="built_in">find</span> = [&amp;](<span class="keyword">int</span> x) &#123;</span><br><span class="line">			<span class="keyword">int</span> ans = x;</span><br><span class="line">			<span class="keyword">while</span> (ans != p[ans]) ans = p[ans];</span><br><span class="line">			<span class="keyword">while</span> (x != ans) &#123;</span><br><span class="line">				<span class="keyword">int</span> t = p[x];</span><br><span class="line">				p[x] = ans;</span><br><span class="line">				x = t;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> ans;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; n; ++j) &#123;</span><br><span class="line">				<span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">0</span>; t &lt; n; ++t) &#123;</span><br><span class="line">					<span class="keyword">if</span> (a[i][t] + a[j][t] &gt; k) &#123;</span><br><span class="line">						flag = <span class="literal">false</span>;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (flag) p[<span class="built_in">find</span>(j)] = p[<span class="built_in">find</span>(i)];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) <span class="built_in">find</span>(i);</span><br><span class="line">		LL r = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="keyword">int</span> cnt = <span class="built_in">std</span>::count(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), i);</span><br><span class="line">			r = r * fac[cnt] % M;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;;</span><br><span class="line">	LL r = f();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; ++j) &#123;</span><br><span class="line">			<span class="built_in">std</span>::swap(a[i][j], a[j][i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	r = r * f() % M;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Atcoder-arc107D：经典计算，DP-优化"><a href="#Atcoder-arc107D：经典计算，DP-优化" class="headerlink" title="Atcoder arc107D：经典计算，DP 优化"></a><a href="https://atcoder.jp/contests/arc107/tasks/arc107_d" target="_blank" rel="noopener">Atcoder arc107D</a>：经典计算，DP 优化</h3><p>将 $K$ 写成 $N$ 个形如 $2^{-i}, i \geq 0$ 之和（不计顺序），问有多少中写法。我们不妨将答案记作 <code>dp[n][k]</code><br>那么显然 <code>dp[n][k] = dp[n][2k] + dp[n - 1][2k - 2] + \cdots dp[n - k][0]</code>（考虑取多少个 <code>1</code>，那么剩下的最少要以 $\frac{1}{2}$ 为最大值，那么就等价于剩下的数乘以 <code>2</code>)，所以令 <code>s[a] = dp[a][0] + dp[a + 1][2] + \cdots dp[n][2(n - a)]</code>，这样我们就能迅速求出 <code>dp[n][k]</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">dp</span><span class="params">(n + <span class="number">1</span>, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>))</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i) dp[i][i] = <span class="number">1</span>;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">s</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">	s[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">auto</span> add = [](<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y) &#123;</span><br><span class="line">		(x += y) &gt;= M &amp;&amp; (x -= M);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &gt; <span class="number">0</span>; --j) &#123;</span><br><span class="line">			dp[i][j] = s[i - j];</span><br><span class="line">			<span class="keyword">if</span> (j % <span class="number">2</span> == <span class="number">0</span>) add(s[i - (j / <span class="number">2</span>)], dp[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; dp[n][k] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1442D：经典分治问题"><a href="#1442D：经典分治问题" class="headerlink" title="1442D：经典分治问题"></a><a href="https://codeforces.com/contest/1442/problem/D" target="_blank" rel="noopener">1442D</a>：经典分治问题</h3><blockquote>
<p>首先这是一个很实在的问题。给定 $n$ 个单调递增的序列，从中取 $k$ 个数，但是取数的时候每次只能在序列的最前面取，也就是取最小的。求最大的和。首先注意最多只有一个序列取了一部分，其它的要么没取，要么取完（反证）</p>
</blockquote>
<p>如果直接暴力写，也就是枚举那个只取了一部分的，其它的就是一个 <code>0-1</code> 背包，所以总复杂度为 $O(n^2 k)$，这肯定是过不了的。但是可以分治，也就是说分成两半，一半是<code>0-1</code>背包，另一半是原问题的子问题！这不就有了吗，经典！</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// 	freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt;&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;p : a) &#123;</span><br><span class="line">		<span class="keyword">int</span> cnt;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cnt;</span><br><span class="line">		p.emplace_back(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; cnt; ++i) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">			<span class="keyword">if</span> (i &lt; k) p.push_back(p.back() + x);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">dp</span><span class="params">(k + <span class="number">1</span>, <span class="number">-1e18</span>)</span></span>;</span><br><span class="line">	dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">auto</span> merge = [&amp;](<span class="keyword">int</span> l, <span class="keyword">int</span> r) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = k; j &gt;= a[i].<span class="built_in">size</span>() - <span class="number">1</span>; --j) &#123;</span><br><span class="line">				dp[j] = <span class="built_in">std</span>::<span class="built_in">max</span>(dp[j], dp[j - a[i].<span class="built_in">size</span>() + <span class="number">1</span>] + a[i].back());</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	LL ans = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">std</span>::function&lt;<span class="keyword">void</span>(<span class="keyword">int</span>, <span class="keyword">int</span>)&gt; divide = [&amp;](<span class="keyword">int</span> l, <span class="keyword">int</span> r) &#123;</span><br><span class="line">		<span class="keyword">if</span> (l + <span class="number">1</span> &gt;= r) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; a[l].<span class="built_in">size</span>(); ++i) ans = <span class="built_in">std</span>::<span class="built_in">max</span>(ans, dp[k - i] + a[l][i]);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> m = (l + r + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">auto</span> tmp = dp;</span><br><span class="line">		merge(l, m);</span><br><span class="line">		divide(m, r);</span><br><span class="line">		</span><br><span class="line">		dp = tmp;</span><br><span class="line">		merge(m, r);</span><br><span class="line">		divide(l, m);</span><br><span class="line">	&#125;;</span><br><span class="line">	divide(<span class="number">0</span>, n);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>本来是每一层都是一个 <code>dp</code>，但是 <a href="https://codeforces.com/profile/Itst" target="_blank" rel="noopener">Itst</a> 做了空间优化<br><a href="https://codeforces.com/profile/Jiangly" target="_blank" rel="noopener">Jiangly</a> 写了一个非递归的 $\sqrt{n}$ 的做法，也很犀利。<br>知道在某一个性质的点上取得最值，那么不一定要把这个点求出来，可以在一定范围内把值都比较一边即可，因为极值点的判断有可能相对更为复杂，这可能就是计算机的魅力吧。</p>
</blockquote>
<h3 id="1443D：经典问题"><a href="#1443D：经典问题" class="headerlink" title="1443D：经典问题"></a><a href="https://codeforces.com/contest/1443/problem/D" target="_blank" rel="noopener">1443D</a>：经典问题</h3><p>给定一个非负数列，问是否可以通过前缀减一，后缀减一的方式使得所有的数都变成 0</p>
<blockquote>
<p>一开始以为只需中间的数大于两边的最小值之和就可以，后来发现不对，然后通过自己想了一个例子，然后想到了正确做法，开心<br>这个问题等价与给定 $a$，求非负序列 $p, q$ 满足 $p + q = a$, $p$ 单调减，$q$ 单调递增（在保证条件下，使得$p$ 尽量大）</p>
</blockquote>
<p>做法：看相邻两个数，比如左边比右边大，那么必然右边至少要做后缀减一的操作它们的差值次，也就是说，后面所有的数都要减去这个差值。反之同理，所以搞两个变量，一个是左边累减去（可以用剩余多少来标记），一个是右边累减。没跑一步判断一次。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas = <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">		<span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">int</span> now = a[<span class="number">0</span>], cur = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (a[i] &lt; cur) &#123;</span><br><span class="line">				flag = <span class="literal">false</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (a[i] &gt; a[i - <span class="number">1</span>]) &#123;</span><br><span class="line">				cur += a[i] - a[i - <span class="number">1</span>];</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				now -= a[i] - a[i - <span class="number">1</span>];</span><br><span class="line">				<span class="keyword">if</span> (now &lt; <span class="number">0</span>) &#123;</span><br><span class="line">					flag = <span class="literal">false</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (flag ? <span class="string">"YES\n"</span> : <span class="string">"NO\n"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1445D：一个-trival-的脑力问题"><a href="#1445D：一个-trival-的脑力问题" class="headerlink" title="1445D：一个 trival 的脑力问题"></a><a href="https://codeforces.com/contest/1445/problem/D" target="_blank" rel="noopener">1445D</a>：一个 trival 的脑力问题</h3><p>给定长为 $2n$ 的序列 $a$，分成两个长度为 $n$ 的序列 $p, q$ 然后 $p$ 非降，$q$ 非升，定义 $f(p, q) = \sum_{i = 1}^n |p_i - q_i|$，问所有的 $f(p, q)$ 的和为多少。</p>
<blockquote>
<p>不妨设 $a$ 是有序的，平均分两半，如果 $p$ 在左边取了 $k$ 个元素，那么 $q$ 必然在右边取了 $k$ 个元素，所以无论哪种情况，$f(p, q)$ 是常数。所以结论就显然了！所以可以搞个升级版！。</p>
</blockquote>
<p>答案就是 $\binom{2n}{n} \sum_{i = 1}^{n} (a_{i + n} - a_i)$，代码就不贴了。推公式把我推吐了。</p>
<blockquote>
<p>此题已经被我魔改了，哈哈哈</p>
</blockquote>
<h3 id="1437C：经典问题之动态规划"><a href="#1437C：经典问题之动态规划" class="headerlink" title="1437C：经典问题之动态规划"></a><a href="https://codeforces.com/contest/1437/problem/C" target="_blank" rel="noopener">1437C</a>：经典问题之动态规划</h3><p>给定 $1 \leq a_i \leq n$，求两两不同的正整数 $b_i$，使得 $\sum_{i = 1}^n |a_i - b_i|$ 最小。<br>显然只要 $b$ 的值域确定了，答案就确定了，且 $1 \leq b_i &lt; 2n$。所以就可以对 $a_i$ 排序，然后再 <code>1 ~ 2n - 1</code> 中选 $n$ 个数，使得结果最小。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n + <span class="number">1</span>, <span class="number">1e9</span>)</span></span>;</span><br><span class="line">		<span class="built_in">std</span>::sort(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line">		dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">2</span> * n; ++i) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = n; j &gt; <span class="number">0</span>; --j) dp[j] = <span class="built_in">std</span>::<span class="built_in">min</span>(dp[j], dp[j - <span class="number">1</span>] + <span class="built_in">abs</span>(a[j - <span class="number">1</span>] - i));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">print</span>(dp[n]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="1437E：最长递增子序列"><a href="#1437E：最长递增子序列" class="headerlink" title="1437E：最长递增子序列"></a><a href="https://codeforces.com/contest/1437/problem/E" target="_blank" rel="noopener">1437E</a>：最长递增子序列</h3><p>在固定数组的一些元素的条件下，最小改变多少数，使得数列严格单调递增（减去标号就变成 <strong>不严格</strong> 递增了）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n + <span class="number">2</span>)</span></span>;</span><br><span class="line">	a[<span class="number">0</span>] = <span class="number">-1e9</span> - <span class="number">2</span>, a[n + <span class="number">1</span>] = <span class="number">1e9</span> + <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">		a[i] -= i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">b</span><span class="params">(k + <span class="number">2</span>)</span></span>;</span><br><span class="line">	b[<span class="number">0</span>] = <span class="number">0</span>, b[k + <span class="number">1</span>] = n + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; b[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= k; ++i) <span class="keyword">if</span> (a[b[i]] &lt; a[b[i - <span class="number">1</span>]])&#123;</span><br><span class="line">		<span class="built_in">print</span>(<span class="number">-1</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> r = n - k;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; c;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = b[i] + <span class="number">1</span>; j &lt; b[i + <span class="number">1</span>]; ++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (a[j] &gt;= a[b[i]] &amp;&amp; a[j] &lt;= a[b[i + <span class="number">1</span>]]) &#123;</span><br><span class="line">				<span class="keyword">auto</span> it = <span class="built_in">std</span>::upper_bound(c.<span class="built_in">begin</span>(), c.<span class="built_in">end</span>(), a[j]);</span><br><span class="line">				<span class="keyword">if</span> (it == c.<span class="built_in">end</span>()) c.push_back(a[j]);</span><br><span class="line">				<span class="keyword">else</span> *it = a[j];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		r -= c.<span class="built_in">size</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(r);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1435C：经典选择问题"><a href="#1435C：经典选择问题" class="headerlink" title="1435C：经典选择问题"></a><a href="https://codeforces.com/contest/1435/problem/C" target="_blank" rel="noopener">1435C</a>：经典选择问题</h3><p>题意大致可以转化成：有 $n$ 个人，每个人有 $m$ 个值可以选择，问如何选择才能使得他们的最大值减最小值最小。</p>
<p>做法就是把所有可能的选择进行排序（二维，一维存值，一维存人），然后看所有人至少一次选择的时候最大值和最小值的差是多少。相当于左右两个指针在跑，复杂度为 $O(nm)$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> m = <span class="number">6</span>;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(m)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="built_in">std</span>::sort(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">b</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : b) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;pii&gt; p;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">			p.push_back(&#123;b[j] - a[i], j&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::sort(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>());</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">cnt</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> r = <span class="number">1e9</span> + <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, x = <span class="number">0</span>; i &lt; p.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		<span class="keyword">while</span> (x &lt; n &amp;&amp; j &lt; p.<span class="built_in">size</span>()) &#123;</span><br><span class="line">			<span class="keyword">if</span> (cnt[p[j].second] == <span class="number">0</span>) ++x;</span><br><span class="line">			++cnt[p[j].second];</span><br><span class="line">			++j;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (x &lt; n) <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">if</span> (--cnt[p[i].second] == <span class="number">0</span>) --x;</span><br><span class="line">		r = <span class="built_in">std</span>::<span class="built_in">min</span>(r, p[j - <span class="number">1</span>].first - p[i].first);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(r);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>一开始想枚举最小值，三分法来做（但是我知道凸性一般是不成立的）</p>
</blockquote>
<h3 id="1435D：经典进出问题"><a href="#1435D：经典进出问题" class="headerlink" title="1435D：经典进出问题"></a><a href="https://codeforces.com/contest/1435/problem/D" target="_blank" rel="noopener">1435D</a>：经典进出问题</h3><p>将 $1 ~ n$ 个元素进行加入和提出操作（每个元素一次，共 $2n$）次，并且每次出的是当前集合中最小的值。<br>给定一个进出序列，和出的时候的元素值，求进的元素值（不合理的输出：NO)。</p>
<blockquote>
<p>注意到每出一个元素，那么集合中剩下的元素都要大于出的元素，但是这个信息可以由顶元素上加限制来承载。当在加入一个新元素后，这个限制又被暂时的隐藏了。所以存在当前顶元素上是特别优质的做法。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">r</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">stack</span>&lt;pii&gt; A;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; <span class="number">2</span> * n; ++i) &#123;</span><br><span class="line">		<span class="keyword">char</span> op;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; op;</span><br><span class="line">		<span class="keyword">if</span> (op == <span class="string">'+'</span>) A.push(&#123;now++, <span class="number">0</span>&#125;);</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">			<span class="keyword">if</span> (A.empty() || A.top().second &gt; x) &#123;</span><br><span class="line">				<span class="built_in">print</span>(<span class="string">"NO"</span>);</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				r[A.top().first] = x;</span><br><span class="line">				A.pop();</span><br><span class="line">				<span class="keyword">if</span> (!A.empty()) A.top().second = <span class="built_in">std</span>::<span class="built_in">max</span>(A.top().second, x);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">"YES"</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> x : r) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">	<span class="built_in">println</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>此题一开始题意理解有点问题，最后竟然还 PA，结果最终评测 WA 了。</p>
</blockquote>
<h3 id="AtCoder-arc106d：经典求和计算"><a href="#AtCoder-arc106d：经典求和计算" class="headerlink" title="AtCoder arc106d：经典求和计算"></a><a href="https://atcoder.jp/contests/arc106/tasks/arc106_d" target="_blank" rel="noopener">AtCoder arc106d</a>：经典求和计算</h3><p>对任意 $1 \leq x \leq K$ 求 $\sum_{1 \leq i &lt; j \leq n} (a_i + a_j)^x$</p>
<p>注意到 </p>
<script type="math/tex; mode=display">
2 \sum_{1 \leq i < j \leq n} (a_i + a_j)^x = \sum_{i = 1}^n \sum_{j = 1}^n (a_i + a_j)^x - \sum_{i = 1}^n (2a_i)^x</script><p>然后二项式展开即可。</p>
<blockquote>
<p>若此题 $n$ 比较小，$k$ 比较大（$n$ 特别小时直接 $n^2 \log k$ 就没啥意思了），注意到二项式展开之后是个卷积形式，所以用 NFT 有 $O(nk + k \log k)$ 的做法。例如 $n &lt; 3 \cdot 10^4, k &lt; 10^5$ （时限 5s)</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> LL inv2 = (M + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line"><span class="function">LL <span class="title">powMod</span><span class="params">(LL x, LL n)</span> </span>&#123;</span><br><span class="line">	<span class="function">LL <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (n) &#123;</span><br><span class="line">		<span class="keyword">if</span> (n &amp; <span class="number">1</span>) r = r * x % M;</span><br><span class="line">		n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		x = x * x % M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	std::vector&lt;LL&gt; fac(k + 1), ifac(k + 1);</span><br><span class="line">	fac[<span class="number">0</span>] = ifac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) fac[i] = fac[i - <span class="number">1</span>] * i % M;</span><br><span class="line">	ifac[k] = powMod(fac[k], M - <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = k; i &gt; <span class="number">0</span>; --i) ifac[i - <span class="number">1</span>] = ifac[i] * i % M;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">s</span><span class="params">(k + <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		LL p = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= k; ++j) &#123;</span><br><span class="line">			s[j] += p;</span><br><span class="line">			<span class="keyword">if</span> (s[j] &gt;= M) s[j] -= M;</span><br><span class="line">			p = p * a[i] % M;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">auto</span> C = [&amp;](<span class="keyword">int</span> n, <span class="keyword">int</span> m) &#123;</span><br><span class="line">		<span class="keyword">return</span> fac[n] * ifac[m] % M * ifac[n - m] % M;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="comment">// here nft can be used</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; ++j) &#123;</span><br><span class="line">			r = (r + C(i, j) * s[j] % M * s[i - j] % M) % M;</span><br><span class="line">		&#125;</span><br><span class="line">		r = (r - powMod(<span class="number">2</span>, i) * s[i]) % M;</span><br><span class="line">		<span class="keyword">if</span> (r &lt; <span class="number">0</span>) r += M;</span><br><span class="line">		r = r * inv2 % M;</span><br><span class="line">		<span class="built_in">print</span>(r);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1436E-MEX"><a href="#1436E-MEX" class="headerlink" title="1436E: MEX"></a><a href="https://codeforces.com/contest/1436/problem/E" target="_blank" rel="noopener">1436E</a>: MEX</h3><p>求 $MEX(MEX(L, R)_{1 \leq L \leq R \leq n}$)，其中 $MEX(L, R)$ 为使得 $a_L, a_{L + 1} \cdots, a_{R}$ 中没出现的最小正整数。</p>
<p>做法：先求出所有 MEX(i, n)，这是能在 $O(n)$ 时间复杂度解决的（因为 MEX 会随着 i 递减而增大，并且值域不超过 $n$）。然后我们删除尾部的点，那么在从右往左首次出现 $Mex(i, n) &gt; a[n]$ 的 <code>pre[n] + 1 ~ i</code> 这一段的值都要改成 <code>a[n]</code>,这里 <code>pre[x]</code> 表示 <code>x</code> 位置前一个值为 <code>a[x]</code> 的位置。那么区间线段树就搞定了。</p>
<blockquote>
<p>没在比赛时候写出，不想写了！</p>
</blockquote>
<h3 id="hdu-4747-MEX"><a href="#hdu-4747-MEX" class="headerlink" title="hdu 4747: MEX"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=4747" target="_blank" rel="noopener">hdu 4747</a>: MEX</h3><p>求 $\sum_{1 \leq L \leq R \leq n} MEX(L, R)$)，其中 $MEX(L, R)$ 为使得 $a_L, a_{L + 1} \cdots, a_{R}$ 中没出现的最小自然数</p>
<blockquote>
<p>同理与上面做法，代码不写了，懒得写线段树。</p>
<p>有的 MEX 定义包含 0, 有的不包含，无所谓啦。</p>
</blockquote>
<h3 id="1433G-将某条边的权值置零下最短路径"><a href="#1433G-将某条边的权值置零下最短路径" class="headerlink" title="1433G: 将某条边的权值置零下最短路径"></a><a href="https://codeforces.com/contest/1433/problem/G" target="_blank" rel="noopener">1433G</a>: 将某条边的权值置零下最短路径</h3><blockquote>
<p>我一开始以为是缩点… 想太多了，做法就是先求出任意两点的距离，然后边 <code>x -&gt; y</code> 置零可以看成 <code>a -&gt; b</code> 多了两种选择 <code>a -&gt; x - &gt; y - &gt; b</code> 和 <code>a -&gt; y -&gt; x -&gt; b</code> 就好了。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">auto</span> cmax = [](<span class="keyword">auto</span> &amp;x, <span class="keyword">auto</span> y) &#123;</span><br><span class="line">		<span class="keyword">if</span> (x &lt; y) x = y;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">auto</span> cmin = [](<span class="keyword">auto</span> &amp;x, <span class="keyword">auto</span> y) &#123;</span><br><span class="line">		<span class="keyword">if</span> (x &gt; y) x = y;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> n, m, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">d</span><span class="params">(n, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n, <span class="number">1e9</span>))</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) d[i][i] = <span class="number">0</span>;</span><br><span class="line">	std::vector&lt;std::tuple&lt;int, int, int&gt;&gt; road(m);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[x, y, w] : road) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y &gt;&gt; w;</span><br><span class="line">		--x; --y;</span><br><span class="line">		cmin(d[x][y], w);</span><br><span class="line">		d[y][x] = d[x][y];</span><br><span class="line">	&#125;</span><br><span class="line">	std::vector&lt;std::pair&lt;int, int&gt;&gt; travel(k);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[a, b] : travel) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</span><br><span class="line">		--a; --b;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">auto</span> floyd = [&amp;]()&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k != n; ++k)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i != n; ++i)</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j != n; ++j)</span><br><span class="line">					cmin(d[i][j], d[i][k] + d[k][j]);</span><br><span class="line">	&#125;;</span><br><span class="line">	floyd();</span><br><span class="line">	LL r = <span class="number">1e9</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> [x, y, w] : road) &#123;</span><br><span class="line">		LL now = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> [a, b] : travel) &#123;</span><br><span class="line">			now += <span class="built_in">std</span>::<span class="built_in">min</span>(&#123;d[a][b], d[a][x] + d[y][b], d[a][y] + d[x][b]&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">		cmin(r, now);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(r);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>用堆优化 Dijkstra 会更快一些，用 priority_quque 比 set 快一些。不过 set 比 priority_quque 方便很多（好遍历删除等操作）。</p>
</blockquote>
<h3 id="439D：三分法模板题"><a href="#439D：三分法模板题" class="headerlink" title="439D：三分法模板题"></a><a href="https://codeforces.com/contest/439/problem/D" target="_blank" rel="noopener">439D</a>：三分法模板题</h3><p>每次操作可以增加某个数或者减少某个数，问最小多少次操作可以让 <code>a</code> 的最小值不小于 <code>b</code> 的最大值</p>
<p>我们可以枚举 <code>a</code> 最终的最小值 <code>t</code>，那么答案就是 $\sum_{a_i &lt; t} (t - a_i) + \sum_{b_i &gt; t} (b_i - t)$<br>求导然后就知道了它是凸函数了。然后就可以三分法求了。</p>
<h3 id="三分法求凸函数最值"><a href="#三分法求凸函数最值" class="headerlink" title="三分法求凸函数最值"></a><a href="https://codeforces.com/contest/439/problem/D" target="_blank" rel="noopener">三分法求凸函数最值</a></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, m;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	std::vector&lt;int&gt; a(n), b(m);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : b) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">auto</span> f = [&amp;](<span class="keyword">int</span> ma) &#123;</span><br><span class="line">		LL r = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> x : a) <span class="keyword">if</span> (x &lt; ma) r += ma - x;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> x : b) <span class="keyword">if</span> (x &gt; ma) r += x - ma;</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">1e9</span>;</span><br><span class="line">	<span class="keyword">while</span> (l + <span class="number">2</span> &lt; r) &#123;</span><br><span class="line">		<span class="keyword">int</span> lm = (<span class="number">2l</span>l * l + r) / <span class="number">3</span>, rm = (l + <span class="number">2l</span>l * r + <span class="number">2</span>) / <span class="number">3</span>;</span><br><span class="line">		<span class="keyword">if</span> (f(lm) &lt; f(rm)) r = rm;</span><br><span class="line">		<span class="keyword">else</span> l = lm;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">		<span class="keyword">if</span> (f(l) &lt; f(r)) --r;</span><br><span class="line">		<span class="keyword">else</span> ++l;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(f(l));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>当然了此题有更简单的做法：将 <code>a</code> 升序，<code>b</code> 降序，然后答案就是 <code>a[i] - b[i]</code> 为正的和。</p>
</blockquote>
<h3 id="1421A：异或，和，交的关系"><a href="#1421A：异或，和，交的关系" class="headerlink" title="1421A：异或，和，交的关系"></a><a href="https://codeforces.com/contest/1421/problem/A" target="_blank" rel="noopener">1421A</a>：异或，和，交的关系</h3><blockquote>
<p>$(a \oplus x) + (x \oplus b)$ 的最小值，$a \oplus b$，此时 <code>x = a &amp; b</code></p>
</blockquote>
<h3 id="1421E：观察总结题"><a href="#1421E：观察总结题" class="headerlink" title="1421E：观察总结题"></a><a href="https://codeforces.com/contest/1421/problem/E" target="_blank" rel="noopener">1421E</a>：观察总结题</h3><ul>
<li>任何情况下的答案都是 每一项前添加正负号得到的。</li>
<li>相邻两个之间添加的正负号必然有一个是相同的，即不会出现 <code>+-+-+</code> 或 <code>-+-+-</code> 的情况</li>
<li>负号个数 $m$，总个数 $n$，满足 $(n + m) \equiv 1 \mod 3$（可以通过归纳得到，并且 $n$ 个正负号的情况可以看作 $n - 1$ 个正负号中某一个改变符号并且出现两个，再塞进去）</li>
<li>所有的情况如上所言（可以数学归纳证明）</li>
</ul>
<p>我们用 <code>DP[n][3][2][2]</code> 保存全部状态。<code>DP[i][j][k][p]</code> 分别表示当前 <code>i</code> 个位置，(i + 负数个数 <code>mod 3</code>) 等于 <code>j</code> 且<code>k</code> 表示是否非法（是否存在连续的正或负），<code>p</code> 表示最后以为是否为正的最大结果。</p>
<blockquote>
<p>例如 <code>DP[i][j][1][1]</code> 表示前 <code>i</code> 位（<code>i</code> 与 前 <code>i</code> 位负号个数的和模 3 位 <code>j</code>) 且有连续的负号或者正号，且第 <code>i</code> 位为负号的最大和。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">2</span>;</span><br><span class="line">LL dp[N][<span class="number">3</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">memset</span>(dp, <span class="number">-0x3f</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">	<span class="keyword">auto</span> upmax = [](LL &amp;a, LL b) &#123;</span><br><span class="line">		<span class="keyword">if</span> (a &lt; b) a = b;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="built_in">print</span>(a[<span class="number">0</span>]);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	dp[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] = a[<span class="number">0</span>];</span><br><span class="line">	dp[<span class="number">0</span>][<span class="number">2</span>][<span class="number">0</span>][<span class="number">1</span>] = -a[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">2</span>; ++k) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">0</span>; p &lt; <span class="number">2</span>; ++p) &#123;</span><br><span class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">0</span>; b &lt; <span class="number">2</span>; ++b) &#123;</span><br><span class="line">						<span class="keyword">int</span> digit = (j + <span class="number">1</span> + b) % <span class="number">3</span>;</span><br><span class="line">						upmax(dp[i][digit][k | (p == b)][b], dp[i - <span class="number">1</span>][j][k][p] + (b == <span class="number">0</span> ? a[i]: -a[i]));</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">std</span>::<span class="built_in">max</span>(dp[n - <span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>], dp[n - <span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>]));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>此题多维数组写 Vector 不方便，但是又不能开局部数组（因为太大了），所以只能全局变量啦。</p>
</blockquote>
<h3 id="1428D：模拟题"><a href="#1428D：模拟题" class="headerlink" title="1428D：模拟题"></a><a href="https://codeforces.com/contest/1428/problem/D" target="_blank" rel="noopener">1428D</a>：模拟题</h3><blockquote>
<p>由简单到复杂一步步的来，很不错的题。</p>
</blockquote>
<h3 id="1428E：经典问题，正整数划分最值问题（可看作优先队列模板题）"><a href="#1428E：经典问题，正整数划分最值问题（可看作优先队列模板题）" class="headerlink" title="1428E：经典问题，正整数划分最值问题（可看作优先队列模板题）"></a><a href="https://codeforces.com/contest/1428/problem/E" target="_blank" rel="noopener">1428E</a>：经典问题，正整数划分最值问题（可看作优先队列模板题）</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">val</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> &amp;x, <span class="keyword">const</span> <span class="keyword">int</span> &amp;n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> xn = x / n, rn = x - xn * n;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1l</span>l * xn * xn * (n - rn) + <span class="number">1l</span>l * (xn + <span class="number">1</span>) * (xn + <span class="number">1</span>) * rn;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">cmpVal</span><span class="params">(<span class="keyword">const</span> pii &amp;A)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> val(A.first, A.second) - val(A.first, A.second + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cmp</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="keyword">const</span> pii &amp;lhs, <span class="keyword">const</span> pii &amp;rhs)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> cmpVal(lhs) &lt; cmpVal(rhs); </span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	<span class="built_in">std</span>::priority_queue&lt;pii, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;pii&gt;, cmp&gt; Q;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">		Q.push(&#123;x, <span class="number">1</span>&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (n &lt; k) &#123;</span><br><span class="line">		++n;</span><br><span class="line">		<span class="keyword">auto</span> [x, cnt] = Q.top();</span><br><span class="line">		Q.pop();</span><br><span class="line">		Q.push(&#123;x, cnt + <span class="number">1</span>&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	LL r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (!Q.empty()) &#123;</span><br><span class="line">		<span class="keyword">auto</span> [x, cnt] = Q.top();</span><br><span class="line">		Q.pop();</span><br><span class="line">		r += val(x, cnt);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(r);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>若此题 $k$ 特别大，可二分 cmpVal 的题来解决。</p>
</blockquote>
<h3 id="1428F-经典-DP"><a href="#1428F-经典-DP" class="headerlink" title="1428F: 经典 DP"></a><a href="https://codeforces.com/contest/1428/problem/F" target="_blank" rel="noopener">1428F</a>: 经典 DP</h3><p>题意：给定 0-1 序列 S，设 $f(l, r)$ 表示 $S_l S_{l + 1} \cdots, S_{r}$ 中最长连续 1 的个数，求 $\sum_{l = 1}^n \sum_{r = l}^n f(l, r)$</p>
<blockquote>
<p><a href="https://codeforces.com/blog/entry/83771" target="_blank" rel="noopener">官方题解</a> 实在是太精彩了！这种直方图的做法真的很 Nice！</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> s;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; s;</span><br><span class="line">	LL ans = <span class="number">0</span>, cur = <span class="number">0</span>;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">left</span><span class="params">(n + <span class="number">1</span>, <span class="number">-1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (s[i] == <span class="string">'0'</span>) ans += cur;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> l = i, r = i;</span><br><span class="line">			<span class="keyword">while</span> (r &lt; n &amp;&amp; s[r] == <span class="string">'1'</span>) ++r;</span><br><span class="line">			<span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (i = l; i &lt; r; ++i) &#123;</span><br><span class="line">				++len;</span><br><span class="line">				cur += i - left[len];</span><br><span class="line">				ans += cur;</span><br><span class="line">				left[len] = r - len;</span><br><span class="line">			&#125;</span><br><span class="line">			--i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(ans);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1430F：反向-DP"><a href="#1430F：反向-DP" class="headerlink" title="1430F：反向 DP"></a><a href="https://codeforces.com/contest/1430/problem/F" target="_blank" rel="noopener">1430F</a>：反向 DP</h3><p>我想到反向 DP (<code>DP[i]</code> 表示这次本次要预留的子弹数为多少），但是还是不明确怎么写。我们可以看每一波的时候至少需要多少子弹预留。然后合理性检测，最后再从头到尾走一波就知道用多少子弹。把检测和计算分两次搞。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	std::vector&lt;int&gt; a(n), l(n), r(n), dp(n);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; l[i] &gt;&gt; r[i] &gt;&gt; a[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">		<span class="keyword">int</span> need = a[i];</span><br><span class="line">		<span class="keyword">if</span> (i &lt; n - <span class="number">1</span> &amp;&amp; r[i] == l[i + <span class="number">1</span>]) need += dp[i + <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span> (LL(r[i] - l[i] + <span class="number">1</span>) * k &lt; need) &#123;</span><br><span class="line">			<span class="built_in">print</span>(<span class="number">-1</span>);</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		dp[i] = <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0L</span>L, need - LL(r[i] - l[i]) * k);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> cur = k;</span><br><span class="line">	LL ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		ans += a[i];</span><br><span class="line">		<span class="keyword">if</span> (cur &lt; dp[i]) &#123;</span><br><span class="line">			ans += cur;</span><br><span class="line">			cur = k;</span><br><span class="line">		&#125;</span><br><span class="line">		cur = ((cur - a[i]) % k + k) % k;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(ans);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1430E：可以转化成求逆序数"><a href="#1430E：可以转化成求逆序数" class="headerlink" title="1430E：可以转化成求逆序数"></a><a href="https://codeforces.com/contest/1430/problem/E" target="_blank" rel="noopener">1430E</a>：可以转化成求逆序数</h3><p>这种只能交换相邻位置的问题，一般都能转换成逆序数。我们先根据最后的状态来定义序关系，然后对应赋值，再求逆序数就好了！</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TreeArray</span> &#123;</span></span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; s;</span><br><span class="line">	TreeArray() &#123;&#125;</span><br><span class="line">	TreeArray(<span class="keyword">int</span> n) &#123; init(n); &#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">		s.resize(n + <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">fill</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; </span><br><span class="line">		<span class="keyword">return</span> n &amp; (-n);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">while</span> (id &lt; s.<span class="built_in">size</span>()) &#123;</span><br><span class="line">			s[id] += p;</span><br><span class="line">			id += lowbit(id);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">LL <span class="title">sum</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		LL r = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (id) &#123;</span><br><span class="line">			r += s[id];</span><br><span class="line">			id -= lowbit(id);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// find minimal index s.t. sum(id) &gt;= x, sum must be increased</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(LL val)</span> </span>&#123;</span><br><span class="line">		LL sum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="built_in">std</span>::__lg(s.<span class="built_in">size</span>()); ~i; --i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (id + (<span class="number">1</span> &lt;&lt; i) &lt; s.<span class="built_in">size</span>() &amp;&amp; sum + s[id + (<span class="number">1</span> &lt;&lt; i)] &lt; val) &#123;</span><br><span class="line">				id += (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">				sum += s[id];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ++id;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> s;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; s;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; tmp[<span class="number">26</span>];</span><br><span class="line">	<span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = s.<span class="built_in">size</span>() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) tmp[s[i] - <span class="string">'a'</span>].emplace_back(++now);</span><br><span class="line">	std::vector&lt;int&gt; a(n + 1), p(n + 1);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">0</span>; --i) &#123;</span><br><span class="line">		a[i] = tmp[s[i - <span class="number">1</span>] - <span class="string">'a'</span>].back();</span><br><span class="line">		tmp[s[i - <span class="number">1</span>] - <span class="string">'a'</span>].pop_back();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) p[a[i]] = i;</span><br><span class="line">	<span class="function">TreeArray <span class="title">A</span><span class="params">(n)</span></span>;</span><br><span class="line">	LL r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">0</span>; --i) &#123;</span><br><span class="line">		r += A.sum(p[i]);</span><br><span class="line">		A.add(p[i], <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(r);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="清华集训-2016-组合数问题"><a href="#清华集训-2016-组合数问题" class="headerlink" title="清华集训 2016 组合数问题"></a><a href="https://uoj.ac/problem/275" target="_blank" rel="noopener">清华集训 2016 组合数问题</a></h3><p>给定 $1 \leq n, m \leq 10^{18}$ 和素数 $p$，求所有 $0 \leq i \leq n, 0 \leq j \leq \min(i,m)$ 中有多少对 $(i, j)$ 满足 ${i \choose j}$ 是 $p$ 的倍数。</p>
<blockquote>
<p>${i \choose j}$ 是 $p$ 的倍数当且仅当 $i, j$ 的 $p$ 进制中至少有一位 $x$ 满足 $i_x &lt; j_x$（利用 Lucas 定理显然）。</p>
</blockquote>
<p>所以最终答案就是 </p>
<script type="math/tex; mode=display">
\frac{(n + 1)(n + 2)}{2} - \frac{k(k+1)}{2} - f(n, m)</script><p>其中 $k = \max(0, n - m)$，$f(n, m)$ 表示 $i$ 的 每一位都满足 $i_x \geq j_x$ 的方案数，注意到此时必有 $i &gt; j$，所以这里的 $i, j$ 限制分别是 $0 \leq i \leq n, 0 \leq j \leq m$. 并且可以让 $m = \min(m, n)$，我们可以从最低位开始 DP 就好了。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">LL inv2 = (M + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas, p;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas &gt;&gt; p;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		LL n, m;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">		m = <span class="built_in">std</span>::<span class="built_in">min</span>(m, n);</span><br><span class="line">		LL r = (<span class="number">2</span> * n + <span class="number">2</span> - m) % M * ((m + <span class="number">1</span>) % M) % M * inv2 % M;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; an, bm;</span><br><span class="line">		<span class="keyword">auto</span> digit = [&amp;]() &#123;</span><br><span class="line">			<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span> (n) &#123;</span><br><span class="line">				an.emplace_back(n % p);</span><br><span class="line">				bm.emplace_back(m % p);</span><br><span class="line">				n /= p;</span><br><span class="line">				m /= p;</span><br><span class="line">				++r;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> r;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">int</span> d = digit();</span><br><span class="line">		<span class="comment">// dp[i][sa][sb]; sa, sb 分别表示 $a, b$ 第 $i$ 为是否有限制</span></span><br><span class="line">		LL dp[d + <span class="number">1</span>][<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) dp[<span class="number">0</span>][i / <span class="number">2</span>][i % <span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; d; ++i) &#123;</span><br><span class="line">			dp[i + <span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] = (p + <span class="number">1</span>) * p / <span class="number">2</span> * dp[i][<span class="number">0</span>][<span class="number">0</span>] % M;</span><br><span class="line">			dp[i + <span class="number">1</span>][<span class="number">0</span>][<span class="number">1</span>] = ((<span class="number">2</span> * p - bm[i] + <span class="number">1</span>) * bm[i] / <span class="number">2</span> * dp[i][<span class="number">0</span>][<span class="number">0</span>] + (p - bm[i]) * dp[i][<span class="number">0</span>][<span class="number">1</span>]) % M;</span><br><span class="line">			dp[i + <span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>] = ((an[i] + <span class="number">1</span>) * an[i] / <span class="number">2</span> * dp[i][<span class="number">0</span>][<span class="number">0</span>] + (an[i] + <span class="number">1</span>) * dp[i][<span class="number">1</span>][<span class="number">0</span>]) % M;</span><br><span class="line">			dp[i + <span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span> (an[i] &gt;= bm[i]) dp[i + <span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>] += (an[i] - bm[i]) * dp[i][<span class="number">0</span>][<span class="number">1</span>] + dp[i][<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">			<span class="keyword">else</span> dp[i + <span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>] += dp[i][<span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">			bm[i] = <span class="built_in">std</span>::<span class="built_in">min</span>(bm[i], an[i]);</span><br><span class="line">			(dp[i + <span class="number">1</span>][<span class="number">1</span>][<span class="number">1</span>] += (<span class="number">2</span> * an[i] + <span class="number">1</span> - bm[i]) * bm[i] / <span class="number">2</span> * dp[i][<span class="number">0</span>][<span class="number">0</span>] + bm[i] * dp[i][<span class="number">1</span>][<span class="number">0</span>]) %= M;</span><br><span class="line">		&#125;</span><br><span class="line">		r = (r + M - dp[d][<span class="number">1</span>][<span class="number">1</span>]) % M;</span><br><span class="line">		<span class="built_in">print</span>(r); </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="清华集训-2016-求和"><a href="#清华集训-2016-求和" class="headerlink" title="清华集训 2016 求和"></a><a href="https://uoj.ac/problem/269" target="_blank" rel="noopener">清华集训 2016 求和</a></h3><p>$f$ 是一个次数不超过 $m$ 的多项式，满足 $f(i) = a_i, i = 0, \cdots, m$，求</p>
<script type="math/tex; mode=display">
\sum_{k = 0}^n f(k) {n \choose k} x^k (1 - x)^{n-k} \mod 998244353</script><p>给定 $n, m, x$ 和 $a_0, \cdots, a_m$，其中 $1 \leq n \leq 10^9, 1 \leq m  \leq 2 \cdot 10^4, 0 \leq a_i, x \leq 998244353$</p>
<blockquote>
<p>做法：利用二项式反演，记 $f(k) = \sum_{i = 0}^k {k \choose i} f_i$，则 $f_k = \sum_{i = 0}^k {k \choose i} (-1)^{k-i} f(i)$ 注意到 $f(x)$ 是次数不超过 $m$ 的多项式，所以 $f_{m + 1} = f_{m + 2} = \cdots = 0$</p>
</blockquote>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{k = 0}^n f(k) {n \choose k} x^k (1 - x)^{n-k} 
&= \sum_{k = 0}^n \sum_{i = 0}^k {n \choose k} {k \choose i} f_i x^k (1 - x)^{n-k} \\
&= \sum_{i = 0}^n \sum_{k = i}^n {n \choose i}  {n - i \choose k - i} f_i x^k (1 - x)^{n-k} \\
&= \sum_{i = 0}^n f_i {n \choose i}  x^i (1 - x)^ {n - i} \sum_{k - i = 0}^{n - i} {n - i \choose k - i} x^{k - i} (1 - x)^{i - k} \\
&= \sum_{i = 0}^n f_i {n \choose i}  x^i (1 - x)^ {n - i} (1 + \frac{x}{1-x})^{n - i} \\
&= \sum_{i = 0}^n f_i {n \choose i}  x^i
\end{aligned}\</script><p>上述式子最后一项，只有 $m + 1$ 项，$f_0, \cdots, f_m$ 可以由 NFT 计算。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e4</span> + <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> LL ROOT = <span class="number">3</span>;</span><br><span class="line"><span class="function">LL <span class="title">powMod</span><span class="params">(LL x, LL n)</span> </span>&#123;</span><br><span class="line">	<span class="function">LL <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (n) &#123;</span><br><span class="line">		<span class="keyword">if</span> (n &amp; <span class="number">1</span>) r = r * x % M;</span><br><span class="line">		n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		x = x * x % M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line">LL fac[N], ifac[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) fac[i] = fac[i - <span class="number">1</span>] * i % M;</span><br><span class="line">	ifac[N - <span class="number">1</span>] = powMod(fac[N - <span class="number">1</span>], M - <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i; --i) ifac[i - <span class="number">1</span>] = ifac[i] * i % M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bitreverse</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; &amp;a)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i != a.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i &gt; j) <span class="built_in">std</span>::swap(a[i], a[j]);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> l = a.<span class="built_in">size</span>() &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			(j ^= l) &lt; l; l &gt;&gt;= <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">nft</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; &amp;a, <span class="keyword">bool</span> isInverse = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">	LL g = powMod(ROOT, (M - <span class="number">1</span>) / a.<span class="built_in">size</span>());</span><br><span class="line">	<span class="keyword">if</span> (isInverse) &#123;</span><br><span class="line">		g = powMod(g, M - <span class="number">2</span>);</span><br><span class="line">		LL invLen = powMod(LL(a.<span class="built_in">size</span>()), M - <span class="number">2</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp; x: a) x = x * invLen % M;</span><br><span class="line">	&#125;</span><br><span class="line">	bitreverse(a);</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">w</span><span class="params">(a.<span class="built_in">size</span>(), <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i != w.<span class="built_in">size</span>(); ++i) w[i] = w[i - <span class="number">1</span>] * g % M;</span><br><span class="line">	<span class="keyword">auto</span> addMod = [](LL x, LL y) &#123;</span><br><span class="line">		<span class="keyword">return</span> (x += y) &gt;= M ? x -= M : x;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> <span class="built_in">step</span> = <span class="number">2</span>, half = <span class="number">1</span>; half != a.<span class="built_in">size</span>(); <span class="built_in">step</span> &lt;&lt;= <span class="number">1</span>, half &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, wstep = a.<span class="built_in">size</span>() / <span class="built_in">step</span>; i != a.<span class="built_in">size</span>(); i += <span class="built_in">step</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = i; j != i + half; ++j) &#123;</span><br><span class="line">				LL t = (a[j + half] * w[wstep * (j - i)]) % M;</span><br><span class="line">				a[j + half] = addMod(a[j], M - t);</span><br><span class="line">				a[j] = addMod(a[j], t);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt;&amp; a, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sz = <span class="number">1</span>, tot = a.<span class="built_in">size</span>() + b.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (sz &lt; tot) sz *= <span class="number">2</span>;</span><br><span class="line">	a.resize(sz);</span><br><span class="line">	b.resize(sz);</span><br><span class="line">	nft(a);</span><br><span class="line">	nft(b);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != sz; ++i) a[i] = a[i] * b[i] % M;</span><br><span class="line">	nft(a, <span class="number">1</span>);</span><br><span class="line">	a.resize(tot);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	init();</span><br><span class="line">	<span class="keyword">int</span> m, n, x;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; x;</span><br><span class="line">	std::vector&lt;LL&gt; a(m + 1), b(m + 1);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">		a[i] = ifac[i] * a[i] % M;</span><br><span class="line">		b[i] = (i % <span class="number">2</span> == <span class="number">0</span>) ? ifac[i] : M - ifac[i];</span><br><span class="line">	&#125;</span><br><span class="line">	mul(a, b);</span><br><span class="line">	a.resize(m + <span class="number">1</span>);</span><br><span class="line">	LL r = <span class="number">0</span>, Anx = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; ++i) &#123;</span><br><span class="line">		r += Anx * a[i] % M;</span><br><span class="line">		Anx = Anx * (n - i) % M * x % M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(r % M);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ZOJ-3820：树的重心-直径"><a href="#ZOJ-3820：树的重心-直径" class="headerlink" title="ZOJ 3820：树的重心 + 直径"></a><a href="https://vjudge.net/problem/ZOJ-3820" target="_blank" rel="noopener">ZOJ 3820</a>：树的重心 + 直径</h3><p>题意：在一棵树上选择两个点，使得任意点到这两点的最小值的最大值最小。</p>
<blockquote>
<p>如果仅仅选择一个点，那么这个问题就是树的重心。</p>
<p>对此情况，将直径按照中点切开，然后分别求两颗子树的中心, <a href="https://blog.csdn.net/ok_again/article/details/40043197" target="_blank" rel="noopener">参考资料</a></p>
</blockquote>
<p>证明：如果 u,v 是满足条件的两个点，那么把他们沿着中间切开必然最优，然后反证它们在树的直径上。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">e</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			--u; --v;</span><br><span class="line">			e[u].emplace_back(v);</span><br><span class="line">			e[v].emplace_back(u);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">d</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">auto</span> bfs = [&amp;](<span class="keyword">int</span> x) -&gt; <span class="keyword">int</span> &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">fill</span>(d.<span class="built_in">begin</span>(), d.<span class="built_in">end</span>(), <span class="number">-1</span>);</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line">			d[x] = <span class="number">0</span>;</span><br><span class="line">			Q.push(x);</span><br><span class="line">			<span class="keyword">while</span> (!Q.empty()) &#123;</span><br><span class="line">				<span class="keyword">int</span> u = Q.front();</span><br><span class="line">				Q.pop();</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">auto</span> v : e[u]) <span class="keyword">if</span> (d[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">					d[v] = d[u] + <span class="number">1</span>;</span><br><span class="line">					Q.push(v);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">std</span>::max_element(d.<span class="built_in">begin</span>(), d.<span class="built_in">end</span>()) - d.<span class="built_in">begin</span>();</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> f = [&amp;](<span class="keyword">int</span> v) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a;</span><br><span class="line">			a.emplace_back(v);</span><br><span class="line">			<span class="keyword">while</span> (d[a.back()]) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">auto</span> v: e[a.back()]) <span class="keyword">if</span> (d[v] + <span class="number">1</span> == d[a.back()]) &#123;</span><br><span class="line">					a.emplace_back(v);</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">int</span> mid = a.<span class="built_in">size</span>() / <span class="number">2</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">std</span>::make_pair(a[mid - <span class="number">1</span>], a[mid]);</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">auto</span> [u, v] = f(bfs(bfs(<span class="number">0</span>)));</span><br><span class="line">		e[u].erase(<span class="built_in">std</span>::<span class="built_in">find</span>(e[u].<span class="built_in">begin</span>(), e[u].<span class="built_in">end</span>(), v));</span><br><span class="line">		e[v].erase(<span class="built_in">std</span>::<span class="built_in">find</span>(e[v].<span class="built_in">begin</span>(), e[v].<span class="built_in">end</span>(), u));</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> ru = bfs(bfs(u)), ansu = (d[ru] + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">auto</span> ra = f(ru).second;</span><br><span class="line">		<span class="keyword">int</span> rv = bfs(bfs(v)), ansv = (d[rv] + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">		<span class="keyword">auto</span> rb = f(rv).second;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">max</span>(ansu, ansv) &lt;&lt; <span class="string">" "</span> &lt;&lt; ru + <span class="number">1</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; rv + <span class="number">1</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1422D：堆优化-Dijkstra-复杂度-O-n-log-E"><a href="#1422D：堆优化-Dijkstra-复杂度-O-n-log-E" class="headerlink" title="1422D：堆优化 Dijkstra 复杂度 $O(n \log E)$"></a><a href="https://codeforces.com/contest/1422/problem/D" target="_blank" rel="noopener">1422D</a>：堆优化 Dijkstra 复杂度 $O(n \log E)$</h3><blockquote>
<p>这里的边数 E 针对本问题可以大大优化，代码可参考 <a href="https://codeforces.com/contest/1422/submission/94679999" target="_blank" rel="noopener">Jiangly 的代码</a></p>
</blockquote>
<h3 id="1422C"><a href="#1422C" class="headerlink" title="1422C"></a><a href="https://codeforces.com/contest/1422/problem/C" target="_blank" rel="noopener">1422C</a></h3><blockquote>
<p>一开始读题读错了，少看了一个连续导致浪费了很多时间（30 分钟）。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">string</span> a;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a;</span><br><span class="line">	LL r = <span class="number">0</span>, n = <span class="number">0</span>, id = <span class="number">1</span>, r2 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> x : a) &#123;</span><br><span class="line">		r = (r * <span class="number">10</span> + id * (id - <span class="number">1</span>) / <span class="number">2</span> * (x - <span class="string">'0'</span>) + r2) % M;</span><br><span class="line">		n = (n * <span class="number">10</span> + (x - <span class="string">'0'</span>)) % M;</span><br><span class="line">		r2 += n;</span><br><span class="line">		++id;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(r);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Atcoder-ARC-104D"><a href="#Atcoder-ARC-104D" class="headerlink" title="Atcoder ARC 104D"></a><a href="https://atcoder.jp/contests/arc104/tasks/arc104_d" target="_blank" rel="noopener">Atcoder ARC 104D</a></h3><blockquote>
<p>E, F 题也是好题，不过不懂。</p>
</blockquote>
<p>问题描述：对每一个 $m \in [1, n]$ 求满足 $\sum_{x \in S} (x - m) = 0$ 的集合 $S$ 的个数，其中 “集合” $S$ 是由 <code>1~n</code> 中元素构成，元素可重，重数不超过 k。这等价于说 $\sum_{x \in S} x = \sum_{x \in T} x$ 的个数乘以 $k + 1$，其中 $S$ 是由 <code>1 ~ m - 1</code> 构成，$T$ 由 <code>1 ~ n - m</code> 构成。</p>
<p>做法：我们设 <code>dp[i][j] 表示仅用 1 ~ i 中的数构成和为 j 的个数</code>，那么显然</p>
<script type="math/tex; mode=display">
dp[i][j] = \sum_{t = 0}^k dp[i - 1][j - t * i]</script><p>于是我们保存一下前缀和，那么就可以优化计算了。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, k;</span><br><span class="line">	LL M;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; M;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt;&gt; <span class="title">dp</span><span class="params">(n)</span></span>;</span><br><span class="line">	dp[<span class="number">0</span>].emplace_back(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> mx = (i + <span class="number">1</span>) * i / <span class="number">2</span> * k;</span><br><span class="line">		dp[i] = dp[i - <span class="number">1</span>];</span><br><span class="line">		dp[i].resize(mx + <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= mx; ++j) dp[i][j] += dp[i][j - i];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = mx; j &gt;= (k + <span class="number">1</span>) * i; --j) dp[i][j] -= dp[i][j - (k + <span class="number">1</span>) * i] %= M;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : dp[i]) x %= M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">1</span>; x &lt;= n; ++x) &#123;</span><br><span class="line">		LL r = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> tx = <span class="built_in">std</span>::<span class="built_in">min</span>(x - <span class="number">1</span>, n - x);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = (tx + <span class="number">1</span>) * tx / <span class="number">2</span> * k; j &gt;= <span class="number">0</span>; --j) r += dp[x - <span class="number">1</span>][j] * dp[n - x][j] % M;</span><br><span class="line">		r = (r * (k + <span class="number">1</span>) % M + M - <span class="number">1</span>) % M;</span><br><span class="line">		<span class="built_in">print</span>(r);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="1408D：二维处理问题，经典重要问题"><a href="#1408D：二维处理问题，经典重要问题" class="headerlink" title="1408D：二维处理问题，经典重要问题"></a><a href="https://codeforces.com/contest/1408/problem/D" target="_blank" rel="noopener">1408D</a>：二维处理问题，经典重要问题</h3><blockquote>
<p>一开始没有看数据范围觉得没法过，就没想这个问题，然后狮子大张口想做最后一题…</p>
</blockquote>
<p>此问题可以转换成经典问题：二维平面，第一象限的 $n$ 个点，每次只能同时向左或者向下移动一个单位，问最少需要多少步，让所有的点都不在第一象限。<br>首先先对一个坐标（例如横坐标）进行从小到大排序，然后最终结果就是 第 i 个点的横坐标加上后面所有点的纵坐标的最大值，这 n + 1 个结果中最小的一个！</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, m;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	std::vector&lt;std::pair&lt;int, int&gt;&gt; a(n), b(m), t;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[x, y] : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[x, y] : b) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">r</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (a[i].first &lt;= b[j].first &amp;&amp; a[i].second &lt;= b[j].second) &#123;</span><br><span class="line">				t.push_back(&#123;b[j].first - a[i].first + <span class="number">1</span>, b[j].second - a[i].second + <span class="number">1</span>&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::sort(t.<span class="built_in">begin</span>(), t.<span class="built_in">end</span>());</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">mx</span><span class="params">(t.<span class="built_in">size</span>() + <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = t.<span class="built_in">size</span>() - <span class="number">1</span>; ~i; --i) &#123;</span><br><span class="line">		mx[i] = <span class="built_in">std</span>::<span class="built_in">max</span>(mx[i + <span class="number">1</span>], t[i].second);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> ans = mx[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; t.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		ans = <span class="built_in">std</span>::<span class="built_in">min</span>(ans, mx[i + <span class="number">1</span>] + t[i].first);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(ans);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1408F：脑筋急转弯问题"><a href="#1408F：脑筋急转弯问题" class="headerlink" title="1408F：脑筋急转弯问题"></a><a href="https://codeforces.com/contest/1408/problem/F" target="_blank" rel="noopener">1408F</a>：脑筋急转弯问题</h3><p>读完题目我就知道对于 $n$ 为 2 的幂次时，可以让所有元素一致，但是后面怎么就没有想到前后各搞一次呢？我在干什么！！！</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; r;</span><br><span class="line">	<span class="keyword">auto</span> f = [&amp;](<span class="keyword">int</span> x, <span class="keyword">int</span> len) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> <span class="built_in">step</span> = <span class="number">1</span>; <span class="built_in">step</span> &lt; len; <span class="built_in">step</span> *= <span class="number">2</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i += <span class="built_in">step</span> * <span class="number">2</span>) &#123;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="built_in">step</span>; ++j) &#123;</span><br><span class="line">					r.push_back(&#123;i + j + x, i + j + x + <span class="built_in">step</span>&#125;);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> k = <span class="built_in">std</span>::__lg(n);</span><br><span class="line">	f(<span class="number">1</span>, <span class="number">1</span> &lt;&lt; k);</span><br><span class="line">	f(n + <span class="number">1</span> - (<span class="number">1</span> &lt;&lt; k), <span class="number">1</span> &lt;&lt; k);</span><br><span class="line">	<span class="built_in">print</span>(r.<span class="built_in">size</span>());</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> [x, y] : r) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">" "</span> &lt;&lt; y &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1408I"><a href="#1408I" class="headerlink" title="1408I"></a><a href="https://codeforces.com/contest/1408/problem/I" target="_blank" rel="noopener">1408I</a></h3><blockquote>
<p>本题解基于 Soulist 的题解和 Jiangly 的代码，写这个的原因是这个题我是非常想搞清楚，然后只有转化成自己的语言才能弄清楚，所以想写下来，从而说明是真的理解了。</p>
</blockquote>
<p>题意：给定 $n$ 个数 ($a_1, a_2, \cdots, a_n$)，（序列元素互异，但是这个条件没啥用吧）每次操作为等概率的选择其中一个数，然后将其减一，问经过 $k$ 次操作之后这 $n$ 个数的异或和 为 $x = 0, 1, \cdots, 2^c - 1$ 的概率。</p>
<p>其中， $k, c \leq 16, a_i \in [k, 2^c)$，最后答案是分数，在模 998244353 的意义下就是个整数啦。</p>
<ul>
<li>令 $sa = a_1 \oplus a_2 \cdots \oplus a_n$，然后考虑答案在 $t$ 上的改变量。</li>
<li>令 $d_{i,j} = a_i \oplus (a_i - j)$，$\displaystyle F(x, y) = \prod_{i = 1}^n \left( \sum_{j = 0}^k \frac{x^{d_{i,j}}}{j!} y^j \right)$ 那么我们的答案就是 $F(x,y)[y^k] \cdot k!$，其中 $x$ 上是异或卷积，$y$ 上的是普通卷积。</li>
</ul>
<p>那么我们现在主要问题就变成如何就 $F(x,y)[y^k] \cdot k!$ 了。由于 $x$ 上的系数加法是异或加法，所以我们需要用 <a href="https://oi-wiki.org/math/poly/fwt/" target="_blank" rel="noopener">异或的 fwt</a> 将它转化成普通乘法。</p>
<ul>
<li>$x$ 上的系数可以本质是下标！下标对应的值是关于$y$的多项式，首先注意到做 fwt 仅仅是将 $x$ 上的系数做了改变，并没有改变其它内容。这样做是为了把卷积异或乘法改成普通卷积乘法。这里做 fwt 的时候可以暴力搞。</li>
<li>优化 1：仅有 $O(ck)$ 中 $k$ 元组</li>
<li>每个 $k$ 元组对应的下标对应 fwt 之后的编号只有 $2^k$ 种！</li>
<li>多项式乘法可以用 <code>ln/exp</code> 来运算</li>
</ul>
<p>soulist 写了<a href="https://www.cnblogs.com/Soulist/p/13758388.html" target="_blank" rel="noopener">题解</a><br>以下是 <a href="https://codeforces.com/contest/1408/submission/94346776" target="_blank" rel="noopener">jiangly 大佬的代码</a> 的注释版。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// code by jiangly</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> P = <span class="number">998244353</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">power</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b &gt; <span class="number">0</span>; b /= <span class="number">2</span>, a = <span class="number">1l</span>l * a * a % P)</span><br><span class="line">        <span class="keyword">if</span> (b % <span class="number">2</span> == <span class="number">1</span>) res = <span class="number">1l</span>l * res * a % P;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> n, k, c;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; c;</span><br><span class="line">    std::vector&lt;int&gt; fac(k + 1), invFac(k + 1), inv(k + 1);</span><br><span class="line">    fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) fac[i] = <span class="number">1l</span>l * fac[i - <span class="number">1</span>] * i % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k; ++i) invFac[i] = power(fac[i], P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) inv[i] = power(i, P - <span class="number">2</span>);</span><br><span class="line">	<span class="comment">// 预处理出所有元素异或和，以及每一种序列的个数</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">map</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, <span class="keyword">int</span>&gt; cnt;</span><br><span class="line">    <span class="keyword">int</span> xsum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> a;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a;</span><br><span class="line">        xsum ^= a;</span><br><span class="line">        <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">d</span><span class="params">(k + <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= k; ++j) d[j] = a ^ (a - j);</span><br><span class="line">        ++cnt[d];</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// cntm 就是暴力做 fwt 后的每种序列的个数</span></span><br><span class="line">	<span class="comment">// f 就是做完 fwt 后得到式子乘积。</span></span><br><span class="line">    std::vector&lt;int&gt; f(1 &lt;&lt; c), cntm(1 &lt;&lt; k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; (<span class="number">1</span> &lt;&lt; c); ++x) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; e;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> [d, t] : cnt) &#123;</span><br><span class="line">            <span class="keyword">int</span> mask = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) <span class="keyword">if</span> (__builtin_parity(x &amp; d[i])) mask |= <span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (cntm[mask] == <span class="number">0</span>) e.push_back(mask);</span><br><span class="line">            cntm[mask] += t;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">g</span><span class="params">(k + <span class="number">1</span>)</span></span>;</span><br><span class="line">        g[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> mask : e) &#123;</span><br><span class="line">            <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(k + <span class="number">1</span>)</span></span>;</span><br><span class="line">            a[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">                <span class="keyword">if</span> (mask &gt;&gt; (i - <span class="number">1</span>) &amp; <span class="number">1</span>) a[i] = P - invFac[i];</span><br><span class="line">                <span class="keyword">else</span> a[i] = invFac[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">pw</span><span class="params">(k + <span class="number">1</span>)</span></span>;</span><br><span class="line">            <span class="keyword">int</span> t = cntm[mask];</span><br><span class="line">            pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">			<span class="comment">// 取对数, 再做加法</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) &#123;</span><br><span class="line">                <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; ++j) res = (res + <span class="number">1l</span>l * pw[j] * a[i - j] % P * (i - j)) % P;</span><br><span class="line">                res = <span class="number">1l</span>l * res * t % P;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; ++j) res = (res + <span class="number">1l</span>l * (P - a[j]) * pw[i - j] % P * (i - j)) % P;</span><br><span class="line">                pw[i] = <span class="number">1l</span>l * res * inv[i] % P;</span><br><span class="line">            &#125;</span><br><span class="line">			<span class="comment">// 加起来取指数</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = k; i &gt;= <span class="number">1</span>; --i) &#123;</span><br><span class="line">                <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; ++j) res = (res + <span class="number">1l</span>l * pw[j] * g[i - j]) % P;</span><br><span class="line">                g[i] = res;</span><br><span class="line">            &#125;</span><br><span class="line">            cntm[mask] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        f[x] = <span class="number">1l</span>l * g[k] * fac[k] % P;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// ifwt 得到最后的答案，注意到这里没有除以 2，是因为它最后整体除了 2^c。</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; (<span class="number">1</span> &lt;&lt; c); i *= <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="number">1</span> &lt;&lt; c); j += <span class="number">2</span> * i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; i; ++k) &#123;</span><br><span class="line">                <span class="keyword">int</span> u = f[j + k], v = f[i + j + k];</span><br><span class="line">                f[j + k] = (u + v) % P;</span><br><span class="line">                f[i + j + k] = (u - v + P) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> invn = <span class="number">1l</span>l * power(<span class="number">1</span> &lt;&lt; c, P - <span class="number">2</span>) * power(n, P - <span class="number">1</span> - k) % P;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; c); ++i) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="number">1l</span>l * f[i ^ xsum] * invn % P &lt;&lt; <span class="string">" \n"</span>[i == (<span class="number">1</span> &lt;&lt; c) - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="453B：状态压缩-DP"><a href="#453B：状态压缩-DP" class="headerlink" title="453B：状态压缩 DP"></a><a href="https://codeforces.com/contest/453/problem/B" target="_blank" rel="noopener">453B</a>：状态压缩 DP</h3><p>给定数列 $a$，求满足元素两两互素的数列 $b$ 使得 $\sum |a_i - b_i|$ 最小</p>
<blockquote>
<p>注意到 $b_i &lt; 2 a_i$，因为否则取 $b_i = 1$ 即可。</p>
</blockquote>
<p>由于 $60$ 内的素数个数为 17, 因此可以状态压缩 DP。设 <code>dp[i][j]</code> 表示使得 $\sum_{k = 1} ^ i |a_k - b_k|$ 最小，且$b_1 \cdots b_i$ 中所有出现的素因子的状态为 $j$。因此状态转移就是 <code>dp[i][j | factor[k]] = min(dp[i - 1][j] + |a_i - k|)</code>，其中 <code>factor[k]</code> 与 $j$ 没有交集。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="keyword">int</span> ma = *<span class="built_in">std</span>::max_element(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>()) * <span class="number">2</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; ma; ++i) &#123;</span><br><span class="line">		<span class="keyword">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j * j &lt;= i; ++j) <span class="keyword">if</span> (i % j == <span class="number">0</span>) &#123;</span><br><span class="line">			flag = <span class="literal">false</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (flag) p.emplace_back(i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">factor</span><span class="params">(ma)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; ma; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; p.<span class="built_in">size</span>(); ++j) <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>) &#123;</span><br><span class="line">			factor[i] |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">ans</span><span class="params">(n + <span class="number">1</span>, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">1</span> &lt;&lt; p.<span class="built_in">size</span>(), <span class="number">1e9</span>))</span></span>;</span><br><span class="line">	ans[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; <span class="number">2</span> * a[i - <span class="number">1</span>]; ++j) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; (<span class="number">1</span> &lt;&lt; p.<span class="built_in">size</span>()); ++k) <span class="keyword">if</span> ((k &amp; factor[j]) == <span class="number">0</span>) &#123;</span><br><span class="line">				ans[i][k | factor[j]] = <span class="built_in">std</span>::<span class="built_in">min</span>(ans[i][k | factor[j]], ans[i - <span class="number">1</span>][k] + <span class="built_in">abs</span>(a[i - <span class="number">1</span>] - j));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">r</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> now = <span class="built_in">std</span>::min_element(ans[n].<span class="built_in">begin</span>(), ans[n].<span class="built_in">end</span>()) - ans[n].<span class="built_in">begin</span>();</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; <span class="number">2</span> * a[i]; ++j) <span class="keyword">if</span> ((now | factor[j]) == now) &#123;</span><br><span class="line">			<span class="keyword">if</span> (ans[i][now ^ factor[j]] + <span class="built_in">abs</span>(a[i] - j) == ans[i + <span class="number">1</span>][now]) &#123;</span><br><span class="line">				r[i] = j;</span><br><span class="line">				now ^= factor[j];</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> x : r) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">	<span class="built_in">println</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="662C：状态压缩-DP-FWT-模板"><a href="#662C：状态压缩-DP-FWT-模板" class="headerlink" title="662C：状态压缩 DP + FWT 模板"></a><a href="https://codeforces.com/contest/662/problem/C" target="_blank" rel="noopener">662C</a>：状态压缩 DP + FWT 模板</h3><p>给定 $n \times m$ 的 0-1 方阵，可以取反一些行和列使得最后 0 的数列最小。</p>
<blockquote>
<p>首先注意到 $n &lt; 20$，我们可以把每一列看作一个状态 <code>i</code> ，并且结果跟列的顺序无关。我们可以记录下初始情况每种状态数 C[i] 量。<br>并且每一种状态 <code>i</code> 对答案的贡献显然就是它的 0, 1 个数的最小值记作 <code>g[i]</code>。<br>对于每一个行取反 S, 其实就是将一个状态 i 变成 状态 <code>i ^ S</code><br>所以每一种行取反 S，最终的答案 $\displaystyle F(S) = \sum_{i} C[i] \cdot g[i \wedge S] = \sum_{i \wedge j = S} C[i] \cdot g[j]$ </p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">998244353</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    (x += y) &gt;= P &amp;&amp; (x -= P);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    (x -= y) &lt; <span class="number">0</span> &amp;&amp; (x += P);</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FWT</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">extend</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> N = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; N &lt; n; N &lt;&lt;= <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> N;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">FWTor</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;a, <span class="keyword">bool</span> rev)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = a.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, m = <span class="number">1</span>; l &lt;= n; l &lt;&lt;= <span class="number">1</span>, m &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += l) <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!rev) add(a[i + j + m], a[i + j]);</span><br><span class="line">                <span class="keyword">else</span> sub(a[i + j + m], a[i + j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">FWTand</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;a, <span class="keyword">bool</span> rev)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = a.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, m = <span class="number">1</span>; l &lt;= n; l &lt;&lt;= <span class="number">1</span>, m &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += l) <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!rev) add(a[i + j], a[i + j + m]);</span><br><span class="line">                <span class="keyword">else</span> sub(a[i + j], a[i + j + m]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">FWTxor</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;a, <span class="keyword">bool</span> rev)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = a.<span class="built_in">size</span>(), inv2 = (P + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">2</span>, m = <span class="number">1</span>; l &lt;= n; l &lt;&lt;= <span class="number">1</span>, m &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += l) <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">                <span class="keyword">int</span> x = a[i + j], y = a[i + j + m];</span><br><span class="line">                <span class="keyword">if</span> (!rev) &#123;</span><br><span class="line">                    a[i + j] = (x + y) % P;</span><br><span class="line">                    a[i + j + m] = (x - y + P) % P;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    a[i + j] = <span class="number">1L</span>L * (x + y) * inv2 % P;</span><br><span class="line">                    a[i + j + m] = <span class="number">1L</span>L * (x - y + P) * inv2 % P;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">Or</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a1, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="built_in">std</span>::<span class="built_in">max</span>(a1.<span class="built_in">size</span>(), a2.<span class="built_in">size</span>()), N = extend(n);</span><br><span class="line">        a1.resize(N), FWTor(a1, <span class="literal">false</span>);</span><br><span class="line">        a2.resize(N), FWTor(a2, <span class="literal">false</span>);</span><br><span class="line">        <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">A</span><span class="params">(N)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) A[i] = <span class="number">1L</span>L * a1[i] * a2[i] % P;</span><br><span class="line">        FWTor(A, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">return</span> A;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">And</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a1, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="built_in">std</span>::<span class="built_in">max</span>(a1.<span class="built_in">size</span>(), a2.<span class="built_in">size</span>()), N = extend(n);</span><br><span class="line">        a1.resize(N), FWTand(a1, <span class="literal">false</span>);</span><br><span class="line">        a2.resize(N), FWTand(a2, <span class="literal">false</span>);</span><br><span class="line">        <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">A</span><span class="params">(N)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) A[i] = <span class="number">1L</span>L * a1[i] * a2[i] % P;</span><br><span class="line">        FWTand(A, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">return</span> A;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">Xor</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a1, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = <span class="built_in">std</span>::<span class="built_in">max</span>(a1.<span class="built_in">size</span>(), a2.<span class="built_in">size</span>()), N = extend(n);</span><br><span class="line">        a1.resize(N), FWTxor(a1, <span class="literal">false</span>);</span><br><span class="line">        a2.resize(N), FWTxor(a2, <span class="literal">false</span>);</span><br><span class="line">        <span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">A</span><span class="params">(N)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) A[i] = <span class="number">1L</span>L * a1[i] * a2[i] % P;</span><br><span class="line">        FWTxor(A, <span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">return</span> A;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; fwt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, m;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	std::vector&lt;int&gt; c(1 &lt;&lt; n), g(1 &lt;&lt; n);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">			r |= (a[j][i] - <span class="string">'0'</span>) &lt;&lt; j;</span><br><span class="line">		&#125;</span><br><span class="line">		++c[r];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="number">1</span> &lt;&lt; n); ++j) &#123;</span><br><span class="line">			<span class="keyword">if</span> (j &amp; (<span class="number">1</span> &lt;&lt; i)) ++g[j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; n); ++i) &#123;</span><br><span class="line">		g[i] = <span class="built_in">std</span>::<span class="built_in">min</span>(g[i], n - g[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">auto</span> f = fwt.Xor(c, g);</span><br><span class="line">	<span class="built_in">print</span>(*<span class="built_in">std</span>::min_element(f.<span class="built_in">begin</span>(), f.<span class="built_in">end</span>()));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1417E：异或问题和逆序数"><a href="#1417E：异或问题和逆序数" class="headerlink" title="1417E：异或问题和逆序数"></a><a href="https://codeforces.com/contest/1417/problem/E" target="_blank" rel="noopener">1417E</a>：异或问题和逆序数</h3><blockquote>
<p>注意到两个数比较大小只和它最高位数字有关，如果改变第 $i$ 位，那么第 $i$ 位后面的数就可以不考虑。<br>可以参考 <a href="https://codeforces.com/contest/1416/submission/93985644" target="_blank" rel="noopener">jiangly 的代码</a></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">	LL cnt = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> d = <span class="number">1</span>; d &lt; <span class="number">31</span>; ++d) &#123;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">p</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="built_in">std</span>::iota(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">		<span class="built_in">std</span>::sort(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>(),[&amp;](<span class="keyword">int</span> i, <span class="keyword">int</span> j) &#123;</span><br><span class="line">			<span class="keyword">return</span> (a[i] &gt;&gt; d) &lt; (a[j] &gt;&gt; d) || ((a[i] &gt;&gt; d) == (a[j] &gt;&gt; d) &amp;&amp; i &lt; j);</span><br><span class="line">		&#125;);</span><br><span class="line">		LL c0 = <span class="number">0</span>, c1 = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; n; i = j) &#123;</span><br><span class="line">			<span class="keyword">int</span> x0 = <span class="number">0</span>, x1 = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span> (j &lt; n &amp;&amp; (a[p[i]] &gt;&gt; d) == (a[p[j]] &gt;&gt; d)) &#123;</span><br><span class="line">				<span class="keyword">if</span> ((a[p[j]] &gt;&gt; (d - <span class="number">1</span>)) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">					++x1;</span><br><span class="line">					c0 += x0;</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					++x0;</span><br><span class="line">					c1 += x1;</span><br><span class="line">				&#125;</span><br><span class="line">				++j;</span><br><span class="line">			&#125;			</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (c0 &lt; c1) &#123;</span><br><span class="line">			cnt += c0;</span><br><span class="line">			r |= (<span class="number">1</span> &lt;&lt; d - <span class="number">1</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> cnt += c1;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; cnt &lt;&lt; <span class="string">" "</span> &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>上述过程也提供了一种求逆序数的方法，就是注意到任意两个数，他们总会在某一个最高位是一致的。</p>
</blockquote>
<h3 id="AtCoder-ACL2f-包容排斥原理-NFT"><a href="#AtCoder-ACL2f-包容排斥原理-NFT" class="headerlink" title="AtCoder ACL2f: 包容排斥原理 + NFT"></a><a href="https://atcoder.jp/contests/abl/tasks/abl_f" target="_blank" rel="noopener">AtCoder ACL2f</a>: 包容排斥原理 + NFT</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl;</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>, ROOT = <span class="number">3</span>;</span><br><span class="line"><span class="function">LL <span class="title">powMod</span><span class="params">(LL x, LL n)</span> </span>&#123;</span><br><span class="line">	<span class="function">LL <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (n) &#123;</span><br><span class="line">		<span class="keyword">if</span> (n &amp; <span class="number">1</span>) r = r * x % M;</span><br><span class="line">		n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		x = x * x % M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bitreverse</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; &amp;a)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i != a.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i &gt; j) <span class="built_in">std</span>::swap(a[i], a[j]);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> l = a.<span class="built_in">size</span>() &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			(j ^= l) &lt; l; l &gt;&gt;= <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">nft</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; &amp;a, <span class="keyword">bool</span> isInverse = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">	LL g = powMod(ROOT, (M - <span class="number">1</span>) / a.<span class="built_in">size</span>());</span><br><span class="line">	<span class="keyword">if</span> (isInverse) &#123;</span><br><span class="line">		g = powMod(g, M - <span class="number">2</span>);</span><br><span class="line">		LL invLen = powMod(LL(a.<span class="built_in">size</span>()), M - <span class="number">2</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp; x: a) x = x * invLen % M;</span><br><span class="line">	&#125;</span><br><span class="line">	bitreverse(a);</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">w</span><span class="params">(a.<span class="built_in">size</span>(), <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i != w.<span class="built_in">size</span>(); ++i) w[i] = w[i - <span class="number">1</span>] * g % M;</span><br><span class="line">	<span class="keyword">auto</span> addMod = [](LL x, LL y) &#123;</span><br><span class="line">		<span class="keyword">return</span> (x += y) &gt;= M ? x -= M : x;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> <span class="built_in">step</span> = <span class="number">2</span>, half = <span class="number">1</span>; half != a.<span class="built_in">size</span>(); <span class="built_in">step</span> &lt;&lt;= <span class="number">1</span>, half &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, wstep = a.<span class="built_in">size</span>() / <span class="built_in">step</span>; i != a.<span class="built_in">size</span>(); i += <span class="built_in">step</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = i; j != i + half; ++j) &#123;</span><br><span class="line">				LL t = (a[j + half] * w[wstep * (j - i)]) % M;</span><br><span class="line">				a[j + half] = addMod(a[j], M - t);</span><br><span class="line">				a[j] = addMod(a[j], t);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt;&amp; a, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sz = <span class="number">1</span>, tot = a.<span class="built_in">size</span>() + b.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (sz &lt; tot) sz *= <span class="number">2</span>;</span><br><span class="line">	a.resize(sz);</span><br><span class="line">	b.resize(sz);</span><br><span class="line">	nft(a);</span><br><span class="line">	nft(b);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != sz; ++i) a[i] = a[i] * b[i] % M;</span><br><span class="line">	nft(a, <span class="number">1</span>);</span><br><span class="line">	a.resize(tot);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">2</span>;</span><br><span class="line">LL fac[N], ifac[N];</span><br><span class="line"><span class="function">LL <span class="title">inv</span><span class="params">(LL a)</span></span>&#123; <span class="comment">// 0 &lt; a &lt; p and gcd(a,p) = 1</span></span><br><span class="line">	<span class="keyword">return</span> a == <span class="number">1</span> ? <span class="number">1</span> : (M - M / a) * inv(M % a) % M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	fac[<span class="number">0</span>] = ifac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) fac[i] = fac[i - <span class="number">1</span>] * i % M;</span><br><span class="line">	ifac[N - <span class="number">1</span>] = inv(fac[N - <span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = N - <span class="number">1</span>; i; --i) ifac[i - <span class="number">1</span>] = ifac[i] * i % M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">binom</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (n &lt; k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">return</span> fac[n] * ifac[k] % M * ifac[n - k] % M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	init();</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">cnt</span><span class="params">(<span class="number">1e5</span> + <span class="number">2</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; <span class="number">2</span> * n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">		++cnt[x];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">r</span><span class="params">(<span class="number">1</span>, <span class="number">1</span>)</span></span>;</span><br><span class="line">	LL inv2 = (M + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">	<span class="built_in">std</span>::sort(cnt.<span class="built_in">begin</span>(), cnt.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">auto</span> start = <span class="built_in">std</span>::lower_bound(cnt.<span class="built_in">begin</span>(), cnt.<span class="built_in">end</span>(), <span class="number">1</span>) - cnt.<span class="built_in">begin</span>();</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line">	q.push_back(&#123;cnt[start], <span class="number">1</span>&#125;);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = start + <span class="number">1</span>; i &lt; cnt.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span>(cnt[i] != q.back().first) q.push_back(&#123;cnt[i], <span class="number">1</span>&#125;);</span><br><span class="line">		<span class="keyword">else</span> ++q.back().second;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> [x, xn] : q) <span class="keyword">if</span> (x &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">a</span><span class="params">(x / <span class="number">2</span> + <span class="number">1</span>)</span></span>;</span><br><span class="line">		LL p2j = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= x / <span class="number">2</span>; ++j) &#123;</span><br><span class="line">			a[j] = fac[x] * ifac[x - <span class="number">2</span> * j] % M * ifac[j] % M * p2j % M;</span><br><span class="line">			p2j = p2j * inv2 % M;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (xn) &#123;</span><br><span class="line">			<span class="keyword">if</span> (xn &amp; <span class="number">1</span>) mul(r, a);</span><br><span class="line">			xn &gt;&gt;= <span class="number">1</span>; mul(a, a);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">G</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">	G[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) G[i] = G[i - <span class="number">1</span>] * (<span class="number">2</span> * i - <span class="number">1</span>) % M;</span><br><span class="line">	LL ret = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r.<span class="built_in">size</span>() &amp;&amp; i &lt;= n; ++i) &#123;</span><br><span class="line">		ret += (i % <span class="number">2</span> == <span class="number">1</span> ? <span class="number">-1</span> : <span class="number">1</span>) * G[n - i] * r[i] % M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>((ret % M + M) % M);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="AtCoder-ACL2e：线段树模板题"><a href="#AtCoder-ACL2e：线段树模板题" class="headerlink" title="AtCoder ACL2e：线段树模板题"></a><a href="https://atcoder.jp/contests/abl/tasks/abl_e" target="_blank" rel="noopener">AtCoder ACL2e</a>：线段树模板题</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl;</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lrt rt &lt;&lt; 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rrt rt &lt;&lt; 1 | 1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l, m, lrt</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m + 1, r, rrt</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> NN = N * <span class="number">3.2</span>;</span><br><span class="line">LL sum[NN], s10[N];</span><br><span class="line"><span class="keyword">int</span> col[NN];</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushUp</span><span class="params">(<span class="keyword">int</span> rt)</span> </span>&#123;</span><br><span class="line">	sum[rt] = sum[lrt] + sum[rrt];</span><br><span class="line">	<span class="keyword">if</span> (sum[rt] &gt;= M) sum[rt] -= M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushDown</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r, <span class="keyword">int</span> rt)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (col[rt] != <span class="number">-1</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> m = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		col[lrt] = col[rrt] = col[rt];</span><br><span class="line">		col[rt] = <span class="number">-1</span>;</span><br><span class="line">		sum[lrt] = (s10[m] - s10[l - <span class="number">1</span>] + M) * col[lrt] % M;</span><br><span class="line">		sum[rrt] = (s10[r] - s10[m] + M) * col[rrt] % M;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">		sum[rt] = s10[r] - s10[l - <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span> (sum[rt] &lt; <span class="number">0</span>) sum[rt] += M;</span><br><span class="line">		col[rt] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	col[rt] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> m = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	build(lson);</span><br><span class="line">	build(rson);</span><br><span class="line">	pushUp(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> rt)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= l &amp;&amp; R &gt;= r) &#123;</span><br><span class="line">		sum[rt] = (s10[r] - s10[l - <span class="number">1</span>] + M) * p % M;</span><br><span class="line">		col[rt] = p;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	pushDown(l, r, rt);</span><br><span class="line">	<span class="keyword">int</span> m = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> (L &lt;= m) update(L, R, p, lson);</span><br><span class="line">	<span class="keyword">if</span> (R &gt; m) update(L, R, p, rson);</span><br><span class="line">	pushUp(rt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	s10[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	LL now = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">		s10[i] = now;</span><br><span class="line">		now = now * <span class="number">10</span> % M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">		s10[i] += s10[i - <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">if</span> (s10[i] &gt;= M) s10[i] -= M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> n, q;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q;</span><br><span class="line">	build(<span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">while</span> (q--) &#123;</span><br><span class="line">		<span class="keyword">int</span> l, r, d;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; d;</span><br><span class="line">		update(n - r + <span class="number">1</span>, n - l + <span class="number">1</span>, d, <span class="number">1</span>, n, <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">print</span>(sum[<span class="number">1</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="AtCoder-ABC178e：Manhattan-距离"><a href="#AtCoder-ABC178e：Manhattan-距离" class="headerlink" title="AtCoder ABC178e：Manhattan 距离"></a><a href="https://atcoder.jp/contests/abc178/tasks/abc178_e" target="_blank" rel="noopener">AtCoder ABC178e</a>：Manhattan 距离</h3><p>给定一堆点，求它们的 Manhattan 距离中最大值</p>
<blockquote>
<p>注意到其实任意两点的距离等于，它们到最左上角和到最下角的距离的距离差的最大值。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span>  LL M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">int</span> x[n], y[n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x[i] &gt;&gt; y[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> xx[<span class="number">2</span>] = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;, yy[<span class="number">2</span>] = &#123;<span class="number">0</span>, <span class="keyword">int</span>(<span class="number">1e9</span>)&#125;;</span><br><span class="line">	<span class="keyword">int</span> t[<span class="number">2</span>][n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> id = <span class="number">0</span> ; id &lt; <span class="number">2</span>; ++id) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			t[id][i] = <span class="built_in">abs</span>(x[i] - xx[id]) + <span class="built_in">abs</span>(y[i] - yy[id]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> r0 = *<span class="built_in">std</span>::max_element(t[<span class="number">0</span>], t[<span class="number">0</span>] + n) - *<span class="built_in">std</span>::min_element(t[<span class="number">0</span>], t[<span class="number">0</span>] + n);</span><br><span class="line">	<span class="keyword">int</span> r1 = *<span class="built_in">std</span>::max_element(t[<span class="number">1</span>], t[<span class="number">1</span>] + n) - *<span class="built_in">std</span>::min_element(t[<span class="number">1</span>], t[<span class="number">1</span>] + n);</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">std</span>::<span class="built_in">max</span>(r0, r1));</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1406D：经典数学题"><a href="#1406D：经典数学题" class="headerlink" title="1406D：经典数学题"></a><a href="https://codeforces.com/contest/1406/problem/D" target="_blank" rel="noopener">1406D</a>：经典数学题</h3><p>给定数列 $a$, 求单调递增数列 $b$ 和单调递减数列 $c$，使得 $a_i = b_i + c_i$，并且使得 $b, c$ 中的最大值最小（即 $\max(b_n, c_1)$ 最小。</p>
<p>如果 $a_i &lt; a_{i+1}$ 令 $b_{i +1} = b_i + a_{i + 1} - a_i$，否则 $c_{i + 1} = c_i + a_{i + 1} - a_i$。<br>设 $c_1 = x$，$b_ 1 = a - x$，容易看出 $b_n = \sum_{i = 2}^n \max{0, a_{i} - a_{i-1}}$。并且每次更新只和 $l, r$ 节点有关。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">floor</span><span class="params">(LL a, LL n)</span> </span>&#123; <span class="comment">// n &gt; 0</span></span><br><span class="line">	<span class="keyword">return</span> a &lt; <span class="number">0</span> ? (a - n + <span class="number">1</span>) / n : a / n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	LL a[n], ret = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i; --i) a[i] -= a[i - <span class="number">1</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) ret += <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0L</span>L, a[i]);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">floor</span>(a[<span class="number">0</span>] + ret + <span class="number">1</span>, <span class="number">2</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">int</span> q;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; q;</span><br><span class="line">	<span class="keyword">while</span> (q--) &#123;</span><br><span class="line">		<span class="keyword">int</span> l, r, x;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; x;</span><br><span class="line">		<span class="keyword">if</span> (r != n) &#123;</span><br><span class="line">			ret -= <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0L</span>L, a[r]);</span><br><span class="line">			a[r] -= x;</span><br><span class="line">			ret += <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0L</span>L, a[r]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (l != <span class="number">1</span>) ret -= <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0L</span>L, a[l - <span class="number">1</span>]);</span><br><span class="line">		a[l - <span class="number">1</span>] += x;</span><br><span class="line">		<span class="keyword">if</span> (l != <span class="number">1</span>) ret += <span class="built_in">std</span>::<span class="built_in">max</span>(<span class="number">0L</span>L, a[l - <span class="number">1</span>]);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">floor</span>(a[<span class="number">0</span>] + ret + <span class="number">1</span>, <span class="number">2</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1407B：GCD-问题"><a href="#1407B：GCD-问题" class="headerlink" title="1407B：GCD 问题"></a><a href="https://codeforces.com/contest/1407/problem/B" target="_blank" rel="noopener">1407B</a>：GCD 问题</h3><blockquote>
<p>如果数据范围特别大，则需要下面的处理方式，否则其实可以预处理 gcd<br>如果这题 $c_i = \gcd(b_i, b_{i + 1}$ 将会超级难！</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		<span class="keyword">int</span> a[n];</span><br><span class="line">		<span class="keyword">bool</span> v[n] = &#123;&#125;;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">		<span class="keyword">int</span> id = <span class="built_in">std</span>::max_element(a, a + n) - a;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line">		ans.push_back(a[id]);</span><br><span class="line">		v[id] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> now = a[id];</span><br><span class="line">		<span class="keyword">while</span> (ans.<span class="built_in">size</span>() != n) &#123;</span><br><span class="line">			<span class="keyword">int</span> mx = <span class="number">0</span>, mi = <span class="number">1e9</span> + <span class="number">2</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) <span class="keyword">if</span> (!v[i]) &#123;</span><br><span class="line">				mx = <span class="built_in">std</span>::<span class="built_in">max</span>(mx, <span class="built_in">std</span>::__gcd(now, a[i]));</span><br><span class="line">				mi = <span class="built_in">std</span>::<span class="built_in">max</span>(mi, <span class="built_in">std</span>::__gcd(now, a[i]));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (mx == mi) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) <span class="keyword">if</span> (!v[i]) &#123;</span><br><span class="line">				<span class="keyword">if</span>(mx == <span class="built_in">std</span>::__gcd(now, a[i])) &#123;</span><br><span class="line">					ans.push_back(a[i]);</span><br><span class="line">					v[i] = <span class="number">1</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			now = mx;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> x : ans) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) <span class="keyword">if</span> (!v[i]) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; a[i] &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1407C：第一次过真实的交互问题"><a href="#1407C：第一次过真实的交互问题" class="headerlink" title="1407C：第一次过真实的交互问题"></a><a href="https://codeforces.com/contest/1407/problem/C" target="_blank" rel="noopener">1407C</a>：第一次过真实的交互问题</h3><p>注意到 $(a \mod b )&gt; (b \mod a)$ 当且仅当 $a &lt; b$ （这里 $a, b$ 都是正整数），并且此时 $(a \mod b) = a$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">int</span> a[n + <span class="number">1</span>], mi = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, mx1, mx2; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"? "</span> &lt;&lt; i &lt;&lt; <span class="string">" "</span> &lt;&lt; mi &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; mx1;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"? "</span> &lt;&lt; mi &lt;&lt; <span class="string">" "</span> &lt;&lt; i &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; mx2;</span><br><span class="line">		<span class="keyword">if</span> (mx1 &gt; mx2) &#123;</span><br><span class="line">			a[i] = mx1;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			a[mi] = mx2;</span><br><span class="line">			mi = i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	a[mi] = n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"!"</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; a[i];</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1407D：贪心即可"><a href="#1407D：贪心即可" class="headerlink" title="1407D：贪心即可"></a><a href="https://codeforces.com/contest/1407/problem/D" target="_blank" rel="noopener">1407D</a>：贪心即可</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">int</span> h[n], dp[n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ;i &lt; n; ++i) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; h[i];</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; low&#123;<span class="number">0</span>&#125;, high&#123;<span class="number">0</span>&#125;;</span><br><span class="line">	dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		dp[i] = dp[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (!low.empty() &amp;&amp; h[i] &gt;= h[low.back()]) &#123;</span><br><span class="line">			<span class="keyword">int</span> x = h[low.back()];</span><br><span class="line">			low.pop_back();</span><br><span class="line">			<span class="keyword">if</span> (h[i] &gt; x &amp;&amp; !low.empty()) dp[i] = <span class="built_in">std</span>::<span class="built_in">min</span>(dp[i], dp[low.back()] + <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (!high.empty() &amp;&amp; h[i] &lt;= h[high.back()]) &#123;</span><br><span class="line">			<span class="keyword">int</span> x = h[high.back()];</span><br><span class="line">			high.pop_back();</span><br><span class="line">			<span class="keyword">if</span> (h[i] &lt; x &amp;&amp; !high.empty()) dp[i] = <span class="built_in">std</span>::<span class="built_in">min</span>(dp[i], dp[high.back()] + <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		low.emplace_back(i);</span><br><span class="line">		high.emplace_back(i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; dp[n - <span class="number">1</span>] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1405D：树的直径"><a href="#1405D：树的直径" class="headerlink" title="1405D：树的直径"></a><a href="https://codeforces.com/contest/1405/problem/D" target="_blank" rel="noopener">1405D</a>：树的直径</h3><p>$A, B$ 分别在树上某两点，每次移动的距离最大值为 $da, db$，$A$ 先移动。<br>如果 $A$ 有策略在有限步后与 $B$ 在同一点，那么就 $A$ 获胜，否则 $B$ 获胜。</p>
<p>$A$ 胜可以分这三种情况：</p>
<ul>
<li>$A$ 直接能到 $B$</li>
<li>两倍 $da$ 大于或等于 <strong>树的直径</strong></li>
<li>两倍 $da$ 大于或等于 $db$</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LinkStar</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; head, nxt, to;</span><br><span class="line">	LinkStar(<span class="keyword">int</span> n) &#123;</span><br><span class="line">		nxt.<span class="built_in">clear</span>();</span><br><span class="line">		to.<span class="built_in">clear</span>();</span><br><span class="line">		head = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">		nxt.emplace_back(head[u]);</span><br><span class="line">		head[u] = to.<span class="built_in">size</span>();</span><br><span class="line">		to.emplace_back(v);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n, a, b, da, db;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; a &gt;&gt; b &gt;&gt; da &gt;&gt; db;</span><br><span class="line">		<span class="function">LinkStar <span class="title">A</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v;</span><br><span class="line">			A.addedge(u, v);</span><br><span class="line">			A.addedge(v, u);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">d</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="keyword">auto</span> bfs = [&amp;](<span class="keyword">int</span> s) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">fill</span>(d.<span class="built_in">begin</span>(), d.<span class="built_in">end</span>(), <span class="number">-1</span>);</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">			q.push(s);</span><br><span class="line">			d[s] = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">				<span class="keyword">int</span> u = q.front();</span><br><span class="line">				q.pop();</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> i = A.head[u]; ~i; i = A.nxt[i]) &#123;</span><br><span class="line">					<span class="keyword">int</span> v = A.to[i];</span><br><span class="line">					<span class="keyword">if</span> (d[v] == <span class="number">-1</span>) &#123;</span><br><span class="line">						d[v] = d[u] + <span class="number">1</span>;</span><br><span class="line">						q.push(v);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">std</span>::max_element(d.<span class="built_in">begin</span>(), d.<span class="built_in">end</span>()) - d.<span class="built_in">begin</span>();</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">int</span> c = bfs(a);</span><br><span class="line">		<span class="keyword">if</span> (db &lt;= <span class="number">2</span> * da || d[b] &lt;= da) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"Alice\n"</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			c = bfs(c);</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (d[c] &lt;= <span class="number">2</span> * da ? <span class="string">"Alice"</span> : <span class="string">"Bob"</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1405E：高端树状数组"><a href="#1405E：高端树状数组" class="headerlink" title="1405E：高端树状数组"></a><a href="https://codeforces.com/contest/1405/problem/E" target="_blank" rel="noopener">1405E</a>：高端树状数组</h3><blockquote>
<p><a href="https://codeforces.com/blog/entry/82366" target="_blank" rel="noopener">官方题解</a></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TreeArray</span> &#123;</span></span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; s;</span><br><span class="line">	TreeArray() &#123;&#125;</span><br><span class="line">	TreeArray(<span class="keyword">int</span> n) &#123; init(n); &#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">		s.resize(n + <span class="number">1</span>);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">fill</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; </span><br><span class="line">		<span class="keyword">return</span> n &amp; (-n);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">while</span> (id &lt; s.<span class="built_in">size</span>()) &#123;</span><br><span class="line">			s[id] += p;</span><br><span class="line">			id += lowbit(id);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">LL <span class="title">sum</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		LL r = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (id) &#123;</span><br><span class="line">			r += s[id];</span><br><span class="line">			id -= lowbit(id);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// find maximal index s.t. sum(id) &gt;= x, sum must be decreased</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(LL val, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">		LL sum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (s[<span class="number">1</span>] &lt; val) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="built_in">std</span>::__lg(r); ~i; --i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (id + (<span class="number">1</span> &lt;&lt; i) &lt; r &amp;&amp; sum + s[id + (<span class="number">1</span> &lt;&lt; i)] &gt;= val) &#123;</span><br><span class="line">				id += (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">				sum += s[id];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TreeArray2</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	TreeArray B, C;</span><br><span class="line">	TreeArray2() &#123;&#125;</span><br><span class="line">	TreeArray2(<span class="keyword">int</span> _n) : n(_n)&#123; </span><br><span class="line">		B.init(n);</span><br><span class="line">		C.init(n);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">		C.add(id, p);</span><br><span class="line">		B.add(id, (id - <span class="number">1</span>) * p);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">		add(l, p);</span><br><span class="line">		<span class="keyword">if</span> (r + <span class="number">1</span> &lt; n) add(r + <span class="number">1</span>, -p);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">LL <span class="title">sum</span> <span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id * C.sum(id) - B.sum(id);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, q;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; q;</span><br><span class="line">	std::vector&lt;int&gt; a(n + 1), ans(q), left(q);</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">right</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">		a[i] = i - a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x, y; i &lt; q; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">		left[i] = <span class="number">1</span> + x;</span><br><span class="line">		right[n - y].emplace_back(i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function">TreeArray2 <span class="title">A</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">1</span>; r &lt;= n; ++r) &#123;</span><br><span class="line">		<span class="keyword">if</span> (a[r] &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">int</span> id = A.C.search(a[r], r + <span class="number">1</span>);</span><br><span class="line">			<span class="keyword">if</span> (id &gt; <span class="number">0</span>) A.add(<span class="number">1</span>, <span class="built_in">std</span>::<span class="built_in">min</span>(id, r), <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> x : right[r]) &#123;</span><br><span class="line">			ans[x] = A.sum(left[x]);</span><br><span class="line">			<span class="keyword">if</span> (left[x] &gt; <span class="number">1</span>) ans[x] -= A.sum(left[x] - <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ans[i] &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1401D：用-dfs-变成有根树，求出每条边的权重，存在第二次到达的节点上，然后给权重高的边赋大值即可"><a href="#1401D：用-dfs-变成有根树，求出每条边的权重，存在第二次到达的节点上，然后给权重高的边赋大值即可" class="headerlink" title="1401D：用 dfs 变成有根树，求出每条边的权重，存在第二次到达的节点上，然后给权重高的边赋大值即可"></a><a href="https://codeforces.com/contest/1401/problem/D" target="_blank" rel="noopener">1401D</a>：用 dfs 变成有根树，求出每条边的权重，存在第二次到达的节点上，然后给权重高的边赋大值即可</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LinkStar</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; head, nxt, to;</span><br><span class="line">    LinkStar(<span class="keyword">int</span> n) &#123;</span><br><span class="line">        nxt.<span class="built_in">clear</span>();</span><br><span class="line">        to.<span class="built_in">clear</span>();</span><br><span class="line">        head = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        nxt.emplace_back(head[u]);</span><br><span class="line">        head[u] = to.<span class="built_in">size</span>();</span><br><span class="line">        to.emplace_back(v);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		<span class="function">LinkStar <span class="title">A</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x, y; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">			A.addedge(x, y);</span><br><span class="line">			A.addedge(y, x);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> d[n + <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">bool</span> vis[n + <span class="number">1</span>] = &#123;&#125;;</span><br><span class="line">		<span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span>)&gt; dfs = [&amp;](<span class="keyword">int</span> u) -&gt; <span class="keyword">int</span> &#123;</span><br><span class="line">			vis[u] = <span class="literal">true</span>;</span><br><span class="line">			d[u] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = A.head[u]; ~i; i = A.nxt[i]) &#123;</span><br><span class="line">				<span class="keyword">if</span> (<span class="keyword">int</span> v = A.to[i]; !vis[v]) &#123;</span><br><span class="line">					d[u] += dfs(v);</span><br><span class="line">				&#125; </span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> d[u];</span><br><span class="line">		&#125;;</span><br><span class="line">		dfs(<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; r;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">			r.emplace_back(LL(d[i]) * (n - d[i]));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> m;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; m;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">p</span><span class="params">(m)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : p) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">		<span class="keyword">if</span> (r.<span class="built_in">size</span>() &gt; p.<span class="built_in">size</span>()) &#123;</span><br><span class="line">			<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">tmp</span><span class="params">(r.<span class="built_in">size</span>() - p.<span class="built_in">size</span>(), <span class="number">1</span>)</span></span>;</span><br><span class="line">			p.insert(p.<span class="built_in">end</span>(), tmp.<span class="built_in">begin</span>(), tmp.<span class="built_in">end</span>());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::sort(r.<span class="built_in">begin</span>(), r.<span class="built_in">end</span>());</span><br><span class="line">		<span class="built_in">std</span>::sort(p.<span class="built_in">begin</span>(), p.<span class="built_in">end</span>());</span><br><span class="line">		LL s = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span> (r.<span class="built_in">size</span>() &lt; p.<span class="built_in">size</span>()) &#123;</span><br><span class="line">			s = s * p.back() % M;</span><br><span class="line">			p.pop_back();	</span><br><span class="line">		&#125;</span><br><span class="line">		p.back() = p.back() * s % M;</span><br><span class="line">		LL ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != r.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">			ans += r[i] * p[i] % M;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ans % M &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1401E"><a href="#1401E" class="headerlink" title="1401E"></a><a href="https://codeforces.com/contest/1401/problem/E" target="_blank" rel="noopener">1401E</a></h3><p>先算左横线段，再算右横线段，左横线段被退出的时候对应位置加 <code>-1</code> 即可，然后根据竖线从左到右依次加入右横线段，剔除左横线段。用树状数组计算一下就可以了。</p>
<blockquote>
<p>注意如果横竖直线有触碰到两端，那么答案对应要 <code>+1</code>。<br>注意到如果数据范围很大（例如 <code>N = 1e9</code>）那么可以压缩一下达到目的。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TreeArray</span> &#123;</span></span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; s;</span><br><span class="line">    TreeArray() &#123;&#125;</span><br><span class="line">    TreeArray(<span class="keyword">int</span> n) &#123;</span><br><span class="line">		s.resize(n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> n &amp; (-n);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (id &lt; s.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            s[id] += p;</span><br><span class="line">            id += lowbit(id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">LL <span class="title">sum</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        LL r = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (id) &#123;</span><br><span class="line">            r += s[id];</span><br><span class="line">            id -= lowbit(id);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, m;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; la, ra;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> lx, rx, y;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; y &gt;&gt; lx &gt;&gt; rx;</span><br><span class="line">		<span class="keyword">if</span> (lx == <span class="number">0</span>) la.push_back(&#123;rx, y&#125;);</span><br><span class="line">		<span class="keyword">else</span> ra.push_back(&#123;lx, y&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	sort(la.<span class="built_in">begin</span>(), la.<span class="built_in">end</span>());</span><br><span class="line">	sort(ra.<span class="built_in">begin</span>(), ra.<span class="built_in">end</span>());</span><br><span class="line">	std::vector&lt;std::tuple&lt;int, int, int&gt;&gt; b(m);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[x, ly, ry] : b) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; ly &gt;&gt; ry;</span><br><span class="line">	sort(b.<span class="built_in">begin</span>(), b.<span class="built_in">end</span>());</span><br><span class="line">	LL r = <span class="number">1</span>;</span><br><span class="line">	<span class="function">TreeArray <span class="title">A</span><span class="params">(N + <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[x, y] : la) &#123;</span><br><span class="line">		A.add(y + <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span> (x == N) ++r;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//std::cout &lt;&lt; A.sum(100) &lt;&lt; std::endl;</span></span><br><span class="line">	<span class="keyword">int</span> lid = <span class="number">0</span>, rid = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[x, ly, ry] : b) &#123;</span><br><span class="line">		<span class="keyword">while</span> (lid &lt; la.<span class="built_in">size</span>() &amp;&amp; la[lid].first &lt; x) &#123;</span><br><span class="line">			A.add(la[lid].second + <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">			++lid;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (rid &lt; ra.<span class="built_in">size</span>() &amp;&amp; ra[rid].first &lt;= x) &#123;</span><br><span class="line">			A.add(ra[rid].second + <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">			++rid;</span><br><span class="line">		&#125;</span><br><span class="line">		r += A.sum(ry + <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span> (ly != <span class="number">0</span>) r -= A.sum(ly);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (ry == N) ++r;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="HDU-6838-Battle-for-Wosneth"><a href="#HDU-6838-Battle-for-Wosneth" class="headerlink" title="HDU 6838 Battle for Wosneth"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6838" target="_blank" rel="noopener">HDU 6838 Battle for Wosneth</a></h3><blockquote>
<p>有两个人记作 Alice 和 Bob，Alice 的生命值很高，所以可以认为是无限的，Bob 的生命值为 m。两个人的攻击命中率分别为 <code>p,q</code>。两个人轮流攻击对方。从 Alice 开始攻击，每次攻击的时候，如果 Alice 命中，那么能让对方的生命值减低 1，同时自己的生命值能恢复 1，如果 Bob 命中，那么能让对方的生命值减低 1，注意 Bob 不会自己回血。直到 Bob 的血量变为 0，游戏结束。Alice 想知道，游戏结束的时候，自己期望生命值。</p>
</blockquote>
<p>不妨设，期望为 <code>a[m]</code>, 则显然<br><code>a[m] = p(1-q)(a[m-1]+1) + pq a[m-1] + (1-p)q(a[m]-1) + (1-p)(1-q)a[m]</code><br>化简一下得到 $a_m =  a_{m - 1} + \frac{p - q}{p}$. 另外 $a_1 = p + (1 - p) q (a_1 - 1)  + (1 - p) (1 - q) a_1$，所以 $a_1 = \frac{p - q + pq}{p}$ 即 $a_m = \frac{p - q}{p} m + q$</p>
<h3 id="HDU-6842-Battle-for-Wosneth2"><a href="#HDU-6842-Battle-for-Wosneth2" class="headerlink" title="HDU 6842 Battle for Wosneth2"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=6842" target="_blank" rel="noopener">HDU 6842 Battle for Wosneth2</a></h3><blockquote>
<p>有两个人记作 Alice 和 Bob，生命值分别是 n,m，命中率分别为 p%,q%。两个人轮流攻击对方，从 Alice 开始攻击，每次攻击的时候，如果命中，那么能让对方的生命值减低 1，直到一方的生命值不超过 0 为止。问 Alice 胜的概率</p>
</blockquote>
<p>设 <code>a[n][m], b[m][n]</code> 分别表示表示 Alice, Bob 胜的概率。则<br><code>a[n][m] = p(1-b[n][m]) + (1-p)(1-b[n][m])</code>，<br><code>b[n][m] = q(1-a[m-1][n] + (1-q)(1-a[m][n]</code>，<br>所以我们有<code>(p+q-pq) a[n][m] = p(1-q) a[m][n] + (1-p)q a[m-1][n] + pq a[m-1][n-1]</code></p>
<h3 id="1399D-01序列分组，使得各组相邻元素不同（主要考察复杂度，超级容易-TLE）"><a href="#1399D-01序列分组，使得各组相邻元素不同（主要考察复杂度，超级容易-TLE）" class="headerlink" title="1399D: 01序列分组，使得各组相邻元素不同（主要考察复杂度，超级容易 TLE）"></a><a href="https://codeforces.com/contest/1399/problem/D" target="_blank" rel="noopener">1399D</a>: <code>01</code>序列分组，使得各组相邻元素不同（主要考察复杂度，超级容易 TLE）</h3><blockquote>
<p>可以存储当前 <code>1</code> 和 <code>0</code> 的个数，然后一直跑，就是 $O(n)$ 复杂度了</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">string</span> s;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; s;</span><br><span class="line">		<span class="keyword">int</span> k = <span class="number">0</span>, r[n];</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; id[<span class="number">2</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="keyword">int</span> t = (<span class="string">'0'</span> == s[i]);</span><br><span class="line">			<span class="keyword">if</span> (id[t].<span class="built_in">size</span>()) &#123;</span><br><span class="line">				r[i] = id[t].top();</span><br><span class="line">				id[t].pop();</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				r[i] = ++k;</span><br><span class="line">			&#125;</span><br><span class="line">			id[<span class="number">1</span> - t].push(r[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">print</span>(k);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r[i] &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1399E1：dfs-建树，然后就知道每条边的权重，然后有限队列贪心即可，注意是所有叶子节点到根的距离和"><a href="#1399E1：dfs-建树，然后就知道每条边的权重，然后有限队列贪心即可，注意是所有叶子节点到根的距离和" class="headerlink" title="1399E1：dfs 建树，然后就知道每条边的权重，然后有限队列贪心即可，注意是所有叶子节点到根的距离和"></a><a href="https://codeforces.com/contest/1399/problem/E1" target="_blank" rel="noopener">1399E1</a>：dfs 建树，然后就知道每条边的权重，然后有限队列贪心即可，注意是所有叶子节点到根的距离和</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LinkStar</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; head, nxt, to;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; w;</span><br><span class="line">	LinkStar(<span class="keyword">int</span> n) &#123;</span><br><span class="line">		nxt.<span class="built_in">clear</span>();</span><br><span class="line">		to.<span class="built_in">clear</span>();</span><br><span class="line">		head = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL val)</span> </span>&#123;</span><br><span class="line">		nxt.emplace_back(head[u]);</span><br><span class="line">		head[u] = to.<span class="built_in">size</span>();</span><br><span class="line">		to.emplace_back(v);</span><br><span class="line">		w.emplace_back(val);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">	<span class="keyword">int</span> d;</span><br><span class="line">	LL v;</span><br><span class="line">	Node(<span class="keyword">int</span> _d, LL _v) : d(_d), v(_v) &#123;&#125;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Node &amp;A) <span class="keyword">const</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> (v + <span class="number">1</span>) / <span class="number">2</span> * d &lt; (A.v + <span class="number">1</span>) / <span class="number">2</span> * A.d;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		LL s;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; s;</span><br><span class="line">		<span class="function">LinkStar <span class="title">diag</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v; i &lt; n; ++i) &#123;</span><br><span class="line">			LL w;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">			diag.addedge(u, v, w);</span><br><span class="line">			diag.addedge(v, u, w);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::priority_queue&lt;Node&gt; a;</span><br><span class="line">		<span class="keyword">bool</span> vis[n + <span class="number">1</span>] = &#123;&#125;;</span><br><span class="line">		<span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span>, LL)&gt; dfs = [&amp;](<span class="keyword">int</span> u, LL val) -&gt; <span class="keyword">int</span> &#123;</span><br><span class="line">			vis[u] = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = diag.head[u]; ~i; i = diag.nxt[i]) &#123;</span><br><span class="line">				<span class="keyword">int</span> v = diag.to[i];</span><br><span class="line">				<span class="keyword">if</span> (!vis[v]) cnt += dfs(v, diag.w[i]);</span><br><span class="line">			&#125;</span><br><span class="line">			cnt = <span class="built_in">std</span>::<span class="built_in">max</span>(cnt, <span class="number">1</span>);</span><br><span class="line">			s -= val * cnt;</span><br><span class="line">			a.push(&#123;cnt, val&#125;);</span><br><span class="line">			<span class="keyword">return</span> cnt;</span><br><span class="line">		&#125;;</span><br><span class="line">		dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span> (s &lt; <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">auto</span> [cnt, val] = a.top();</span><br><span class="line">			s += (val + <span class="number">1</span>) / <span class="number">2</span> * cnt;</span><br><span class="line">			<span class="keyword">if</span>(val &gt; <span class="number">1</span>) a.push(&#123;cnt, val / <span class="number">2</span>&#125;);</span><br><span class="line">			a.pop();</span><br><span class="line">			++r;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">print</span>(r);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1399E2-同-E1，只是贪心的时候，枚举费用为-2-的边的个数"><a href="#1399E2-同-E1，只是贪心的时候，枚举费用为-2-的边的个数" class="headerlink" title="1399E2:  同 E1，只是贪心的时候，枚举费用为 2 的边的个数"></a><a href="https://codeforces.com/contest/1399/problem/E2" target="_blank" rel="noopener">1399E2</a>:  同 E1，只是贪心的时候，枚举费用为 2 的边的个数</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LinkStar</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; head, nxt, to, c;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; w;</span><br><span class="line">	LinkStar(<span class="keyword">int</span> n) &#123;</span><br><span class="line">		nxt.<span class="built_in">clear</span>();</span><br><span class="line">		to.<span class="built_in">clear</span>();</span><br><span class="line">		head = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, LL val, <span class="keyword">int</span> cost)</span> </span>&#123;</span><br><span class="line">		nxt.emplace_back(head[u]);</span><br><span class="line">		head[u] = to.<span class="built_in">size</span>();</span><br><span class="line">		to.emplace_back(v);</span><br><span class="line">		w.emplace_back(val);</span><br><span class="line">		c.emplace_back(cost);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		LL s;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; s;</span><br><span class="line">		<span class="function">LinkStar <span class="title">diag</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, u, v, c; i &lt; n; ++i) &#123;</span><br><span class="line">			LL w;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; w &gt;&gt; c;</span><br><span class="line">			diag.addedge(u, v, w, c - <span class="number">1</span>);</span><br><span class="line">			diag.addedge(v, u, w, c - <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::tuple&lt;<span class="keyword">int</span>, <span class="keyword">int</span>, LL&gt;&gt; a;</span><br><span class="line">		<span class="keyword">bool</span> vis[n + <span class="number">1</span>] = &#123;&#125;;</span><br><span class="line">		<span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span>, LL, <span class="keyword">int</span>)&gt; dfs = [&amp;](<span class="keyword">int</span> u, LL val, <span class="keyword">int</span> cost) -&gt; <span class="keyword">int</span> &#123;</span><br><span class="line">			vis[u] = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = diag.head[u]; ~i; i = diag.nxt[i]) &#123;</span><br><span class="line">				<span class="keyword">int</span> v = diag.to[i];</span><br><span class="line">				<span class="keyword">if</span> (!vis[v]) cnt += dfs(v, diag.w[i], diag.c[i]);</span><br><span class="line">			&#125;</span><br><span class="line">			cnt = <span class="built_in">std</span>::<span class="built_in">max</span>(cnt, <span class="number">1</span>);</span><br><span class="line">			s -= val * cnt;</span><br><span class="line">			a.push_back(&#123;cost, cnt, val&#125;);</span><br><span class="line">			<span class="keyword">return</span> cnt;</span><br><span class="line">		&#125;;</span><br><span class="line">		dfs(<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; q[<span class="number">2</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> [cost, cnt, val] : a) &#123;</span><br><span class="line">			<span class="keyword">while</span> (val) &#123;</span><br><span class="line">				q[cost].emplace_back((val + <span class="number">1</span>) / <span class="number">2</span> * cnt);</span><br><span class="line">				val &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::sort(q[<span class="number">0</span>].<span class="built_in">begin</span>(), q[<span class="number">0</span>].<span class="built_in">end</span>(), <span class="built_in">std</span>::greater&lt;&gt;());</span><br><span class="line">		<span class="built_in">std</span>::sort(q[<span class="number">1</span>].<span class="built_in">begin</span>(), q[<span class="number">1</span>].<span class="built_in">end</span>(), <span class="built_in">std</span>::greater&lt;&gt;());</span><br><span class="line">		<span class="keyword">int</span> r = <span class="number">1e9</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : q[<span class="number">0</span>]) s += x;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = q[<span class="number">0</span>].<span class="built_in">size</span>(); i &lt;= q[<span class="number">1</span>].<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">			<span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; s - q[<span class="number">0</span>][j - <span class="number">1</span>] &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">				s -= q[<span class="number">0</span>][--j];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (s &gt;= <span class="number">0</span>) r = <span class="built_in">std</span>::<span class="built_in">min</span>(r, <span class="number">2</span> * i  + j);</span><br><span class="line">			<span class="keyword">if</span> (i != q[<span class="number">1</span>].<span class="built_in">size</span>()) s += q[<span class="number">1</span>][i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">print</span>(r);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1399F-区间-dp-问题"><a href="#1399F-区间-dp-问题" class="headerlink" title="1399F :  区间 dp 问题"></a><a href="https://codeforces.com/contest/1399/problem/F" target="_blank" rel="noopener">1399F</a> :  区间 dp 问题</h3><blockquote>
<p>用 <code>f[m]</code> 表示从 <code>a[i]</code> 的左边界到，<code>m</code> 的区间个数(是被一个大的覆盖了的区间，size 一般不为 1）</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// follow the idea of Jiangly</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		std::vector&lt;std::pair&lt;int, int&gt;&gt; a(n);</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[l, r] : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r;</span><br><span class="line">		a.push_back(&#123;<span class="number">1</span>, <span class="number">2e5</span>&#125;);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[l, r] : a) &#123;</span><br><span class="line">			v.emplace_back(l);</span><br><span class="line">			v.emplace_back(r);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::sort(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>());</span><br><span class="line">		v.erase(<span class="built_in">std</span>::unique(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>()), v.<span class="built_in">end</span>());</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;[l, r] : a) &#123;</span><br><span class="line">			l = <span class="built_in">std</span>::lower_bound(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), l) - v.<span class="built_in">begin</span>();</span><br><span class="line">			r = <span class="built_in">std</span>::lower_bound(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), r) - v.<span class="built_in">begin</span>();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::sort(a.<span class="built_in">begin</span>(), a.<span class="built_in">end</span>(), [](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;lhs, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;rhs) &#123;</span><br><span class="line">			<span class="keyword">if</span> (lhs.first == rhs.first) <span class="keyword">return</span> lhs.second &lt; rhs.second;</span><br><span class="line">			<span class="keyword">return</span> lhs.first &gt; rhs.first;</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="keyword">int</span> dp[n + <span class="number">1</span>] = &#123;&#125;;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">			<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">f</span><span class="params">(a[i].second + <span class="number">1</span>)</span></span>;</span><br><span class="line">			<span class="keyword">int</span> mx = <span class="number">0</span>, x = a[i].first - <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">				<span class="keyword">if</span> (a[j].second &gt; a[i].second) <span class="keyword">continue</span>;</span><br><span class="line">				<span class="keyword">while</span> (x + <span class="number">1</span> &lt; a[j].first) mx = <span class="built_in">std</span>::<span class="built_in">max</span>(mx, f[++x]);</span><br><span class="line">				f[a[j].second] = <span class="built_in">std</span>::<span class="built_in">max</span>(f[a[j].second], dp[j] + mx);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;t : f) mx = <span class="built_in">std</span>::<span class="built_in">max</span>(mx, t);</span><br><span class="line">			dp[i] = <span class="number">1</span> + mx;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">print</span>(dp[n] - <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1389F：二分图"><a href="#1389F：二分图" class="headerlink" title="1389F：二分图"></a><a href="https://codeforces.com/contest/1389/problem/F" target="_blank" rel="noopener">1389F</a>：二分图</h3><p><a href="https://codeforces.com/profile/emorgan5289" target="_blank" rel="noopener">emorgan5289 大佬的代码</a>以及<a href="https://codeforces.com/blog/entry/80723#comment-671203" target="_blank" rel="noopener">解释</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">multiset</span>&lt;<span class="built_in">array</span>&lt;<span class="keyword">int</span>, 3&gt;&gt; a;</span><br><span class="line"><span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	ios_base::sync_with_stdio(<span class="number">0</span>); <span class="built_in">cin</span>.tie(<span class="number">0</span>); <span class="built_in">cout</span>.tie(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">int</span> n; <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">		<span class="keyword">int</span> l, r, t; <span class="built_in">cin</span> &gt;&gt; l &gt;&gt; r &gt;&gt; t;</span><br><span class="line">		a.insert(t<span class="number">-1</span> ? <span class="built_in">array</span>&#123;r, <span class="number">1</span>, -l&#125; : <span class="built_in">array</span>&#123;l, <span class="number">0</span>, -r&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; [_, t, x] : a) &#123;</span><br><span class="line">		<span class="keyword">if</span> (t &amp;&amp; s.upper_bound(x) != s.<span class="built_in">begin</span>())</span><br><span class="line">			s.erase(--s.upper_bound(x)), n--;</span><br><span class="line">		<span class="keyword">if</span> (!t) s.insert(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; n &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1384D：两个人轮流取-n-个数，比较它们取的数的异或值，较大的赢"><a href="#1384D：两个人轮流取-n-个数，比较它们取的数的异或值，较大的赢" class="headerlink" title="1384D：两个人轮流取 $n$ 个数，比较它们取的数的异或值，较大的赢"></a><a href="https://codeforces.com/contest/1384/problem/D" target="_blank" rel="noopener">1384D</a>：两个人轮流取 $n$ 个数，比较它们取的数的异或值，较大的赢</h3><p>记 $s$ 为 $n$ 个数的异或值，如果 $s = 0$，那么显然平局，否则看与 $s$ 的最高位 异或不为 0 的数的人数 cnt，显然这个个数是奇数，所以为 $1 \mod 4$ ，那么先手赢，否则，我们看 $n - cnt$ 是否为奇数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">		<span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) sum ^= x;</span><br><span class="line">		<span class="keyword">if</span> (sum == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"DRAW\n"</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">int</span> k = <span class="built_in">std</span>::__lg(sum);</span><br><span class="line">			<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="keyword">if</span>((x &gt;&gt; k) &amp; <span class="number">1</span>) ++cnt;</span><br><span class="line">			<span class="keyword">if</span> (cnt % <span class="number">4</span> == <span class="number">1</span> || (n - cnt) % <span class="number">2</span> == <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"WIN\n"</span>;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"LOSE\n"</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1384B：很有意思的一道模拟题，我也不知道为什么我要想这么久，太菜了"><a href="#1384B：很有意思的一道模拟题，我也不知道为什么我要想这么久，太菜了" class="headerlink" title="1384B：很有意思的一道模拟题，我也不知道为什么我要想这么久，太菜了"></a><a href="https://codeforces.com/contest/1384/problem/B2" target="_blank" rel="noopener">1384B</a>：很有意思的一道模拟题，我也不知道为什么我要想这么久，太菜了</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n, k, len;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; len;</span><br><span class="line">		<span class="keyword">int</span> d[n];</span><br><span class="line">		<span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; d[i];</span><br><span class="line">			<span class="keyword">if</span> (d[i] &gt; len) flag = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">else</span> d[i] = len - d[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (flag) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"No\n"</span>;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> l = <span class="number">0</span>, r = k;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++ i)&#123;</span><br><span class="line">			<span class="keyword">int</span> li = <span class="built_in">std</span>::<span class="built_in">min</span>(k, d[i]);</span><br><span class="line">			<span class="keyword">int</span> ri = <span class="built_in">std</span>::<span class="built_in">max</span>(k, <span class="number">2</span> * k - d[i]);</span><br><span class="line">			<span class="keyword">if</span> (r &lt; <span class="number">2</span> * k) &#123;</span><br><span class="line">				l = <span class="number">0</span>;</span><br><span class="line">				r = <span class="built_in">std</span>::<span class="built_in">max</span>(r + <span class="number">1</span>, ri);</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (++l &gt; li) flag = <span class="literal">true</span>;</span><br><span class="line">			l = <span class="built_in">std</span>::<span class="built_in">min</span>(l, k);</span><br><span class="line">			<span class="keyword">if</span> (d[i] &gt;= k) r = k;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (flag ? <span class="string">"No"</span> : <span class="string">"Yes"</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="洛谷-U122053-选择题：经典问题：每个人说另一个人是不是好人，-好人只说真话，坏人只说慌话，输出有多少种可能的情况，并输出可能的情况下，最多的好人和最少的好人数"><a href="#洛谷-U122053-选择题：经典问题：每个人说另一个人是不是好人，-好人只说真话，坏人只说慌话，输出有多少种可能的情况，并输出可能的情况下，最多的好人和最少的好人数" class="headerlink" title="洛谷 U122053 选择题：经典问题：每个人说另一个人是不是好人， 好人只说真话，坏人只说慌话，输出有多少种可能的情况，并输出可能的情况下，最多的好人和最少的好人数"></a><a href="https://www.luogu.com.cn/problem/U122053?contestId=31675" target="_blank" rel="noopener">洛谷 U122053 选择题</a>：<strong>经典问题</strong>：每个人说另一个人是不是好人， 好人只说真话，坏人只说慌话，输出有多少种可能的情况，并输出可能的情况下，最多的好人和最少的好人数</h3><p><code>val[i]</code> 表示第 $i$ 个人是否为好人， <code>w[i,j]</code> 表示$i$ 说 $j$ 是好人还是坏人，或 $j$ 说 $i$ 是好人还是坏人，那么必然 <code>val[i] ^ val[j] = !w[i,j]</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/U122053?contestId=31675</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> head[N], val[N], cnt, nxt[<span class="number">2</span> * N], to[<span class="number">2</span> * N];</span><br><span class="line"><span class="keyword">bool</span> w[<span class="number">2</span> * N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	cnt = <span class="number">-1</span>;</span><br><span class="line">	<span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span> (head));</span><br><span class="line">	<span class="built_in">memset</span>(val, <span class="number">-1</span>, <span class="keyword">sizeof</span> (val));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">bool</span> flag)</span> </span>&#123;</span><br><span class="line">	nxt[++cnt] = head[u];</span><br><span class="line">	head[u] = cnt;</span><br><span class="line">	to[cnt] = v;</span><br><span class="line">	w[cnt] = flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 此题BFS更好，不过DFS也能过</span></span><br><span class="line">std::pair&lt;int, int&gt; dfs(int u, int flag) &#123;</span><br><span class="line">	val[u] = flag;</span><br><span class="line">	<span class="keyword">int</span> r1 = <span class="number">1</span>, r2 = flag;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; ~i; i = nxt[i]) &#123;</span><br><span class="line">		<span class="keyword">int</span> v = to[i];</span><br><span class="line">		<span class="keyword">if</span> (val[v] != <span class="number">-1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> (val[v] != (val[u] ^ w[i])) <span class="keyword">return</span> &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">auto</span> [vr1, vr2] = dfs(v, val[u] ^ w[i]);</span><br><span class="line">			<span class="keyword">if</span> (vr1 == <span class="number">-1</span>) <span class="keyword">return</span> &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">			r1 += vr1;</span><br><span class="line">			r2 += vr2;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> &#123;r1, r2&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">std::pair&lt;int, int&gt; bfs(int iu, int iflag) &#123;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">queue</span>&lt;<span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line">	q.push(&#123;iu, iflag&#125;);</span><br><span class="line">	<span class="keyword">int</span> r1 = <span class="number">0</span>, r2 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">		<span class="keyword">auto</span> [u, flag] = q.front();</span><br><span class="line">		q.pop();</span><br><span class="line">		<span class="keyword">if</span> (val[u] != <span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">		val[u] = flag;</span><br><span class="line">		++r1;</span><br><span class="line">		r2 += flag;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; ~i; i = nxt[i]) &#123;</span><br><span class="line">			<span class="keyword">int</span> v = to[i];</span><br><span class="line">			<span class="keyword">if</span> (val[v] != <span class="number">-1</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (val[v] != (val[u] ^ w[i])) <span class="keyword">return</span> &#123;<span class="number">-1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">			&#125; <span class="keyword">else</span> q.push(&#123;v, val[u] ^ w[i]&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> &#123;r1, r2&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">powMod</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	LL r = <span class="number">1</span>, x = <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">while</span> (n) &#123;</span><br><span class="line">		<span class="keyword">if</span> (n &amp; <span class="number">1</span>) r = r * x % M;</span><br><span class="line">		n &gt;&gt;= <span class="number">1</span>; x = x * x % M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	init();</span><br><span class="line">	<span class="keyword">int</span> n;	</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, x; i &lt;= n; ++i) &#123;</span><br><span class="line">		<span class="keyword">bool</span> flag;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x &gt;&gt; flag;</span><br><span class="line">		addedge(i, x, !flag);</span><br><span class="line">		addedge(x, i, !flag);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> now = <span class="number">0</span>, mx = <span class="number">0</span>, mi = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="keyword">if</span> (val[i] == <span class="number">-1</span>) &#123;</span><br><span class="line">		<span class="comment">// auto [r1, r2] = dfs(i, 1);</span></span><br><span class="line">		<span class="keyword">auto</span> [r1, r2] = bfs(i, <span class="number">1</span>);</span><br><span class="line">		<span class="keyword">if</span> (r1 == <span class="number">-1</span>) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"No answer\n"</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		++now;</span><br><span class="line">		mx += <span class="built_in">std</span>::<span class="built_in">max</span>(r2, r1 - r2);</span><br><span class="line">		mi += <span class="built_in">std</span>::<span class="built_in">min</span>(r2, r1 - r2);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; powMod(now) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; mx &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; mi &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="洛谷-U122055-出生点-：简单包容排斥"><a href="#洛谷-U122055-出生点-：简单包容排斥" class="headerlink" title="洛谷 U122055 出生点 ：简单包容排斥"></a><a href="https://www.luogu.com.cn/problem/U122055?contestId=31675" target="_blank" rel="noopener">洛谷 U122055 出生点</a> ：简单包容排斥</h3><p><strong>仅考虑 $x$-轴</strong></p>
<p>当$k=0$ 时，那么距离之和就是</p>
<script type="math/tex; mode=display">
m^2 \sum_{i=1}^n i(n-i) = m^2 \sum_{1} ^n i(n-1) - i(i-1) = \frac{m^2(n-1)n(n+1)}{6}</script><p>然后我们减去 $k$ 个障碍点和其它所有点之间的距离</p>
<script type="math/tex; mode=display">
m  \sum _{i=1} ^k \sum_{t=1} ^n |a[i] - t| = m  \sum _{i=1} ^k \frac{(a[i])(a[i]-1) + (n-a[i])(n-a[i] + 1)}{2}</script><p>再加上 $k$ 个障碍点之间的距离</p>
<p>不妨按照 $x$-轴排序，然后把前缀和 <code>sa[i]</code> 求一下，再依次计算</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> LL inv2 = (M + <span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> LL inv6 = (M + <span class="number">1</span>)/<span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	LL n, m;</span><br><span class="line">	<span class="keyword">int</span> k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">	LL a[k], b[k];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i] &gt;&gt; b[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::sort(a, a + k);</span><br><span class="line">	<span class="built_in">std</span>::sort(b, b + k);</span><br><span class="line">	LL sa[k] = &#123;a[<span class="number">0</span>]&#125;, sb[k] = &#123;b[<span class="number">0</span>]&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; k; ++ i) &#123;</span><br><span class="line">		sa[i] = sa[i - <span class="number">1</span>] + a[i];</span><br><span class="line">		sb[i] = sb[i - <span class="number">1</span>] + b[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> f = [](LL m, LL n) -&gt; LL &#123;</span><br><span class="line">		<span class="keyword">return</span> m * m % M * (n - <span class="number">1</span>) % M * n % M * (n + <span class="number">1</span>) % M;</span><br><span class="line">	&#125;;</span><br><span class="line">	LL r0 = (f(m, n) + f(n, m)) * inv6 % M;</span><br><span class="line">	</span><br><span class="line">	LL r1 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++ i) &#123;</span><br><span class="line">		r1 += ((a[i] - <span class="number">1</span>) * a[i] + (n - a[i] + <span class="number">1</span>) * (n - a[i])) % M;</span><br><span class="line">	&#125;</span><br><span class="line">	r1 = r1 % M * m % M * inv2 % M;</span><br><span class="line">	</span><br><span class="line">	LL r2 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++ i) &#123;</span><br><span class="line">		r2 += ((b[i] - <span class="number">1</span>) * b[i] + (m - b[i] + <span class="number">1</span>) * (m - b[i])) % M;</span><br><span class="line">	&#125;</span><br><span class="line">	r2 = r2 % M * n % M * inv2 % M;</span><br><span class="line">	</span><br><span class="line">	LL r3 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">		r3 += (sa[k - <span class="number">1</span>] - sa[i] - a[i] * (k - <span class="number">1</span> - i)) % M;</span><br><span class="line">		r3 += (sb[k - <span class="number">1</span>] - sb[i] - b[i] * (k - <span class="number">1</span> - i)) % M;</span><br><span class="line">	&#125;</span><br><span class="line">	r3 %= M;</span><br><span class="line"></span><br><span class="line">	LL r = (r0 - r1 - r2 + r3) % M;</span><br><span class="line">	<span class="keyword">if</span>(r &lt; <span class="number">0</span>) r += M;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="洛谷-U122054-强迫症-圆上-n-个点构成的无交错边的图的个数-f-n"><a href="#洛谷-U122054-强迫症-圆上-n-个点构成的无交错边的图的个数-f-n" class="headerlink" title="洛谷 U122054 强迫症 : 圆上 $n$ 个点构成的无交错边的图的个数 $f_n$"></a><a href="https://www.luogu.com.cn/problem/U122054?contestId=31675" target="_blank" rel="noopener">洛谷 U122054 强迫症</a> : <a href="http://oeis.org/A054726" target="_blank" rel="noopener">圆上 $n$ 个点构成的无交错边的图的个数 $f_n$</a></h3><p>$f_0 = 1, f_1 = 1, f_2 = 2, f_3 = 8$，考虑 $n+1$ 个点，如果第 $n+1$ 点与其他点没有边相连有 $f_n$ 种，如果相连，设最小的数为 $i$, 那么一边有 $f_i$ 种（注意到 $n+1$ 这个节点可以不管，因为它不跟小于 $i$ 的节点相连），另一边有 $\frac{f_{n+2-i}}{2}$，即</p>
<script type="math/tex; mode=display">
f_{n + 1} = f_n + \frac{1}{2}\sum_{i = 1} ^ n f_i f_{n+2-i}</script><p>化简一下，可知 </p>
<script type="math/tex; mode=display">
f_{n+1} = 2f_n + \sum_{i=2} ^n f_i f_{n+2-i}</script><p>我们令 $g_n = f_{n+1}$，则 $g_n = 2g_{n-1} + \sum_{i=2} ^ n g_{i-1} g_{n+1-i} = 2 g_{n-1} + \sum_{i=1} ^{n-1} g_i g_{n-i}$，所以 $g_n = \frac{2}{3} g_{n-1} + \frac{1}{3} \sum_{i=0} ^n g_i g_{n-i}$。考虑 $g_n$ 的生成函数 $g(z)$：</p>
<script type="math/tex; mode=display">
g(z) = \sum_{i = 0} ^ {\infty} g_n z^n = g_0 + \frac{2}{3}  \sum_{i = 1} ^ {\infty} g_{n-1} z^n + \frac{1}{3} \sum_{i = 1} ^ {\infty} \sum_{i=0} ^ n g_i g_{n-i} z^n = g_0 + \frac{2}{3} z g(z) + \frac{1}{3} (g^2(z)  - g_0 ^ 2)</script><p>因此 $\frac{1}{3} g^2(z) + (\frac{2}{3} z - 1) g(z) + \frac{2}{3} = 0$，从而 $g(z) = \frac{3-2z \pm \sqrt{1 - 12 z + 4z^2}}{2}$, 由 $g_1 = 2$ 知 $g(z) = \frac{3-2z - \sqrt{1 - 12 z + 4z^2}}{2}$，从而 $f(z) = f_0 + z g(z) = 1 + \frac{3}{2} z - z^2 - \frac{z}{2} \sqrt{1 - 12 z + 4 z^2}$。</p>
<script type="math/tex; mode=display">
g'(z) = -1 - \frac{2z - 3}{\sqrt{1 - 12 z + 4 z^2}} = \frac{3-2z - \sqrt{1 - 12 z + 4 z^2}}{\sqrt{1 - 12 z + 4 z^2}}</script><script type="math/tex; mode=display">
(1 - 12z + 4 z^2) g'(z) = (3-2z - \sqrt{1 - 12 z + 4 z^2}) (\sqrt{1 - 12 z + 4 z^2}) = (3 - 2z) (3-2z - 2g(z)) - (1 - 12z + 4 z^2 = (4z - 6) g(z) + 8</script><p>因此 $(n + 1)g_{n+1} - 12 n g_n + 4(n-1)g_{n-1} = 4 g_{n-1} - 6 g_n$，整理得到 $(n+1)g_{n+1}  = (12 n - 6) g_n - (4n-8)g_{n-1}$</p>
<p>从而 $(n+1)f_{n+2} = (12 n - 6) f_{n+1} - (4n - 8) f_n$，即递推公式 $f_{n} = \frac{ (12 n - 30) f_{n-1} - (4 n - 16) f_{n-2} }{n-1}$。</p>
<p>所以原问题的答案就是 </p>
<script type="math/tex; mode=display">
\frac{ \sum_{i = 0} ^{n - 2} \sum_{j = i + 1} ^ {n-1} a_i a_j \frac{f_{j-i+1}}{2} \frac{f_{n+i-j+1}}{2} }{f_n} = \frac{ \sum_{i = 0} ^{n - 2} \sum_{j = i + 1} ^ {n-1} a_i a_j f_{j-i+1} f_{n+i-j+1}}{ 4 f_n}</script><p>仅看分子：</p>
<script type="math/tex; mode=display">
\sum_{i = 0} ^{n - 2} \sum_{j = i + 1} ^ {n-1} a_i a_j f_{j-i+1} f_{n+i-j+1} = \sum_{t = 2} ^ n f_t f_{n-t+2} \sum_{i=0}^{n-t} a_i a_{i+t-1}</script><p>如果我们定义 $b_i = a_{n-1-i}$，$c_t = \sum_{i = 0} ^{t} a_{t-i} b_{i} = \sum_{i = 0} ^{t} a_{i} b_{t-i} = \sum_{i = 0} ^{t} a_{i} a_{n-1-(t-i)}$，则 $c_{n-t} = \sum_{i = 0} ^{n-t} a_{i} a_{n-1-(n-t-i)} = \sum_{i = 0} ^{n-t} a_{i} a_{i+t-1}$ 。即答案为</p>
<script type="math/tex; mode=display">
\frac{ \sum_{t = 2} ^ n f_t f_{n-t+2} \cdot c_{n-t} }{4 f_n}</script><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// https://www.luogu.com.cn/problem/U122054?contestId=31675</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>, ROOT = <span class="number">3</span>;</span><br><span class="line"><span class="function">LL <span class="title">powMod</span><span class="params">(LL x, LL n)</span> </span>&#123;</span><br><span class="line">	<span class="function">LL <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">while</span> (n) &#123;</span><br><span class="line">		<span class="keyword">if</span> (n &amp; <span class="number">1</span>) r = r * x % M;</span><br><span class="line">		n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">		x = x * x % M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bitreverse</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; &amp;a)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i != a.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i &gt; j) <span class="built_in">std</span>::swap(a[i], a[j]);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> l = a.<span class="built_in">size</span>() &gt;&gt; <span class="number">1</span>;</span><br><span class="line">			(j ^= l) &lt; l; l &gt;&gt;= <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">nft</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; &amp;a, <span class="keyword">bool</span> isInverse = <span class="literal">false</span>)</span> </span>&#123;</span><br><span class="line">	LL g = powMod(ROOT, (M - <span class="number">1</span>) / a.<span class="built_in">size</span>());</span><br><span class="line">	<span class="keyword">if</span> (isInverse) &#123;</span><br><span class="line">		g = powMod(g, M - <span class="number">2</span>);</span><br><span class="line">		LL invLen = powMod(LL(a.<span class="built_in">size</span>()), M - <span class="number">2</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp; x: a) x = x * invLen % M;</span><br><span class="line">	&#125;</span><br><span class="line">	bitreverse(a);</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">w</span><span class="params">(a.<span class="built_in">size</span>(), <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i != w.<span class="built_in">size</span>(); ++i) w[i] = w[i - <span class="number">1</span>] * g % M;</span><br><span class="line">	<span class="keyword">auto</span> addMod = [](LL x, LL y) &#123;</span><br><span class="line">		<span class="keyword">return</span> (x += y) &gt;= M ? x -= M : x;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> <span class="built_in">step</span> = <span class="number">2</span>, half = <span class="number">1</span>; half != a.<span class="built_in">size</span>(); <span class="built_in">step</span> &lt;&lt;= <span class="number">1</span>, half &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, wstep = a.<span class="built_in">size</span>() / <span class="built_in">step</span>; i != a.<span class="built_in">size</span>(); i += <span class="built_in">step</span>) &#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = i; j != i + half; ++j) &#123;</span><br><span class="line">				LL t = (a[j + half] * w[wstep * (j - i)]) % M;</span><br><span class="line">				a[j + half] = addMod(a[j], M - t);</span><br><span class="line">				a[j] = addMod(a[j], t);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">mul</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; a, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sz = <span class="number">1</span>, tot = a.<span class="built_in">size</span>() + b.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span> (sz &lt; tot) sz *= <span class="number">2</span>;</span><br><span class="line">	a.resize(sz);</span><br><span class="line">	b.resize(sz);</span><br><span class="line">	nft(a);</span><br><span class="line">	nft(b);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != sz; ++i) a[i] = a[i] * b[i] % M;</span><br><span class="line">	nft(a, <span class="number">1</span>);</span><br><span class="line">	a.resize(tot);</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">b</span><span class="params">(a.rbegin(),a.rend())</span></span>;</span><br><span class="line">	<span class="keyword">auto</span> c = mul(a, b);</span><br><span class="line"></span><br><span class="line">	LL inv[n] = &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, f[n + <span class="number">1</span>] = &#123;<span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) inv[i] = (M - M / i) * inv[M % i] % M;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		f[i] = ((<span class="number">12</span> * i - <span class="number">30</span>)* f[i - <span class="number">1</span>] - (<span class="number">4</span> * i - <span class="number">16</span>) * f[i - <span class="number">2</span>]) % M * inv[i - <span class="number">1</span>] % M;</span><br><span class="line">		<span class="keyword">if</span> (f[i] &lt; <span class="number">0</span>) f[i] += M;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	LL r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">		r += f[i] * f[n - i + <span class="number">2</span>] % M * c[n - i] % M;</span><br><span class="line">	&#125;</span><br><span class="line">	r = r * inv[<span class="number">4</span>] % M * powMod(f[n], M - <span class="number">2</span>) % M;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1382D-：0-1-背包问题"><a href="#1382D-：0-1-背包问题" class="headerlink" title="1382D ：0-1 背包问题"></a><a href="https://codeforces.com/contest/1382/problem/D" target="_blank" rel="noopener">1382D</a> ：0-1 背包问题</h3><blockquote>
<p>注意到一段选择了 <code>a[i]</code> 那么后来连续小于 <code>a[i]</code> 的都要被选择。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n, maxn;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		<span class="keyword">int</span> a[<span class="number">2</span> * n];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span> * n; ++i) &#123;</span><br><span class="line">			<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">bool</span> dp[n + <span class="number">1</span>] = &#123;<span class="number">1</span>&#125;;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; <span class="number">2</span> * n; i = j) &#123;</span><br><span class="line">			<span class="keyword">while</span> (j &lt; <span class="number">2</span> * n &amp;&amp; a[j] &lt;= a[i]) ++j;</span><br><span class="line">			<span class="keyword">int</span> len = j - i;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = n; k &gt;= len; --k) &#123;</span><br><span class="line">				dp[k] |= dp[k - len];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (dp[n] ? <span class="string">"YES"</span> : <span class="string">"NO"</span>) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1382C-：设-f-0-1string-gt-0-1string将字符串-0-换成-1，1-换成-0，然后倒序。给定长度为-n-的字符串-a-b-。每次可以改变-a-的前缀，给出一种方案（不超过-3n-，或者不超过-2n-）"><a href="#1382C-：设-f-0-1string-gt-0-1string将字符串-0-换成-1，1-换成-0，然后倒序。给定长度为-n-的字符串-a-b-。每次可以改变-a-的前缀，给出一种方案（不超过-3n-，或者不超过-2n-）" class="headerlink" title="1382C ：设 f: 0-1string ---&gt; 0-1string将字符串 0 换成 1，1 换成 0，然后倒序。给定长度为 $n$ 的字符串$a, b$ 。每次可以改变 $a$ 的前缀，给出一种方案（不超过 $3n$，或者不超过 $2n$ ）"></a><a href="https://codeforces.com/contest/1382/problem/C2" target="_blank" rel="noopener">1382C</a> ：设 <code>f: 0-1string ---&gt; 0-1string</code>将字符串 0 换成 1，1 换成 0，然后倒序。给定长度为 $n$ 的字符串$a, b$ 。每次可以改变 $a$ 的前缀，给出一种方案（不超过 $3n$，或者不超过 $2n$ ）</h3><ul>
<li>注意到取 $n$ 再取 $1$，再去 $n$，这样只会改变最后一个，所以就给出了不超过 $3n$ 的方案</li>
<li>可以先将 $a$变成 全$0$，再把 $b$ 变成 全$0$ 的方案反序，然后再复合。变成 $0$ 的做法就是一直让前缀数字相同。</li>
</ul>
<p>方案一：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">#define watch(x) std::cout &lt;&lt; (#x) &lt;&lt; &quot; is &quot; &lt;&lt; (x) &lt;&lt; std::endl</span><br><span class="line">using LL &#x3D; long long;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">	&#x2F;&#x2F;freopen(&quot;in&quot;,&quot;r&quot;,stdin);</span><br><span class="line">	std::ios::sync_with_stdio(false);</span><br><span class="line">	std::cin.tie(nullptr);</span><br><span class="line">	int cas;</span><br><span class="line">	std::cin &gt;&gt; cas;</span><br><span class="line">	while (cas--) &#123;</span><br><span class="line">		int n;</span><br><span class="line">		std::string a, b;</span><br><span class="line">		std::cin &gt;&gt; n &gt;&gt; a &gt;&gt; b;</span><br><span class="line">		std::vector&lt;int&gt; q;</span><br><span class="line">		while (--n &gt;&#x3D; 0) &#123;</span><br><span class="line">			if(a[n] !&#x3D; b[n]) &#123;</span><br><span class="line">				q.emplace_back(n + 1);</span><br><span class="line">				q.emplace_back(1);</span><br><span class="line">				q.emplace_back(n + 1);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		std::cout &lt;&lt; q.size();</span><br><span class="line">		for (auto &amp;x : q) std::cout &lt;&lt; &quot; &quot; &lt;&lt; x;</span><br><span class="line">		std::cout &lt;&lt; std::endl;</span><br><span class="line">	&#125;</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>方案二：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">string</span> a, b;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; a &gt;&gt; b;</span><br><span class="line">		a += <span class="string">'0'</span>; b += <span class="string">'0'</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; qa, qb;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (a[i] != a[i<span class="number">-1</span>]) qa.emplace_back(i);</span><br><span class="line">			<span class="keyword">if</span> (b[i] != b[i<span class="number">-1</span>]) qb.emplace_back(i);</span><br><span class="line">		&#125;</span><br><span class="line">		qa.insert(qa.<span class="built_in">end</span>(), qb.rbegin(), qb.rend());</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; qa.<span class="built_in">size</span>();</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : qa) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; x;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="百度之星-2020-初赛-1008：数论函数题"><a href="#百度之星-2020-初赛-1008：数论函数题" class="headerlink" title="百度之星 2020 初赛 1008：数论函数题"></a><a href="http://bestcoder.hdu.edu.cn/contests/contest_showproblem.php?cid=889&amp;pid=1008" target="_blank" rel="noopener">百度之星 2020 初赛 1008</a>：数论函数题</h3><p>已知，$f(n) = \displaystyle \sum_{d|n} d \cdot [\gcd(d,\frac{n}{d}) == 1]$，求 $\displaystyle \sum_{n=1} ^N f(n)$</p>
<p>首先 </p>
<script type="math/tex; mode=display">
f(n) = \sum_{d|n} d \cdot [\gcd(d,\frac{n}{d}) == 1] = \sum_{d|n} d \cdot \sum_{l| \gcd(d,\frac{n}{d})} \mu(l) = \sum_{l^2 | n} \mu(l) \cdot l \cdot g(\frac{n}{l^2})</script><p>其中 $g(n) = \displaystyle \sum_{d|n} d$，所以 </p>
<script type="math/tex; mode=display">
\sum_{n=1} ^N f(n) = \sum_{n=1} ^N \sum_{l^2 | n} \mu(l) \cdot l \cdot g(\frac{n}{l^2}) = \sum_{l=1}^{\sqrt{N}} \mu(l) l \sum_{n=1} ^{\lfloor \frac{N}{l^2} \rfloor} g(n) = \sum_{l=1}^{\sqrt{N}} \mu(l) \cdot l \cdot h(\lfloor \frac{N}{l^2} \rfloor)</script><p>其中 $h(n) = \sum_{i = 1} ^n g(i) = \sum_{d=1}^n d \lfloor \frac{n}{d} \rfloor$，求 $h(n)$ 有众所周知的 $O (\sqrt{n})$ 的算法，所以总时间复杂度为 $O(\sum \frac{\sqrt{N}}{l}) = O(\sqrt{N} \log N)$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mu[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initmu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = i * <span class="number">2</span>; j &lt; N; j += i) &#123;</span><br><span class="line">			mu[j] -= mu[i];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>); <span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	initmu();</span><br><span class="line">	<span class="keyword">auto</span> f = [](LL n) &#123;</span><br><span class="line">		LL ret = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (LL l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">			r = n / (n / l);</span><br><span class="line">			ret += ((n / l) % M) * ((l + r) % M) % M * ((r - l + <span class="number">1</span>) % M) % M;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ret % M * ((M + <span class="number">1</span>) / <span class="number">2</span>) % M;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span> (cas--) &#123;</span><br><span class="line">		LL n, ans = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		<span class="keyword">for</span> (LL i = <span class="number">1</span>; i * i &lt;= n; ++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> (mu[i] == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">			ans += (M + mu[i]) * i % M * f(n / (i * i)) % M;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ans%M &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>另外一种计算思考：考虑每一个 $d$ 对答案的贡献，则 </p>
<script type="math/tex; mode=display">
\begin{array}{lc}
ans_N &= \sum_{d=1} ^N d \sum_{x d \leq N}  [\gcd(x,d) == 1] \\
&=  \sum_{d=1} ^N d \sum_{x d \leq N}  \sum_{l|gcd(x,d)} \mu(l) \\
&= \sum_{l=1} ^{\sqrt{N}} \mu(l) l \sum_{d = 1} ^{\lfloor \frac{N}{l} \rfloor}  d \cdot \lfloor \frac{N}{l^2 d} \rfloor\\
&= \sum_{l=1} ^{\sqrt{N}} \mu(l) l \sum_{d = 1} ^{\lfloor \frac{N}{l^2} \rfloor} d \cdot \lfloor \frac{ \lfloor\frac{N}{l^2} \rfloor}{d} \rfloor \\
\end{array}</script><h3 id="Atcode：经典生成函数题"><a href="#Atcode：经典生成函数题" class="headerlink" title="Atcode：经典生成函数题"></a><a href="https://atcoder.jp/contests/aising2020/tasks/aising2020_f" target="_blank" rel="noopener">Atcode</a>：经典生成函数题</h3><p>题目很容易转化成，满足所有$(a_1+\cdots+a_5)+2(b_1+\cdots+b_5) \leq N$的$a_1 \cdots a_5$之和，其中$a_i,b_i$ 均为非负整数</p>
<p>我一开始把 5 看作变量，从 <code>1,2,3</code> 一直推出 5 的公式，贼麻烦。后来  <a href="https://codeforces.com/profile/querty20002" target="_blank" rel="noopener">querty20002</a> 给出了生成函数做法的 <a href="https://codeforces.com/blog/entry/79978#comment-659438" target="_blank" rel="noopener">题解</a>。答案唯一的依赖于 $N$，即可认为答案是关于 $N$ 的数列，那么它的生成函数即为：</p>
<script type="math/tex; mode=display">
\begin{array}{cl}
\sum a_1a_2a_3a_4a_5(N) x^N &= (x+2x^2+\cdots)^5 (1+x^2+x^4+\cdots)^5 (1+x+x^2) \\
&= (\frac{x}{(1-x)^2})^5 (\frac{1}{1-x^2})^5 \frac{1}{1-x} \\
&=  \frac{x^5(1+x)^{11}}{(1-x^2)^{16}}\\
&= x^5(1+x)^{11} \sum_{n} \binom{n+15}{15} x^{2n}
\end{array}</script><p>所以答案就是 $\sum_{i=N\%2}^{11} \binom{11}{i} \binom{\frac{N-i-5}{2}+15}{15}$，所以我们选择 Python 交题 0.0</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line">M = <span class="number">1000000007</span></span><br><span class="line">T = int(input())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(T):</span><br><span class="line">	n = int(input())</span><br><span class="line">	r = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range((n<span class="number">-5</span>)%<span class="number">2</span>,<span class="number">12</span>,<span class="number">2</span>):</span><br><span class="line">		r+=math.comb(<span class="number">11</span>,i)%M*math.comb((n-i+<span class="number">25</span>)//<span class="number">2</span>,<span class="number">15</span>)%M;</span><br><span class="line">	print(r%M)</span><br></pre></td></tr></table></figure>
<p>或者 C++ 也行</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">constexpr</span> LL M = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="function">LL <span class="title">inv</span><span class="params">(LL a,LL p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a==<span class="number">1</span>?<span class="number">1</span>:(p-p/a)*inv(p%a,p)%p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">C</span><span class="params">(LL n, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(k==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	LL r = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i)&#123;</span><br><span class="line">		r = r*(n-i)%M*inv(i+<span class="number">1</span>,M)%M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		LL n ,r = <span class="number">0</span>;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=(n+<span class="number">1</span>)%<span class="number">2</span>;i&lt;=<span class="number">11</span>;i+=<span class="number">2</span>) &#123;</span><br><span class="line">			r+=C(<span class="number">11</span>,i)*C((n-i+<span class="number">25</span>)/<span class="number">2</span>,<span class="number">15</span>)%M;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;r%M&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1215E：给定长度为-n-数据范围-1-20-的数组，求最少交换相邻位置元素使得相同的数字都紧挨着"><a href="#1215E：给定长度为-n-数据范围-1-20-的数组，求最少交换相邻位置元素使得相同的数字都紧挨着" class="headerlink" title="1215E：给定长度为 $n$ 数据范围 $[1,20]$ 的数组，求最少交换相邻位置元素使得相同的数字都紧挨着"></a><a href="https://codeforces.com/contest/1215/problems" target="_blank" rel="noopener">1215E</a>：给定长度为 $n$ 数据范围 $[1,20]$ 的数组，求最少交换相邻位置元素使得相同的数字都紧挨着</h3><blockquote>
<p>参考 <a href="https://skywt.cn/posts/cf1215e" target="_blank" rel="noopener">cf1215e</a>，注意到交换两个数字，其它数字的相对位置不发生改变</p>
</blockquote>
<p><strong>状态 dp</strong>：设 <code>dp[mask]</code> 表示状态为 <code>mask</code> 的最小交换次数，其中 <code>mask&amp;(1&lt;&lt;i)=1</code> 表示值为 <code>1+i</code> 的数已经被考虑到了。所以 $dp[2^{20}-1]$ 就是我们要的结果。状态转移</p>
<script type="math/tex; mode=display">
dp[mask] = \min_{j \in mask} dp[mask\wedge2^{j}] + \sum_{k \in mask\wedge2^{j}} cnt(j,k)</script><p>其中 <code>cnt(j,k)</code> 表示把    所有的 <code>j</code> 移动到 <code>k</code> 前面需要的次数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; endl</span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> N = <span class="number">20</span>;</span><br><span class="line">LL cnt[N][N],s[N],dp[<span class="number">1</span>&lt;&lt;N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,x;i&lt;n;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;x;--x;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;N;++j) <span class="keyword">if</span>(x!=j)&#123;</span><br><span class="line">			cnt[x][j] += s[j];</span><br><span class="line">		&#125;</span><br><span class="line">		++s[x];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">memset</span>(dp,<span class="number">0x3f</span>,<span class="keyword">sizeof</span>(dp));</span><br><span class="line">	dp[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=(<span class="number">1</span>&lt;&lt;N);++i)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;N;++j) <span class="keyword">if</span>(!(i&amp;(<span class="number">1</span>&lt;&lt;j)))&#123;</span><br><span class="line">			LL s = dp[i];</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;N;++k) <span class="keyword">if</span>(i&amp;(<span class="number">1</span>&lt;&lt;k))&#123;</span><br><span class="line">				s+=cnt[j][k];</span><br><span class="line">			&#125;</span><br><span class="line">			dp[i|(<span class="number">1</span>&lt;&lt;j)] = <span class="built_in">min</span>(dp[i|(<span class="number">1</span>&lt;&lt;j)],s);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;dp[(<span class="number">1</span>&lt;&lt;N)<span class="number">-1</span>]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以上代码基本 copy <a href="https://codeforces.com/profile/WZYYN" target="_blank" rel="noopener">WZYYN</a> 的<a href="https://codeforces.com/contest/1215/submission/60614830" target="_blank" rel="noopener">代码</a></p>
</blockquote>
<h3 id="1228E：（二维）包容排斥原理"><a href="#1228E：（二维）包容排斥原理" class="headerlink" title="1228E：（二维）包容排斥原理"></a><a href="https://codeforces.com/contest/1228/problem/E" target="_blank" rel="noopener">1228E</a>：（二维）包容排斥原理</h3><blockquote>
<p>在 $n \times n$ 的格子中填不超过$k$的正整数，使得每行每列的最小值都为 1 的填法方案数。下图是 <a href="https://codeforces.com/blog/entry/70162" target="_blank" rel="noopener">官方题解</a></p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="1228E.png" alt="1228E"></p>
<p><strong>无论是 dp 还是包容排斥，定义好状态是最重要的。</strong></p>
<h3 id="1148B：在一次转机的旅行中，取消-k-个航班，使得旅客最晚达到终点"><a href="#1148B：在一次转机的旅行中，取消-k-个航班，使得旅客最晚达到终点" class="headerlink" title="1148B：在一次转机的旅行中，取消 $k$ 个航班，使得旅客最晚达到终点"></a><a href="https://codeforces.com/contest/1148/problem/B" target="_blank" rel="noopener">1148B</a>：在一次转机的旅行中，取消 $k$ 个航班，使得旅客最晚达到终点</h3><blockquote>
<p>一开始被卡住了，想一下子吃个胖子 0.0 其实枚举起点取消的航班数，然后取最大值即可</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n,m,ta,tb,k;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m&gt;&gt;ta&gt;&gt;tb&gt;&gt;k;</span><br><span class="line">	<span class="keyword">int</span> a[n],b[m];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">		a[i]+=ta;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;++i) <span class="built_in">cin</span>&gt;&gt;b[i];</span><br><span class="line">	<span class="keyword">if</span>(n&lt;=k||m&lt;=k)&#123;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=k;++i)&#123;</span><br><span class="line">			<span class="keyword">int</span> id = lower_bound(b,b+m,a[i])-b;</span><br><span class="line">			<span class="keyword">if</span>(id+k-i&gt;=m)&#123;</span><br><span class="line">				ans = <span class="number">-1</span>;<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			ans = <span class="built_in">max</span>(ans,tb+b[id+k-i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1251F-组成周长固定的先单调递增后单调递减的序列"><a href="#1251F-组成周长固定的先单调递增后单调递减的序列" class="headerlink" title="1251F:  组成周长固定的先单调递增后单调递减的序列"></a><a href="https://codeforces.com/contest/1251/problem/F" target="_blank" rel="noopener">1251F</a>:  组成周长固定的先单调递增后单调递减的序列</h3><blockquote>
<p>很快就能想到周长为 $2(L+x)$，其中 $L,x$ 分别表示序列最大值和长度。一开始想不明白的地方在于，如果有两个长度相同的怎么计数，后来发现相同的可以标记一个只能放左边，另一个只能放右边。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">constexpr</span> LL M = <span class="number">998244353</span>,ROOT=<span class="number">3</span>;</span><br><span class="line"><span class="function">LL <span class="title">powmod</span><span class="params">(LL x,LL n)</span></span>&#123;</span><br><span class="line">	<span class="function">LL <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">while</span>(n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n&amp;<span class="number">1</span>) r=r*x%M;</span><br><span class="line">		n&gt;&gt;=<span class="number">1</span>; x=x*x%M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bitreverse</span><span class="params">(<span class="built_in">vector</span>&lt;LL&gt; &amp;a)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;i!=a.<span class="built_in">size</span>();++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(i&gt;j) swap(a[i],a[j]);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> l=a.<span class="built_in">size</span>()&gt;&gt;<span class="number">1</span>;(j^=l)&lt;l;l&gt;&gt;=<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">nft</span><span class="params">(<span class="built_in">vector</span>&lt;LL&gt; &amp;a,<span class="keyword">bool</span> isInverse=<span class="literal">false</span>)</span></span>&#123;</span><br><span class="line">	LL g = powmod(ROOT,(M<span class="number">-1</span>)/a.<span class="built_in">size</span>());</span><br><span class="line">	<span class="keyword">if</span>(isInverse)&#123;</span><br><span class="line">		g = powmod(g,M<span class="number">-2</span>);</span><br><span class="line">		LL invLen = powmod(LL(a.<span class="built_in">size</span>()),M<span class="number">-2</span>);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:a) x=x*invLen%M;</span><br><span class="line">	&#125;</span><br><span class="line">	bitreverse(a);</span><br><span class="line">	<span class="function"><span class="built_in">vector</span>&lt;LL&gt; <span class="title">w</span><span class="params">(a.<span class="built_in">size</span>(),<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i!=w.<span class="built_in">size</span>();++i) w[i] = w[i<span class="number">-1</span>]*g%M;</span><br><span class="line">	<span class="keyword">auto</span> addMod = [](LL x,LL y)&#123;<span class="keyword">return</span> (x+=y)&gt;=M?x-=M:x;&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> <span class="built_in">step</span>=<span class="number">2</span>,half = <span class="number">1</span>;half!=a.<span class="built_in">size</span>();<span class="built_in">step</span>&lt;&lt;=<span class="number">1</span>,half&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=a.<span class="built_in">size</span>();i+=<span class="built_in">step</span>)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j!=half;++j)&#123;</span><br><span class="line">				LL t = (a[i+j+half]*w[a.<span class="built_in">size</span>()/<span class="built_in">step</span>*j])%M;</span><br><span class="line">				a[i+j+half]=addMod(a[i+j],M-t);</span><br><span class="line">				a[i+j]=addMod(a[i+j],t);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;LL&gt; <span class="title">mul</span><span class="params">(<span class="built_in">vector</span>&lt;LL&gt; a,<span class="built_in">vector</span>&lt;LL&gt; b)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> sz=<span class="number">1</span>,tot = a.<span class="built_in">size</span>()+b.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">while</span>(sz&lt;tot) sz*=<span class="number">2</span>;</span><br><span class="line">	a.resize(sz);b.resize(sz);</span><br><span class="line">	nft(a);nft(b);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=sz;++i) a[i] = a[i]*b[i]%M;</span><br><span class="line">	nft(a,<span class="number">1</span>);</span><br><span class="line">	a.resize(tot);</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> N = <span class="number">3e5</span>+<span class="number">2</span>;</span><br><span class="line">LL fac[N],ifac[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	fac[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i) fac[i] = fac[i<span class="number">-1</span>]*i%M;</span><br><span class="line">	ifac[N<span class="number">-1</span>] = powmod(fac[N<span class="number">-1</span>],M<span class="number">-2</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=N<span class="number">-1</span>;i;--i) ifac[i<span class="number">-1</span>] = ifac[i]*i%M;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">binom</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> fac[n]*ifac[k]%M*ifac[n-k]%M;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	init();</span><br><span class="line">	<span class="keyword">int</span> n,k,x,q;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k;</span><br><span class="line">	<span class="keyword">int</span> cnt[N] = &#123;&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">		++cnt[x];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">vector</span>&lt;LL&gt; <span class="title">ans</span><span class="params">(<span class="number">2</span>*N)</span></span>;</span><br><span class="line">	<span class="keyword">while</span>(k--)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">		<span class="keyword">int</span> c1=<span class="number">0</span>,c2=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;x;++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(cnt[i]&gt;<span class="number">1</span>) c2+=<span class="number">2</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(cnt[i]==<span class="number">1</span>) ++c1;</span><br><span class="line">		&#125;</span><br><span class="line">		vector&lt;LL&gt; a(c1+1),b(c2+1);</span><br><span class="line">		<span class="keyword">auto</span> inc = [](LL &amp;a,LL b)&#123;<span class="keyword">if</span>((a+=b)&gt;=M) a-=M;&#125;;</span><br><span class="line">		LL p2=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=c1;++i)&#123;</span><br><span class="line">			a[i] = binom(c1,i)*p2%M;</span><br><span class="line">			inc(p2,p2);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=c2;++i) b[i] = binom(c2,i);</span><br><span class="line">		a = mul(a,b);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=a.<span class="built_in">size</span>();++i)&#123;</span><br><span class="line">			inc(ans[i+x+<span class="number">1</span>],a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;q;</span><br><span class="line">	<span class="keyword">while</span>(q--)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;ans[x/<span class="number">2</span>]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1251E-花最少的钱，让所有人都投票给自己（选民跟风且贪财）"><a href="#1251E-花最少的钱，让所有人都投票给自己（选民跟风且贪财）" class="headerlink" title="1251E:  花最少的钱，让所有人都投票给自己（选民跟风且贪财）"></a><a href="https://codeforces.com/contest/1251/problem/E2" target="_blank" rel="noopener">1251E</a>:  花最少的钱，让所有人都投票给自己（选民跟风且贪财）</h3><blockquote>
<p>我们按照 $m$ 分层，然后从大到小记录白嫖的人，然后实在没法白嫖的，就取消费最少的。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a[n];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,x,y;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;x&gt;&gt;y;</span><br><span class="line">			a[x].emplace_back(y);</span><br><span class="line">		&#125;</span><br><span class="line">		LL r = <span class="number">0</span>;</span><br><span class="line">         <span class="comment">// q 也可以用 multiset 取代，会稍微快点</span></span><br><span class="line">		priority_queue&lt;<span class="keyword">int</span>,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;,greater&lt;<span class="keyword">int</span>&gt;&gt; q; <span class="comment">//白嫖的votes</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:a[i]) q.push(x);</span><br><span class="line">			<span class="keyword">while</span>(n-q.<span class="built_in">size</span>()&lt;i)&#123;</span><br><span class="line">				r+=q.top();</span><br><span class="line">				q.pop();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;r&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1375D-MEX-once-more，通过修改数组的某一个值成-mex，使得数组最终非降"><a href="#1375D-MEX-once-more，通过修改数组的某一个值成-mex，使得数组最终非降" class="headerlink" title="1375D: MEX once more，通过修改数组的某一个值成 mex，使得数组最终非降"></a><a href="https://codeforces.com/contest/1375/problem/D" target="_blank" rel="noopener">1375D</a>: MEX once more，通过修改数组的某一个值成 mex，使得数组最终非降</h3><blockquote>
<p>不妨最终变成 <code>0~n-1</code>，这是不好想的，特别是紧张的比赛的时候</p>
</blockquote>
<p>如果当前<code>mex = n</code> 即数列正好是一个排列，此时选择任意一个<code>a[i]!=i</code> 的位置，让 <code>a[i]=n</code>，否则 <code>mex &lt; n</code> 此时令<code>a[mex]=n</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin)</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">		<span class="keyword">int</span> a[n],v[n],c[n+<span class="number">1</span>]=&#123;&#125;,<span class="built_in">step</span>=n;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">			++c[a[i]];</span><br><span class="line">			v[i] = (a[i]==i);</span><br><span class="line">			<span class="keyword">if</span>(v[i]) --<span class="built_in">step</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">		<span class="keyword">int</span> mex = <span class="number">0</span>,l=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(c[mex]) ++mex;</span><br><span class="line">		<span class="keyword">while</span>(<span class="built_in">step</span>--)&#123;</span><br><span class="line">			<span class="keyword">if</span>(mex == n)&#123;</span><br><span class="line">				<span class="keyword">while</span>(v[l]) ++l;</span><br><span class="line">				q.push_back(l+<span class="number">1</span>);</span><br><span class="line">				--c[a[l]];</span><br><span class="line">				++c[mex];</span><br><span class="line">				mex = a[l];</span><br><span class="line">				a[l] = n;</span><br><span class="line">			&#125;</span><br><span class="line">			++c[mex];</span><br><span class="line">			<span class="keyword">int</span> nmex = mex;</span><br><span class="line">			<span class="keyword">if</span>(--c[a[mex]]==<span class="number">0</span>&amp;&amp;a[mex]&lt;mex)&#123;</span><br><span class="line">				nmex = a[mex];</span><br><span class="line">			&#125;</span><br><span class="line">			a[mex] = mex;</span><br><span class="line">			v[mex] = <span class="literal">true</span>;</span><br><span class="line">			q.push_back(mex+<span class="number">1</span>);</span><br><span class="line">			mex = nmex;</span><br><span class="line">			<span class="keyword">while</span>(c[mex]) ++mex;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;q.<span class="built_in">size</span>()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:q) <span class="built_in">cout</span>&lt;&lt;x&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>上面算法过度追求效率而丢失了可读性。其实可以缩短一半代码量</p>
</blockquote>
<h3 id="1119C-选取-4-个角，反位，使得-A-矩阵变成-B-矩阵"><a href="#1119C-选取-4-个角，反位，使得-A-矩阵变成-B-矩阵" class="headerlink" title="1119C: 选取 4 个角，反位，使得 A 矩阵变成 B 矩阵"></a><a href="https://codeforces.com/contest/1119/problem/c" target="_blank" rel="noopener">1119C</a>: 选取 4 个角，反位，使得 A 矩阵变成 B 矩阵</h3><blockquote>
<p>把 A，B 异或到 A，然后就转化成 A 矩阵变成 0 矩阵的方案了。这个时候一行行的处理就搞定了！（一开始就是没思路，后来灵光一闪）</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">502</span>;</span><br><span class="line"><span class="keyword">int</span> a[N][N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i][j])&#123;</span><br><span class="line">				++cnt;</span><br><span class="line">				<span class="keyword">if</span>(i!=n)&#123;</span><br><span class="line">					a[i+<span class="number">1</span>][j]^=a[i][j];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(cnt&amp;<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">if</span>(i==n) <span class="keyword">return</span> cnt==<span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin)</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n,m;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;a[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>,x;j&lt;=m;++j)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">			a[i][j]^=x;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;(f(n,m)?<span class="string">"Yes"</span>:<span class="string">"No"</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1110：打麻将-0-0"><a href="#1110：打麻将-0-0" class="headerlink" title="1110：打麻将 0.0"></a><a href="https://codeforces.com/contest/1110/problem/D" target="_blank" rel="noopener">1110</a>：打麻将 0.0</h3><blockquote>
<p>就是计算最容易听牌的数量，ABC 和 AAA 的个数和</p>
</blockquote>
<p>考虑 <code>ans[n][i][j]</code> 表示只考虑小于 <code>n</code> 的情况下，有 <code>i</code> 个 <code>(n-1,n)</code>和 <code>j</code> 个 <code>n</code> 剩余的答案。由于三个 <code>(n,n+1,n+2)</code> 可以转化成 <code>(n,n,n),(n+1,n+1,n+1),(n+2,n+2,n+2)</code>，所以 <code>i,j</code> 都小于 3。且 <code>ans[n+1][j][k] = max(ans[n][i][j]+i+(c[n+1]-i-j-k)/3)</code>，最后可以优化一下空间。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin)</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cnt,m;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cnt&gt;&gt;m;</span><br><span class="line">	<span class="keyword">int</span> c[m+<span class="number">1</span>]=&#123;&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,x;i&lt;cnt;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">		++c[x];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> dp[<span class="number">3</span>][<span class="number">3</span>],new_dp[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">	<span class="built_in">memset</span>(dp,<span class="number">-1</span>,<span class="keyword">sizeof</span>(dp));</span><br><span class="line">	dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> n=<span class="number">0</span>;n&lt;m;++n)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(new_dp,<span class="number">-1</span>,<span class="keyword">sizeof</span>(new_dp));</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;++i)&#123;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">3</span>;++j)&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;<span class="number">3</span>;++k)&#123;</span><br><span class="line">					<span class="keyword">if</span>(i+j+k&lt;=c[n+<span class="number">1</span>]&amp;&amp;dp[i][j]&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">						new_dp[j][k] = <span class="built_in">max</span>(new_dp[j][k],dp[i][j]+i+(c[n+<span class="number">1</span>]-i-j-k)/<span class="number">3</span>);</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		swap(new_dp,dp);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;dp[<span class="number">0</span>][<span class="number">0</span>]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1371E：给定长为-n-的数组和素数-p-，记满足-x-i-lt-a-sigma-i-0-leq-i-lt-n-的排列个数为-f-x-，输出所有-x-使得-p-not-n"><a href="#1371E：给定长为-n-的数组和素数-p-，记满足-x-i-lt-a-sigma-i-0-leq-i-lt-n-的排列个数为-f-x-，输出所有-x-使得-p-not-n" class="headerlink" title="1371E：给定长为 $n$ 的数组和素数 $p$，记满足 $x+i &lt; a_{\sigma(i)},0\leq i&lt;n$ 的排列个数为 $f(x)$，输出所有 $x$ 使得 $p \not | n$"></a><a href="https://codeforces.com/contest/1371/problem/E2" target="_blank" rel="noopener">1371E</a>：给定长为 $n$ 的数组和素数 $p$，记满足 $x+i &lt; a_{\sigma(i)},0\leq i&lt;n$ 的排列个数为 $f(x)$，输出所有 $x$ 使得 $p \not | n$</h3><blockquote>
<p>先排序，并且注意到 $x \in (\max a_i-n,\max a_i+n)$ 之间。</p>
</blockquote>
<p>记 $b_i$ 为数组中小于等于 $i$ 的元素个数。则 $f(x) = \prod\limits_{i=x}^{x+n-1} b_i-(i-x) = \prod \limits_{i=x}^{x+n-1} x-(i-b_i)$，所以我们预处理出 $i-b_i$ 即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n,p;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;p;</span><br><span class="line">	<span class="keyword">int</span> a[n];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) <span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">	<span class="keyword">int</span> mx = *max_element(a,a+n);</span><br><span class="line">	<span class="keyword">int</span> bb[n*<span class="number">2</span>+<span class="number">2</span>]=&#123;&#125;;</span><br><span class="line">	<span class="keyword">int</span> lx = mx-n;</span><br><span class="line">	<span class="keyword">int</span> *b = bb - lx; <span class="comment">// 黑科技，哈哈</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) ++b[<span class="built_in">max</span>(lx,a[i])];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n*<span class="number">2</span>+<span class="number">2</span>;++i) bb[i]+=bb[i<span class="number">-1</span>];</span><br><span class="line">	<span class="keyword">int</span> mp[n]=&#123;&#125;;</span><br><span class="line">	<span class="keyword">auto</span> modp = [](<span class="keyword">int</span> x,<span class="keyword">int</span> p)&#123;</span><br><span class="line">		x%=p;</span><br><span class="line">		<span class="keyword">return</span> x&lt;<span class="number">0</span>?x+p:x;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=lx;i&lt;=mx;++i)&#123;</span><br><span class="line">		++mp[modp(i-b[i],p)];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=lx;i&lt;=mx;++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(mp[modp(i,p)]==<span class="number">0</span>)&#123;</span><br><span class="line">			q.emplace_back(i);</span><br><span class="line">		&#125;</span><br><span class="line">		--mp[modp(i-b[i],p)];</span><br><span class="line">		++mp[modp(i+n-b[i+n],p)];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;q.<span class="built_in">size</span>()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i!=q.<span class="built_in">size</span>();++i)&#123;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;q[i]&lt;&lt;<span class="string">" \n"</span>[i == q.<span class="built_in">size</span>()<span class="number">-1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1245F：经典-XOR-递归"><a href="#1245F：经典-XOR-递归" class="headerlink" title="1245F：经典 XOR 递归"></a><a href="https://codeforces.com/contest/1245/problem/F" target="_blank" rel="noopener">1245F</a>：经典 XOR 递归</h3><blockquote>
<p>在区间 <code>[l,r)</code> 中找 <code>(a,b)</code> 使得 $a+b = a \wedge b$ 的个数 $f(l,r)$。</p>
</blockquote>
<p>显然，$f(x,x) = 0 \; (x\neq 0),\; f(2l,2r) = 3f(l,r)$，若 $l$ 为奇数，那么 $f(l,r) = f(l+1,r) + 2(g(l,r)-g(l,l))-(l==0)$，若 $r$ 为奇数，那么 $f(l,r) = f(l,r-1) + 2(g(r-1,r)-g(r-1,l))-(r==1)$ 。其中 $g(x,n)$ 表示满足下式的 $y$ 的个数：</p>
<script type="math/tex; mode=display">
0 \leq y < n ,\; x+y = x \wedge y</script><p>通过比较 $x,n$ 的二进制，$g(x,n)$ 的计算是容易计算的的。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	function&lt;<span class="keyword">int</span>(<span class="keyword">int</span>,<span class="keyword">int</span>)&gt; g = [&amp;](<span class="keyword">int</span> x ,<span class="keyword">int</span> n)-&gt;<span class="keyword">int</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> ret = <span class="number">1</span>,zeros=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(n&amp;i)&#123;</span><br><span class="line">				n^=i;</span><br><span class="line">				<span class="keyword">if</span>(!(x&amp;n)) ret += <span class="number">1</span>&lt;&lt;zeros;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(!(x&amp;i)) ++zeros;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;;</span><br><span class="line">	function&lt;LL(<span class="keyword">int</span>,<span class="keyword">int</span>)&gt; f = [&amp;](<span class="keyword">int</span> l ,<span class="keyword">int</span> r)-&gt;LL&#123;</span><br><span class="line">		<span class="keyword">if</span>(l==r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		LL ret = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(l&amp;<span class="number">1</span>)&#123;</span><br><span class="line">			ret += (g(l,r)-g(l,l))*<span class="number">2</span>-(l==<span class="number">0</span>);</span><br><span class="line">			++l;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(r&amp;<span class="number">1</span>)&#123;</span><br><span class="line">			ret += (g(r<span class="number">-1</span>,r)-g(r<span class="number">-1</span>,l))*<span class="number">2</span>-(r==<span class="number">1</span>);</span><br><span class="line">			--r;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> ret + <span class="number">3</span>*f(l/<span class="number">2</span>,r/<span class="number">2</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="keyword">int</span> l,r;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;l&gt;&gt;r;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;f(l,r+<span class="number">1</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1373F：-f-x-表示非负整数-x-的十进制表示的各位数之和。求最小的非负整数-x-使得-sum-i-0-k-f-x-i-n"><a href="#1373F：-f-x-表示非负整数-x-的十进制表示的各位数之和。求最小的非负整数-x-使得-sum-i-0-k-f-x-i-n" class="headerlink" title="1373F：$f(x)$ 表示非负整数 $x$ 的十进制表示的各位数之和。求最小的非负整数 $x$ 使得 $\sum_{i=0} ^k f(x+i) = n$"></a><a href="https://codeforces.com/contest/1373/problem/E" target="_blank" rel="noopener">1373F</a>：$f(x)$ 表示非负整数 $x$ 的十进制表示的各位数之和。求最小的非负整数 $x$ 使得 $\sum_{i=0} ^k f(x+i) = n$</h3><p>由于 $0 \leq k \leq 9$，也就是说 $x,x+1,\cdots,x+k$，的个位数各不相同。我们可以枚举 $x$ 的个位数，那么 $x/10,\cdots, (x+k)/10$，最多仅有两种取值。若只有一种，即没有进位（不能为 9），那么直接就可以把 $x$ 的位数和求出来，否则 $x/10$ 的个数必为 9。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> LL inf = <span class="number">1e17</span>+<span class="number">2</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">auto</span> csum = [](<span class="keyword">int</span> a,<span class="keyword">int</span> b)&#123;</span><br><span class="line">		<span class="keyword">return</span> (a+b)*(b-a+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">auto</span> f = [](<span class="keyword">int</span> n)&#123;</span><br><span class="line">		LL r = <span class="number">0</span>,d = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span>(n&gt;<span class="number">9</span>)&#123;</span><br><span class="line">			r+=<span class="number">9</span>*d;</span><br><span class="line">			d*=<span class="number">10</span>;</span><br><span class="line">			n-=<span class="number">9</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> r+n*d;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">auto</span> g = [&amp;](<span class="keyword">int</span> a,<span class="keyword">int</span> k,<span class="keyword">int</span> n) -&gt; LL&#123;</span><br><span class="line">		LL r = <span class="number">0</span>,d = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(n&lt;a) <span class="keyword">return</span> inf;</span><br><span class="line">		<span class="keyword">while</span>((n-a)%k)&#123;</span><br><span class="line">			n-=<span class="number">9</span>*(k-a);</span><br><span class="line">			r+=d*<span class="number">9</span>;</span><br><span class="line">			d*=<span class="number">10</span>;</span><br><span class="line">			<span class="keyword">if</span>(n&lt;a) <span class="keyword">return</span> inf;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> r+d*(f((n-a)/k+<span class="number">1</span>)<span class="number">-1</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="keyword">int</span> n,k;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k;</span><br><span class="line">		<span class="keyword">if</span>(k==<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;f(n)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(k*(k<span class="number">-1</span>)/<span class="number">2</span> &gt; n)&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		LL r = inf;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">9</span>;++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(i+k&lt;=<span class="number">9</span>)&#123;</span><br><span class="line">				<span class="keyword">int</span> t = csum(i,i+k);</span><br><span class="line">				<span class="keyword">if</span>(n&gt;=t&amp;&amp;(n-t)%(k+<span class="number">1</span>)==<span class="number">0</span>) r = <span class="built_in">min</span>(r,<span class="number">10</span>*f((n-t)/(k+<span class="number">1</span>))+i);</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">int</span> t = csum(i,<span class="number">9</span>)+csum(<span class="number">0</span>,i+k<span class="number">-10</span>);</span><br><span class="line">				<span class="keyword">if</span>(n&gt;=t) r = <span class="built_in">min</span>(r,<span class="number">10</span>*g(i+k<span class="number">-9</span>,k+<span class="number">1</span>,n-t)+i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;(r==inf? <span class="number">-1</span>:r)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>以上代码按照时间顺序(2020/6/25——now)倒序，以下代码按照时间顺序(2020/5/22 —— 2020/6/25)排序</strong></p>
<h3 id="1355B-：贪心模仿加法进位"><a href="#1355B-：贪心模仿加法进位" class="headerlink" title="1355B ：贪心模仿加法进位"></a><a href="https://codeforces.com/contest/1355/problem/B" target="_blank" rel="noopener">1355B</a> ：贪心模仿加法进位</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getans</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>,x=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		x+=a[i];</span><br><span class="line">		ans+=x/i;</span><br><span class="line">		x%=i;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas,n,x;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">			++a[x];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;getans(n)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1354C-：计算包含单位正-n-边形的最小正方形的边长"><a href="#1354C-：计算包含单位正-n-边形的最小正方形的边长" class="headerlink" title="1354C  ：计算包含单位正 $n$ 边形的最小正方形的边长"></a><a href="https://codeforces.com/problemset/problem/1354/C2" target="_blank" rel="noopener">1354C</a>  ：计算包含单位正 $n$ 边形的最小正方形的边长</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas,n;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="built_in">cout</span>.precision(<span class="number">10</span>);</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">		<span class="keyword">if</span>(n&amp;<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">double</span> x = <span class="built_in">sqrt</span>(<span class="number">1</span>-<span class="built_in">cos</span>((n/<span class="number">2</span>)*pi/n));</span><br><span class="line">			<span class="keyword">double</span> y = <span class="built_in">sqrt</span>(<span class="number">1</span>-<span class="built_in">cos</span>((n/<span class="number">2</span>+<span class="number">1</span>)*pi/n));</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;(x+y)/<span class="number">2</span>/<span class="built_in">sin</span>(pi/<span class="number">2</span>/n)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;<span class="number">1.0</span>/<span class="built_in">tan</span>(pi/<span class="number">2</span>/n)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1354D-：模拟操作：-加数字或删除第-k-小的数"><a href="#1354D-：模拟操作：-加数字或删除第-k-小的数" class="headerlink" title="1354D ：模拟操作： 加数字或删除第 $k$ 小的数"></a><a href="https://codeforces.com/problemset/problem/1354/D" target="_blank" rel="noopener">1354D</a> ：模拟操作： 加数字或删除第 $k$ 小的数</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> s[N], Size;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> n &amp; (-n);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (id &lt;= Size) &#123;</span><br><span class="line">		s[id] += p;</span><br><span class="line">		id += lowbit(id);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (id) &#123;</span><br><span class="line">		r += s[id];</span><br><span class="line">		id -= lowbit(id);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> l = <span class="number">0</span>, r = Size;</span><br><span class="line">	<span class="keyword">while</span> (r&gt;l) &#123;</span><br><span class="line">		<span class="keyword">int</span> m = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span> (sum(m) &gt;= k) r = m;</span><br><span class="line">		<span class="keyword">else</span> l = m+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">	add(<span class="built_in">find</span>(k), <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> q, x;</span><br><span class="line">	<span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; Size &gt;&gt; q) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Size; ++i) s[i] = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= Size; ++i) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">			add(x, <span class="number">1</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (q--) &#123;</span><br><span class="line">			<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">			<span class="keyword">if</span> (x &gt; <span class="number">0</span>) add(x, <span class="number">1</span>);</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				del(-x);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> ans = <span class="built_in">find</span>(<span class="number">1</span>);</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt;(sum(ans)&gt;<span class="number">0</span>?ans:<span class="number">0</span>)&lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1354F-：经典-DP-问题"><a href="#1354F-：经典-DP-问题" class="headerlink" title="1354F ：经典 DP 问题"></a><a href="https://codeforces.com/problemset/problem/1354/F" target="_blank" rel="noopener">1354F</a> ：经典 DP 问题</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">102</span>;</span><br><span class="line"><span class="keyword">int</span> dp[N][N];</span><br><span class="line"><span class="keyword">bool</span> isin[N][N],chose[N];</span><br><span class="line"><span class="keyword">using</span> node = tuple&lt;<span class="keyword">int</span>,<span class="keyword">int</span>,<span class="keyword">int</span>&gt;;</span><br><span class="line">node q[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getans</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		dp[i][<span class="number">0</span>] = dp[i<span class="number">-1</span>][<span class="number">0</span>]+(k<span class="number">-1</span>)*<span class="built_in">get</span>&lt;<span class="number">2</span>&gt;(q[i]);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j&lt;i &amp;&amp; j&lt;=k;++j)&#123;</span><br><span class="line">			<span class="keyword">int</span> x = dp[i<span class="number">-1</span>][j]+(k<span class="number">-1</span>)*<span class="built_in">get</span>&lt;<span class="number">2</span>&gt;(q[i]);</span><br><span class="line">			<span class="keyword">int</span> y = dp[i<span class="number">-1</span>][j<span class="number">-1</span>]+(j<span class="number">-1</span>)*<span class="built_in">get</span>&lt;<span class="number">2</span>&gt;(q[i])+<span class="built_in">get</span>&lt;<span class="number">1</span>&gt;(q[i]);</span><br><span class="line">			<span class="keyword">if</span>(x&gt;y)&#123;</span><br><span class="line">				dp[i][j] = x;</span><br><span class="line">				isin[i][j] = <span class="literal">false</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				dp[i][j] = y;</span><br><span class="line">				isin[i][j] = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(i&lt;=k)&#123;</span><br><span class="line">			dp[i][i] = dp[i<span class="number">-1</span>][i<span class="number">-1</span>]+(i<span class="number">-1</span>)*<span class="built_in">get</span>&lt;<span class="number">2</span>&gt;(q[i])+<span class="built_in">get</span>&lt;<span class="number">1</span>&gt;(q[i]);</span><br><span class="line">			isin[i][i] = <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=n,j=k;i;--i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(isin[i][j])&#123;</span><br><span class="line">			chose[i]=<span class="literal">true</span>;</span><br><span class="line">			--j;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			chose[i]=<span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas,n,k,a,b;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b;</span><br><span class="line">			q[i] = &#123;i,a,b&#125;;</span><br><span class="line"> </span><br><span class="line">		&#125;</span><br><span class="line">		sort(q+<span class="number">1</span>,q+n+<span class="number">1</span>,[](<span class="keyword">const</span> node &amp; x, <span class="keyword">const</span> node &amp; y)&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">get</span>&lt;<span class="number">2</span>&gt;(x)&lt;<span class="built_in">get</span>&lt;<span class="number">2</span>&gt;(y);</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;(<span class="number">2</span>*n-k)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		getans(n,k);</span><br><span class="line">		<span class="keyword">int</span> last = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(chose[i])&#123;</span><br><span class="line">				<span class="keyword">if</span>(++last == k)&#123;</span><br><span class="line">					last = i;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">cout</span>&lt;&lt;<span class="built_in">get</span>&lt;<span class="number">0</span>&gt;(q[i])&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(!chose[i])  <span class="built_in">cout</span>&lt;&lt;<span class="built_in">get</span>&lt;<span class="number">0</span>&gt;(q[i])&lt;&lt;<span class="string">" "</span>&lt;&lt;-<span class="built_in">get</span>&lt;<span class="number">0</span>&gt;(q[i])&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="built_in">get</span>&lt;<span class="number">0</span>&gt;(q[last])&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1345F-：经典二分，利用二阶偏导（离散偏导，即增量）是常量"><a href="#1345F-：经典二分，利用二阶偏导（离散偏导，即增量）是常量" class="headerlink" title="1345F ：经典二分，利用二阶偏导（离散偏导，即增量）是常量"></a><a href="https://codeforces.com/problemset/problem/1345/F" target="_blank" rel="noopener">1345F</a> ：经典二分，利用二阶偏导（离散偏导，即增量）是常量</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	LL k,x;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k)&#123;</span><br><span class="line">		<span class="built_in">vector</span>&lt;LL&gt; q;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">			q.push_back(x);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">auto</span> <span class="built_in">get</span> = [](LL x ,LL mx)&#123;</span><br><span class="line">			LL l=<span class="number">0</span>,r=x<span class="number">-1</span>;</span><br><span class="line">			<span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">				LL m=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">				<span class="keyword">if</span>(x-m*(m+<span class="number">1</span>)*<span class="number">3</span> == mx)  <span class="keyword">return</span> make_pair(m,m+<span class="number">1</span>);</span><br><span class="line">				<span class="keyword">if</span>(x-m*(m+<span class="number">1</span>)*<span class="number">3</span> &gt; mx)  l = m+<span class="number">1</span>;</span><br><span class="line">				<span class="keyword">else</span>  r = m<span class="number">-1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> make_pair(l,l);</span><br><span class="line">		&#125;;</span><br><span class="line">		LL l = <span class="number">-3e18</span><span class="number">-3e8</span>, r = <span class="number">1e9</span>;</span><br><span class="line">		<span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">			LL m = (l+r)&gt;&gt;<span class="number">1</span>,x=<span class="number">0</span>,y=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;i:q)&#123;</span><br><span class="line">				<span class="keyword">auto</span> tmp = <span class="built_in">get</span>(i,m);</span><br><span class="line">				x+=tmp.first;</span><br><span class="line">				y+=tmp.second;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(x&gt;k) l = m+<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(y&lt;k) r = m<span class="number">-1</span>;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				y-=k;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;i:q)&#123;</span><br><span class="line">					<span class="keyword">auto</span> tmp = <span class="built_in">get</span>(i,m);</span><br><span class="line">					<span class="comment">//cout&lt;&lt;endl&lt;&lt;tmp.first&lt;&lt;" "&lt;&lt;tmp.second&lt;&lt;endl;;</span></span><br><span class="line">					<span class="keyword">if</span>(tmp.first&lt;tmp.second &amp;&amp; y--&gt;<span class="number">0</span>)&#123;</span><br><span class="line">						<span class="built_in">cout</span>&lt;&lt;tmp.first&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">					&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">						<span class="built_in">cout</span>&lt;&lt;tmp.second&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1325B：Set-的用法举例"><a href="#1325B：Set-的用法举例" class="headerlink" title="1325B：Set 的用法举例"></a><a href="https://codeforces.com/problemset/problem/1325/B" target="_blank" rel="noopener">1325B</a>：Set 的用法举例</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas,n,x;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">		<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">			q.insert(x);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;q.<span class="built_in">size</span>()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1325D：（异或）位运算：判断是否有-n-个数，异或和为-u-和为-v"><a href="#1325D：（异或）位运算：判断是否有-n-个数，异或和为-u-和为-v" class="headerlink" title="1325D：（异或）位运算：判断是否有 $n$ 个数，异或和为 $u$, 和为 $v$"></a><a href="https://codeforces.com/contest/1325/problem/D" target="_blank" rel="noopener">1325D</a>：（异或）位运算：判断是否有 $n$ 个数，异或和为 $u$, 和为 $v$</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	LL u,v;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;u&gt;&gt;v)&#123;</span><br><span class="line">		<span class="keyword">if</span>(u&gt;v||((v-u)&amp;<span class="number">1</span>))&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(u == v)&#123;</span><br><span class="line">			<span class="keyword">if</span>(u)  <span class="built_in">cout</span>&lt;&lt;<span class="number">1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;u&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			v = (v-u)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(u&amp;v) <span class="built_in">cout</span>&lt;&lt;<span class="number">3</span>&lt;&lt;<span class="built_in">endl</span>&lt;&lt;u&lt;&lt;<span class="string">" "</span>&lt;&lt;v&lt;&lt;<span class="string">" "</span>&lt;&lt;v&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">			<span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;<span class="number">2</span>&lt;&lt;<span class="built_in">endl</span>&lt;&lt;u+v&lt;&lt;<span class="string">" "</span>&lt;&lt;v&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意到 $a+b = a \wedge b + 2(a \&amp; b)$，并且 $(a \wedge b) \&amp; (a\&amp;b) = 0$ 当且仅当 $a b = 0$</p>
</blockquote>
<h3 id="1358D：给定区间最值问题，但是可以写的很漂亮"><a href="#1358D：给定区间最值问题，但是可以写的很漂亮" class="headerlink" title="1358D：给定区间最值问题，但是可以写的很漂亮"></a><a href="https://codeforces.com/problemset/problem/1358/D" target="_blank" rel="noopener">1358D</a>：给定区间最值问题，但是可以写的很漂亮</h3><blockquote>
<p>注意到区间最值一定在左或者右端点达到局部最大值（极值）</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span>+<span class="number">102</span>;</span><br><span class="line"><span class="keyword">int</span> n,n2;</span><br><span class="line">LL a[N],b[N],s[N];</span><br><span class="line"><span class="function">LL <span class="title">f</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> ((x+<span class="number">1</span>)*x)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">sumx</span><span class="params">(LL x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> it = lower_bound(b,b+n2,x) - b;</span><br><span class="line">    <span class="comment">// 这里注意是it, 比赛的时候没减，搞得怀疑人生</span></span><br><span class="line">	<span class="keyword">return</span> s[it<span class="number">-1</span>]+f(x-b[it<span class="number">-1</span>]); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	LL d;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;d;</span><br><span class="line">	n2=n&lt;&lt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">		a[i+n] = a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	b[<span class="number">0</span>] = a[<span class="number">0</span>];s[<span class="number">0</span>] = f(a[<span class="number">0</span>]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n2;++i)&#123;</span><br><span class="line">		b[i]=b[i<span class="number">-1</span>]+a[i];</span><br><span class="line">		s[i]=s[i<span class="number">-1</span>]+f(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	LL ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">		ans = <span class="built_in">max</span>(ans,sumx(b[i]+d<span class="number">-1</span>)-s[i]+a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&lt;n2;++i)&#123;</span><br><span class="line">		ans = <span class="built_in">max</span>(ans,s[i]-sumx(b[i]-d));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1358E：很有意思的数据处理题目，官方题解"><a href="#1358E：很有意思的数据处理题目，官方题解" class="headerlink" title="1358E：很有意思的数据处理题目，官方题解"></a><a href="https://codeforces.com/problemset/problem/1358/E" target="_blank" rel="noopener">1358E</a>：很有意思的数据处理题目，<a href="https://codeforces.com/blog/entry/77869" target="_blank" rel="noopener">官方题解</a></h3><blockquote>
<p>注意到如果 $k$ 满足答案，则 $2k$ 也满足，所以不妨设 $k&gt; \lfloor \frac{n}{2} \rfloor$，另一方面题目中要求若 $i&gt;  \lceil \frac{n}{2} \rceil$，则 $a_{i} = x$</p>
</blockquote>
 <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line">LL a[N],s[N],m[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="keyword">int</span> n2 = (n+<span class="number">1</span>)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n2;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">		s[i] = s[i<span class="number">-1</span>]+a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	LL x;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=n2+<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		a[i]=x;</span><br><span class="line">		s[i]=s[i<span class="number">-1</span>]+x;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n2;++i)&#123;</span><br><span class="line">		m[i+<span class="number">1</span>] = <span class="built_in">min</span>(m[i],x*i-s[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> k=n2;k&lt;=n;++k)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[k]+m[n-k+<span class="number">1</span>]&gt;<span class="number">0</span>)&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;k&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1359C-读题被坑…-反正就是倒冷热水接近给定温度）"><a href="#1359C-读题被坑…-反正就是倒冷热水接近给定温度）" class="headerlink" title="1359C:  读题被坑…(反正就是倒冷热水接近给定温度）"></a><a href="https://codeforces.com/contest/1359/problem/C" target="_blank" rel="noopener">1359C</a>:  读题被坑…(反正就是倒冷热水接近给定温度）</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="keyword">int</span> h,t,c;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;h&gt;&gt;c&gt;&gt;t;</span><br><span class="line">		h-=c;t-=c;</span><br><span class="line">		<span class="keyword">if</span>(h&gt;=<span class="number">2</span>*t)&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;<span class="number">2</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			LL n = (h-t)/(<span class="number">2</span>*t-h);</span><br><span class="line">			<span class="keyword">auto</span> f = [](LL n,<span class="keyword">int</span> h,<span class="keyword">int</span> t)&#123;</span><br><span class="line">				<span class="keyword">return</span> (n+<span class="number">1</span>)*(<span class="number">2</span>*n+<span class="number">3</span>)*h+(<span class="number">2</span>*n+<span class="number">1</span>)*(n+<span class="number">2</span>)*h&gt;(<span class="number">2</span>*n+<span class="number">1</span>)*(<span class="number">2</span>*n+<span class="number">3</span>)*t*<span class="number">2</span>;</span><br><span class="line">			&#125;;</span><br><span class="line">			<span class="keyword">if</span>(f(n,h,t)) ++n;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;<span class="number">2</span>*n+<span class="number">1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>然后对于奇数项，单调递减趋于平均问题，然后判断的时候转化成整数的判断</p>
</blockquote>
<h3 id="1359D：线段树，但是由于数据特殊，可以不用线段树"><a href="#1359D：线段树，但是由于数据特殊，可以不用线段树" class="headerlink" title="1359D：线段树，但是由于数据特殊，可以不用线段树"></a><a href="https://codeforces.com/contest/1359/problem/D" target="_blank" rel="noopener">1359D</a>：线段树，但是由于数据特殊，可以不用线段树</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">NULL</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> m=<span class="number">1</span>;m&lt;=<span class="number">30</span>;++m)&#123;</span><br><span class="line">		<span class="keyword">int</span> suml =<span class="number">0</span>,sum=<span class="number">0</span>,maxa = <span class="number">-31</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i]&gt;m)&#123;</span><br><span class="line">				sum = suml = <span class="number">0</span>;</span><br><span class="line">				maxa = <span class="number">-31</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				sum+=a[i];</span><br><span class="line">				<span class="comment">//这里取全局最大是因为，我们枚举了最大值的可能</span></span><br><span class="line">				maxa = <span class="built_in">max</span>(maxa,a[i]);</span><br><span class="line">				ans = <span class="built_in">max</span>(ans,sum-suml-maxa);</span><br><span class="line">				<span class="comment">//相当于前面是全0的部分删了！并且这样不会避免中间负的情况</span></span><br><span class="line">				suml = <span class="built_in">min</span>(sum,suml);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意到 $-30&lt;a_i&lt;30 $</p>
</blockquote>
<h3 id="1359E：找到公式后就是模素数组合数"><a href="#1359E：找到公式后就是模素数组合数" class="headerlink" title="1359E：找到公式后就是模素数组合数"></a><a href="https://codeforces.com/contest/1359/problem/E" target="_blank" rel="noopener">1359E</a>：找到公式后就是模素数组合数</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL=<span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line">LL inv[N],frac[N];</span><br><span class="line"><span class="function">LL <span class="title">powmod</span><span class="params">(LL x, LL n, LL p)</span> </span>&#123;</span><br><span class="line">	LL r=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(n) &#123;</span><br><span class="line">		<span class="keyword">if</span>(n&amp;<span class="number">1</span>) r=r*x%p;</span><br><span class="line">		n&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">		x=x*x%p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	frac[<span class="number">0</span>]=inv[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i)&#123;</span><br><span class="line">		frac[i] = frac[i<span class="number">-1</span>]*i%M;</span><br><span class="line">	&#125;</span><br><span class="line">	inv[N<span class="number">-1</span>] = powmod(frac[N<span class="number">-1</span>],M<span class="number">-2</span>,M);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=N<span class="number">-2</span>;i;--i)&#123;</span><br><span class="line">		inv[i] = inv[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%M;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">C</span><span class="params">(<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(n&lt;m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(n==m||m==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> frac[n]*inv[m]%M*inv[n-m]%M;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">NULL</span>);</span><br><span class="line">	<span class="keyword">int</span> n,k;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k;</span><br><span class="line">	init();</span><br><span class="line">	LL ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="keyword">int</span> x = n/i;</span><br><span class="line">		<span class="keyword">if</span>(x&lt;k) <span class="keyword">break</span>;</span><br><span class="line">		ans += C(x<span class="number">-1</span>,k<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans%M&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>先考虑$k=2$ 的情况知道 $a_1|a_2$，然后发现对于任意$k$，仅需 $a_1|a_i$ 即可。</p>
</blockquote>
<h3 id="1363E：有根数，互换子树的节点位数到预定值，dfs-和图存储范例"><a href="#1363E：有根数，互换子树的节点位数到预定值，dfs-和图存储范例" class="headerlink" title="1363E：有根数，互换子树的节点位数到预定值，dfs 和图存储范例"></a><a href="https://codeforces.com/contest/1363/problem/E" target="_blank" rel="noopener">1363E</a>：有根数，互换子树的节点位数到预定值，dfs 和图存储范例</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="comment">// head[u] 和 cnt 的初始值都为 -1</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"><span class="keyword">bool</span> b[N],c[N];</span><br><span class="line"></span><br><span class="line">tuple&lt;int,int,LL&gt; dfs(int u,int parent,int mn)&#123;</span><br><span class="line">	<span class="keyword">int</span> l=<span class="number">0</span>,r=<span class="number">0</span>;</span><br><span class="line">	LL cost=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span>(b[u]!=c[u])&#123;</span><br><span class="line">		<span class="keyword">if</span>(b[u]) ++l;</span><br><span class="line">		<span class="keyword">else</span> ++r;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;v:g[u])&#123;</span><br><span class="line">		<span class="keyword">if</span>(v == parent) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">auto</span> [sl,sr,scost] = dfs(v,u,<span class="built_in">min</span>(mn,a[u]));</span><br><span class="line">		l+=sl;r+=sr;cost+=scost;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(a[u]&lt;mn)&#123;</span><br><span class="line">		<span class="keyword">int</span> take = <span class="built_in">min</span>(l,r);</span><br><span class="line">		cost += LL(a[u])*(take*<span class="number">2</span>);</span><br><span class="line">		l -= take;</span><br><span class="line">		r -= take;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> &#123;l,r,cost&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n,u,v;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;a[i]&gt;&gt;b[i]&gt;&gt;c[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;u&gt;&gt;v;</span><br><span class="line">		g[u].push_back(v);</span><br><span class="line">		g[v].push_back(u);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">auto</span> [l,r,cost] = dfs(<span class="number">1</span>,<span class="number">0</span>,<span class="number">2e9</span>);</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;(l||r?<span class="number">-1</span>:cost)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>上面代码写得呢，就很优雅，哈哈！</p>
</blockquote>
<h3 id="1361E-：下面代码至今没过我也是没懂为什么"><a href="#1361E-：下面代码至今没过我也是没懂为什么" class="headerlink" title="1361E ：下面代码至今没过我也是没懂为什么"></a>1361E ：下面代码至今没过我也是没懂为什么</h3><blockquote>
<p>模仿进制的操作，最后用其他代码过的题。多设几个变量没坏处的其实。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line">LL a[N],p;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T,<span class="keyword">typename</span> U&gt;</span><br><span class="line"><span class="function">T <span class="title">powmod</span><span class="params">(T x,U n,T p)</span></span>&#123;</span><br><span class="line">	<span class="function">T <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">while</span>(n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n&amp;<span class="number">1</span>) r=r*x%p;</span><br><span class="line">		n&gt;&gt;=<span class="number">1</span>;  x=x*x%p;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas,n;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;p;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(p==<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;(n&amp;<span class="number">1</span>)&lt;&lt;<span class="built_in">endl</span>;<span class="keyword">continue</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		sort(a+<span class="number">1</span>,a+n+<span class="number">1</span>);</span><br><span class="line">		LL ans = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span>(n&gt;<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(ans==<span class="number">0</span>)&#123;</span><br><span class="line">				ans = <span class="number">1</span>;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">if</span>(a[n]==a[n<span class="number">-1</span>]) --ans;</span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					<span class="keyword">while</span>(a[n]&gt;a[n<span class="number">-1</span>])&#123;</span><br><span class="line">						ans*=p;</span><br><span class="line">						--a[n];</span><br><span class="line">						<span class="keyword">if</span>(ans&gt;n) <span class="keyword">break</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">if</span>(a[n]!=a[n<span class="number">-1</span>]) <span class="keyword">break</span>;</span><br><span class="line">					--ans;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			--n;</span><br><span class="line">		&#125;</span><br><span class="line">		ans = ans%M*powmod(p,a[n],M)%M;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</span><br><span class="line">			ans-=powmod(p,a[i],M);</span><br><span class="line">		&#125;</span><br><span class="line">		ans = (M+ans%M)%M;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1349F-：神奇的对应"><a href="#1349F-：神奇的对应" class="headerlink" title="1349F ：神奇的对应"></a><a href="https://codeforces.com/contest/1349/problem/F1" target="_blank" rel="noopener">1349F</a> ：神奇的对应</h3><p>我们称一个长度为 $n$ 的序列 $p$ 为<strong>好序列</strong>，如果对任意正整数$k&gt;1$，存在 $1 \leq i &lt; j \leq n$ 使得，$p_i = k-1, p_j = k$</p>
<p>存在 <strong>好序列</strong> 和长为 $n$ 的排列一一对应：</p>
<ul>
<li>给定排列 $a_1,a_2,\cdots, a_n$ ， 相邻两个之间添加 <code>&gt;</code> 或 <code>&lt;</code> ,那么 $p_{a_i}$ 就定义为 $a_1,\cdots,a_i$ 中 <code>&lt;</code> 个数加一</li>
<li>给定好序列 $p$，从右到左依次标记出 <code>1,2,...</code> ，直到标记完所有数即得到了排列</li>
</ul>
<p>因此 <strong>好序列</strong> 中最大值对应这排列中单调递减区间的个数！</p>
<blockquote>
<p>答案要求的是：所有好序列中出现 $k$ 的个数之和。</p>
</blockquote>
<p>代码下次再写吧…</p>
<h3 id="1365E：这题其实没啥，但是比赛的时候竟然把-想成了-，很烦"><a href="#1365E：这题其实没啥，但是比赛的时候竟然把-想成了-，很烦" class="headerlink" title="1365E：这题其实没啥，但是比赛的时候竟然把 | 想成了 ^ ，很烦"></a><a href="https://codeforces.com/problemset/problem/1365/E" target="_blank" rel="noopener">1365E</a>：这题其实没啥，但是比赛的时候竟然把 <code>|</code> 想成了 <code>^</code> ，很烦</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n)&#123;</span><br><span class="line">		LL a[n];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">		&#125;</span><br><span class="line">		sort(a,a+n,greater&lt;LL&gt;());</span><br><span class="line">		LL ans = a[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="number">2</span>*a[i]&lt;=a[<span class="number">0</span>]) <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;n;++j)&#123;</span><br><span class="line">				LL t = a[i]|a[j];</span><br><span class="line">				ans = <span class="built_in">max</span>(ans,t);</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> k=j+<span class="number">1</span>;k&lt;n;++k)&#123;</span><br><span class="line">					ans = <span class="built_in">max</span>(ans,t|a[k]);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1312D：计算满足条件的数列个数"><a href="#1312D：计算满足条件的数列个数" class="headerlink" title="1312D：计算满足条件的数列个数"></a><a href="https://codeforces.com/contest/1312/problem/D" target="_blank" rel="noopener">1312D</a>：计算满足条件的数列个数</h3><p>计算满足下列条件的数列个数：</p>
<ul>
<li>数列项数为 $n$，且每一项都是不超过 $m$ 的正整数，$2\cdot 10^5 =N&gt;m \geq n \geq 2$</li>
<li>数列中有且仅有两项是相同的</li>
<li>数列在 $i$ 项前严格单调递增，$i$ 项后严格单调递减</li>
</ul>
<p>我们枚举 $i$ 的位置和 $i$ 的值，以及相同的项，则显然有如下计算式</p>
<script type="math/tex; mode=display">
\sum_{i=2} ^ {n-1} \sum_{j=n-1} ^m {j-1 \choose 1} {j-2 \choose i-2} {j-i \choose n-i-1} = \sum_{i=2} ^{n-1} \frac{1}{(i-2)!(n-i-1)} \sum_{j=n-1}^m \frac{(j-1)!}{(j-n+1)!}</script><p>预处理一下阶乘和阶乘逆，我们就可以在 $O(N)$ 解决问题。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="function">LL <span class="title">powmod</span><span class="params">(LL a,LL n)</span></span>&#123;</span><br><span class="line">	<span class="function">LL <span class="title">r</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">while</span>(n)&#123;</span><br><span class="line">		<span class="keyword">if</span>(n&amp;<span class="number">1</span>) r=r*a%M;</span><br><span class="line">		n&gt;&gt;=<span class="number">1</span>;  a=a*a%M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line">LL fac[N],ifac[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	fac[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i!=N;++i)&#123;</span><br><span class="line">		fac[i] = fac[i<span class="number">-1</span>]*i%M;</span><br><span class="line">	&#125;</span><br><span class="line">	ifac[N<span class="number">-1</span>] = powmod(fac[N<span class="number">-1</span>],M<span class="number">-2</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=N<span class="number">-2</span>;~i;--i)&#123;</span><br><span class="line">		ifac[i] = ifac[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%M; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	init();</span><br><span class="line">	<span class="keyword">int</span> n,m;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m)&#123;</span><br><span class="line">		LL x=<span class="number">0</span>,y=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&lt;=m;++i)&#123;</span><br><span class="line">			x+=fac[i<span class="number">-1</span>]*ifac[i-n+<span class="number">1</span>]%M;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;n;++i)&#123;</span><br><span class="line">			y+=ifac[i<span class="number">-2</span>]*ifac[n-i<span class="number">-1</span>]%M;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;(x%M)*(y%M)%M&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>但是<a href="https://codeforces.com/blog/entry/74640" target="_blank" rel="noopener">官方题解</a>给了一个更简单的方法</p>
</blockquote>
<p>首先把 $n=2$ 时无解，所以考虑 $n&gt;2$ 的情况，首先把所有用到的数字选好：$m \choose n-1$，然后选择好相同的数字：$n-2$，然后剩下的非最大的数，要么放在最大的数左边要么放在最大的数右边：$2^{n-3}$，即最终答案是 ${m \choose n-1}(n-2)2^{n-3}$</p>
<h3 id="1312E：经典-DP，解释放在"><a href="#1312E：经典-DP，解释放在" class="headerlink" title="1312E：经典 DP，解释放在 "></a><a href="https://codeforces.com/contest/1312/problem/E" target="_blank" rel="noopener">1312E</a>：经典 DP，解释放在 <a href="/dynamicProgramming/" title="动态规划">动态规划</a></h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1022</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> ans[<span class="number">502</span>][N],b[<span class="number">502</span>][N];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n,x;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n)&#123;</span><br><span class="line">		<span class="built_in">memset</span>(ans,inf,<span class="keyword">sizeof</span>(ans));</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">		ans[<span class="number">0</span>][x] = <span class="number">1</span>;</span><br><span class="line">		b[<span class="number">0</span>][x]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;N;++j)&#123;</span><br><span class="line">				<span class="keyword">if</span>(ans[i<span class="number">-1</span>][j]!=inf)&#123;</span><br><span class="line">					ans[i][x] = <span class="built_in">min</span>(ans[i][x],ans[i<span class="number">-1</span>][j]+<span class="number">1</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				b[i][x]=i;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">int</span> s = i<span class="number">-1</span>;</span><br><span class="line">			<span class="keyword">while</span>(s&gt;=<span class="number">0</span>&amp;&amp;ans[s][x]!=inf)&#123;</span><br><span class="line">				ans[i][x+<span class="number">1</span>] = ans[s][x];</span><br><span class="line">				b[i][x+<span class="number">1</span>] = b[s][x];</span><br><span class="line">				s = b[s][x]<span class="number">-1</span>;</span><br><span class="line">				++x;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> r = inf;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;++i)&#123;</span><br><span class="line">			r = <span class="built_in">min</span>(r,ans[n<span class="number">-1</span>][i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;r&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1295E：题解，相当精彩的线段树实例"><a href="#1295E：题解，相当精彩的线段树实例" class="headerlink" title="1295E：题解，相当精彩的线段树实例"></a><a href="https://codeforces.com/contest/1295/problem/E" target="_blank" rel="noopener">1295E</a>：<a href="https://codeforces.com/blog/entry/73467" target="_blank" rel="noopener">题解</a>，相当精彩的线段树实例</h3><blockquote>
<p>下面代码取自：<a href="https://codeforces.com/profile/jiangly" target="_blank" rel="noopener">jiangly</a></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SegmentTree</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; <span class="built_in">min</span>, tag;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">long</span> <span class="keyword">long</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">min</span>[p] += v;</span><br><span class="line">        tag[p] += v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        add(<span class="number">2</span> * p, tag[p]);</span><br><span class="line">        add(<span class="number">2</span> * p + <span class="number">1</span>, tag[p]);</span><br><span class="line">        tag[p] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pull</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">min</span>[p] = <span class="built_in">std</span>::<span class="built_in">min</span>(<span class="built_in">min</span>[<span class="number">2</span> * p], <span class="built_in">min</span>[<span class="number">2</span> * p + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rangeAdd</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= y || r &lt;= x)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= x &amp;&amp; r &lt;= y)</span><br><span class="line">            <span class="keyword">return</span> add(p, v);</span><br><span class="line">        <span class="keyword">int</span> m = (l + r) / <span class="number">2</span>;</span><br><span class="line">        push(p);</span><br><span class="line">        rangeAdd(<span class="number">2</span> * p, l, m, x, y, v);</span><br><span class="line">        rangeAdd(<span class="number">2</span> * p + <span class="number">1</span>, m, r, x, y, v);</span><br><span class="line">        pull(p);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    SegmentTree(<span class="keyword">int</span> n) : n(n), <span class="built_in">min</span>(<span class="number">4</span> * n), tag(<span class="number">4</span> * n) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rangeAdd</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        rangeAdd(<span class="number">1</span>, <span class="number">0</span>, n, l, r, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">getMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p, a, pos;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    p.resize(n);</span><br><span class="line">    a.resize(n);</span><br><span class="line">    pos.resize(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; p[i];</span><br><span class="line">        --p[i];</span><br><span class="line">        pos[p[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    <span class="function">SegmentTree <span class="title">t</span><span class="params">(n - <span class="number">1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">        t.rangeAdd(pos[i], n - <span class="number">1</span>, a[pos[i]]);</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = t.getMin();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        t.rangeAdd(pos[i], n - <span class="number">1</span>, -a[pos[i]]);</span><br><span class="line">        t.rangeAdd(<span class="number">0</span>, pos[i], a[pos[i]]);</span><br><span class="line">        ans = <span class="built_in">std</span>::<span class="built_in">min</span>(ans, t.getMin());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1295F：给定区间的非降序列概率（个数）"><a href="#1295F：给定区间的非降序列概率（个数）" class="headerlink" title="1295F：给定区间的非降序列概率（个数）"></a><a href="https://codeforces.com/contest/1295/problem/F" target="_blank" rel="noopener">1295F</a>：给定区间的非降序列概率（个数）</h3><blockquote>
<p>下面代码取自：<a href="https://codeforces.com/profile/jiangly" target="_blank" rel="noopener">jiangly</a></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> P = <span class="number">998'244'353</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">power</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            res = <span class="number">1L</span>L * res * a % P;</span><br><span class="line">        a = <span class="number">1L</span>L * a * a % P;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; l, r, v, inv, dp;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; c;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    l.resize(n);</span><br><span class="line">    r.resize(n);</span><br><span class="line">    v.reserve(<span class="number">2</span> * n);</span><br><span class="line">    inv.resize(n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">        inv[i] = power(i, P - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">int</span> total = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; l[i] &gt;&gt; r[i];</span><br><span class="line">        ++r[i];</span><br><span class="line">        v.push_back(l[i]);</span><br><span class="line">        v.push_back(r[i]);</span><br><span class="line">        total = <span class="number">1L</span>L * total * (r[i] - l[i]) % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::sort(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>());</span><br><span class="line">    v.erase(<span class="built_in">std</span>::unique(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>()), v.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        l[i] = <span class="built_in">std</span>::lower_bound(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), l[i]) - v.<span class="built_in">begin</span>();</span><br><span class="line">        r[i] = <span class="built_in">std</span>::lower_bound(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>(), r[i]) - v.<span class="built_in">begin</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    c.assign(v.<span class="built_in">size</span>() - <span class="number">1</span>, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n + <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="keyword">int</span>(v.<span class="built_in">size</span>()) - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">        c[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j)</span><br><span class="line">            c[i][j] = <span class="number">1L</span>L * c[i][j - <span class="number">1</span>] * (j - <span class="number">1</span> + v[i + <span class="number">1</span>] - v[i]) % P * inv[j] % P;</span><br><span class="line">    &#125;</span><br><span class="line">    dp.resize(n + <span class="number">1</span>);</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="keyword">int</span>(v.<span class="built_in">size</span>()) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> a = n - <span class="number">1</span>; a &gt;= <span class="number">0</span>; --a) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> b = a; b &lt; n; ++b) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i &lt; l[b] || i &gt;= r[b])</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                dp[b + <span class="number">1</span>] = (dp[b + <span class="number">1</span>] + <span class="number">1L</span>L * dp[a] * c[i][b - a + <span class="number">1</span>]) % P;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="number">1L</span>L * dp[n] * power(total, P - <span class="number">2</span>) % P &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1364C：已知-a-i-MEX-b-1-cdots-b-i-为不出现在-b-1-cdots-b-i-中的最小非负整数，在给定-0-leq-a-i-leq-i-a-i-lt-a-i-1-的情况下，给出一种-b-i-的方案"><a href="#1364C：已知-a-i-MEX-b-1-cdots-b-i-为不出现在-b-1-cdots-b-i-中的最小非负整数，在给定-0-leq-a-i-leq-i-a-i-lt-a-i-1-的情况下，给出一种-b-i-的方案" class="headerlink" title="1364C：已知 $a_i=MEX({b_1,\cdots,b_i})$ 为不出现在 $b_1,\cdots,b_i$ 中的最小非负整数，在给定 $0\leq a_i \leq i,a_i&lt;a_{i+1}$ 的情况下，给出一种 $b_i$ 的方案"></a><a href="https://codeforces.com/contest/1364/problem/C" target="_blank" rel="noopener">1364C</a>：已知 $a_i=MEX({b_1,\cdots,b_i})$ 为不出现在 $b_1,\cdots,b_i$ 中的最小非负整数，在给定 $0\leq a_i \leq i,a_i&lt;a_{i+1}$ 的情况下，给出一种 $b_i$ 的方案</h3><p>方案就是：设当前最大值为 $n$，从尾部开始，先标 <code>a[i]</code> 的值被访问，然后看 <code>a[i]</code> 是否等于 <code>a[i-1]</code>，如果是就在没被访问的点中给一个最大给 <code>b[i]</code>，否则 $b[i]=a[i-1]$。然后边界判断！ <code>i=1</code> 时，当作不等处理。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="keyword">int</span> a[N],b[N];</span><br><span class="line"><span class="keyword">bool</span> v[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">int</span> ma = n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&gt;<span class="number">0</span>;--i)&#123;</span><br><span class="line">		v[a[i]]=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(i==<span class="number">1</span>||a[i]==a[i<span class="number">-1</span>])&#123;</span><br><span class="line">			<span class="keyword">while</span>(ma&gt;=<span class="number">0</span>&amp;&amp;v[ma]) --ma;</span><br><span class="line">			v[ma] = <span class="literal">true</span>;</span><br><span class="line">			b[i] = ma--;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			b[i]=a[i<span class="number">-1</span>];</span><br><span class="line">			v[b[i]]=<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;b[i]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://codeforc.com/contest/1353/problem/D" target="_blank" rel="noopener">1353D</a>：有趣的标准优先队列+BFS 题目</p>
<blockquote>
<p>初始值为 0 的长度为 n 的数组，每次在连续 0 中长度最大的那一段的中点编号，直到编完。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> l,r;</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Node &amp; A)<span class="keyword">const</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (r-l)&lt;(A.r-A.l)||((r-l)==(A.r-A.l)&amp;&amp;l&gt;A.l);</span><br><span class="line">	&#125;</span><br><span class="line">	Node(<span class="keyword">int</span> _l,<span class="keyword">int</span> _r)&#123;</span><br><span class="line">		l = _l;</span><br><span class="line">		r = _r;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		LL n;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">		<span class="keyword">int</span> a[n+<span class="number">1</span>];</span><br><span class="line">		priority_queue&lt;Node&gt; q;</span><br><span class="line">		q.push(&#123;<span class="number">1</span>,n&#125;);</span><br><span class="line">		<span class="keyword">int</span> now=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">			<span class="keyword">auto</span> u = q.top();</span><br><span class="line">			<span class="keyword">int</span> l=u.l,r=u.r;</span><br><span class="line">			q.pop();</span><br><span class="line">			a[(l+r)/<span class="number">2</span>] = ++now;</span><br><span class="line">			<span class="keyword">if</span>(l==r) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>((r-l)%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">				q.push(Node(l,(l+r)/<span class="number">2</span><span class="number">-1</span>));</span><br><span class="line">				q.push(Node((l+r)/<span class="number">2</span>+<span class="number">1</span>,r));</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				q.push(Node((l+r)/<span class="number">2</span>+<span class="number">1</span>,r));</span><br><span class="line">				<span class="keyword">if</span>(l&lt;(l+r)/<span class="number">2</span>) q.push(Node(l,(l+r)/<span class="number">2</span><span class="number">-1</span>));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;a[i]&lt;&lt;<span class="string">" \n"</span>[i==n];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://codeforc.com/contest/1353/problem/E" target="_blank" rel="noopener">1353E</a>：在 <code>01</code>序列中改变最小的位，使得其中的所有 <code>1</code> 都是连续的。</p>
<blockquote>
<p>设 <code>dp[i]</code> 为使得前 <code>i</code> 位中 1 连续出现，且第 <code>i</code> 位为 1 的最小改变位数，状态转移就显然了。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="keyword">int</span> n,k;</span><br><span class="line">		<span class="built_in">string</span> a;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k&gt;&gt;a;</span><br><span class="line">		<span class="keyword">auto</span> solve = [](<span class="keyword">const</span> <span class="built_in">string</span> &amp;s)&#123;</span><br><span class="line">			<span class="keyword">int</span> n = s.length();</span><br><span class="line">			<span class="keyword">int</span> all = count(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>(),<span class="string">'1'</span>);</span><br><span class="line">			<span class="keyword">int</span> s1=(s[<span class="number">0</span>]==<span class="string">'1'</span>);</span><br><span class="line">			<span class="keyword">int</span> ans = all-s1,res = <span class="number">1</span>-s1;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)&#123;</span><br><span class="line">				<span class="keyword">int</span> cur = (s[i]==<span class="string">'1'</span>);</span><br><span class="line">				s1+=cur;</span><br><span class="line">				res = <span class="number">1</span>-cur+<span class="built_in">min</span>(res,s1-cur);</span><br><span class="line">				ans = <span class="built_in">min</span>(ans,res+all-s1);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> all-ans;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">int</span> mx=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;++i)&#123;</span><br><span class="line">			<span class="built_in">string</span> s;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;n;j+=k)&#123;</span><br><span class="line">				s+=a[j];</span><br><span class="line">			&#125;</span><br><span class="line">			mx = <span class="built_in">max</span>(mx,solve(s));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;count(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>(),<span class="string">'1'</span>)-mx&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1367E：不难但是很有趣的数学题"><a href="#1367E：不难但是很有趣的数学题" class="headerlink" title="1367E：不难但是很有趣的数学题"></a><a href="https://codeforces.com/contest/1367/problem/E" target="_blank" rel="noopener">1367E</a>：不难但是很有趣的数学题</h3><blockquote>
<p>在给定一些元素中取出最大数量构成一个 k 旋转不变的圈</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="keyword">int</span> n,k;</span><br><span class="line">		<span class="built_in">string</span> s;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k&gt;&gt;s;</span><br><span class="line">		<span class="keyword">int</span> c[<span class="number">26</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;i:s) ++c[i-<span class="string">'a'</span>];</span><br><span class="line">		sort(c,c+<span class="number">26</span>,greater&lt;<span class="keyword">int</span>&gt;());</span><br><span class="line">		<span class="keyword">auto</span> check=[&amp;](<span class="keyword">int</span> m)&#123;</span><br><span class="line">			<span class="keyword">int</span> d = __gcd(m,k);</span><br><span class="line">			<span class="keyword">int</span> md = m/d;</span><br><span class="line">			<span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)&#123;</span><br><span class="line">				x+=c[i]/md;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span> x&gt;=d;</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">while</span>(!check(n)) --n;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;n&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1367F：给定规则最小步骤使得数列有序"><a href="#1367F：给定规则最小步骤使得数列有序" class="headerlink" title="1367F：给定规则最小步骤使得数列有序"></a><a href="https://codeforces.com/problemset/problem/1367/F1" target="_blank" rel="noopener">1367F</a>：给定规则最小步骤使得数列有序</h3><blockquote>
<p>只允许将数列中某一个数最前或者最后，问最少多少步使得数列有序。</p>
</blockquote>
<p>我们称数列中两个数 $a_i \leq a_j$是<strong>相接</strong>的，如果 $i&lt;j$ 且排好序后 $a_i,a_j$ 相邻。那么我们的答案就是 $n-$ 最长相接子列的长度。</p>
<p><strong>原因</strong>：首先它是一个可行的答案，其次答案的方案去掉数列中被移动的数，剩下的数必然是相接的！</p>
<blockquote>
<p>因为数列中的数的大小并不影响结果，影响结果的是相对关系，因此可以通过预处理，让数列的取值范围是一个区间。</p>
</blockquote>
<p>记 <code>dp[i]</code> 为以 $i$ 结尾的最长相接子列。状态转移是好写的。</p>
<p>如果数列中元素两两互异，会很简单，因为有相同元素的时候要考虑 <code>0 1 0 2</code> 这种数列。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> cas;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;cas;</span><br><span class="line">	<span class="keyword">while</span>(cas--)&#123;</span><br><span class="line">		<span class="keyword">int</span> n;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">		<span class="keyword">int</span> a[n],id[n];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) <span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">		iota(id,id+n,<span class="number">0</span>);</span><br><span class="line">		sort(id,id+n,[&amp;](<span class="keyword">int</span> &amp;i,<span class="keyword">int</span> &amp;j)&#123;</span><br><span class="line">			<span class="keyword">return</span> a[i]==a[j]?i&lt;j:a[i]&lt;a[j];</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			a[id[i]] = i;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">int</span> dp[n],ans=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i =<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			dp[i] = <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span>(a[i]&gt;<span class="number">0</span> &amp;&amp; id[a[i]<span class="number">-1</span>]&lt;i) dp[i] += dp[id[a[i]<span class="number">-1</span>]];</span><br><span class="line">			ans = <span class="built_in">max</span>(ans,dp[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;n-ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>否则，我们就要考虑 $i$ 之前 <code>a[i]</code> 严格小的相接元的 <code>dp</code> 最小值加上这些元的元素个数。</p>
<p>但是也可以直接求不用 DP 参考 <a href="https://codeforces.com/contest/1367/submission/83985710" target="_blank" rel="noopener">jiangly 的代码</a>，直接找包含第 $i$ 位最长的相接子列</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">constexpr</span> <span class="keyword">int</span> N = <span class="number">2e5</span>;</span><br><span class="line"><span class="keyword">int</span> a[N], p[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">    <span class="keyword">int</span> z;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; z;</span><br><span class="line">    <span class="keyword">while</span> (z--) &#123;</span><br><span class="line">        <span class="keyword">int</span> n;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">        <span class="built_in">std</span>::iota(p, p + n, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">std</span>::sort(p, p + n, [&amp;](<span class="keyword">int</span> i, <span class="keyword">int</span> j) &#123;<span class="keyword">return</span> a[i] &lt; a[j] || (a[i] == a[j] &amp;&amp; i &lt; j);&#125;);</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>, r; l &lt; n; l = r) &#123;</span><br><span class="line">            <span class="keyword">for</span> (r = l + <span class="number">1</span>; r &lt; n &amp;&amp; p[r] &gt; p[r - <span class="number">1</span>]; ++r)</span><br><span class="line">                ;</span><br><span class="line">            <span class="keyword">int</span> res = r - l;</span><br><span class="line">            <span class="keyword">if</span> (l)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = l - <span class="number">1</span>; i &gt;= <span class="number">0</span> &amp;&amp; a[p[i]] == a[p[l - <span class="number">1</span>]]; --i)</span><br><span class="line">                    <span class="keyword">if</span> (p[i] &lt; p[l])</span><br><span class="line">                        ++res;</span><br><span class="line">            <span class="keyword">if</span> (r &lt; n)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt; n &amp;&amp; a[p[i]] == a[p[r]]; ++i)</span><br><span class="line">                    <span class="keyword">if</span> (p[i] &gt; p[r - <span class="number">1</span>])</span><br><span class="line">                        ++res;</span><br><span class="line">            ans = <span class="built_in">std</span>::<span class="built_in">max</span>(ans, res);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>, m, r; l &lt; n; l = m) &#123;</span><br><span class="line">            <span class="keyword">for</span> (m = l; m &lt; n &amp;&amp; a[p[m]] == a[p[l]]; ++m)</span><br><span class="line">                ;</span><br><span class="line">            <span class="keyword">if</span> (m == n)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">for</span> (r = m; r &lt; n &amp;&amp; a[p[r]] == a[p[m]]; ++r)</span><br><span class="line">                ;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = l, j = m; i &lt; m; ++i) &#123;</span><br><span class="line">                <span class="keyword">while</span> (j &lt; r &amp;&amp; p[j] &lt; p[i])</span><br><span class="line">                    ++j;</span><br><span class="line">                ans = <span class="built_in">std</span>::<span class="built_in">max</span>(ans, i + <span class="number">1</span> - l + r - j);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; n - ans &lt;&lt; <span class="string">"\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1368B：简单的问题比赛的时候无语的想复杂了！然后就是参看-tourist-男神的优雅代码"><a href="#1368B：简单的问题比赛的时候无语的想复杂了！然后就是参看-tourist-男神的优雅代码" class="headerlink" title="1368B：简单的问题比赛的时候无语的想复杂了！然后就是参看 tourist 男神的优雅代码"></a><a href="https://codeforces.com/contest/1368/problem/B" target="_blank" rel="noopener">1368B</a>：简单的问题比赛的时候无语的想复杂了！然后就是参看 tourist 男神的优雅代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *    author:  tourist</span></span><br><span class="line"><span class="comment"> *    created: 18.06.2020 17:46:48       </span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">  <span class="built_in">cin</span>.tie(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">long</span> <span class="keyword">long</span> k;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; k;</span><br><span class="line">  <span class="built_in">string</span> s = <span class="string">"codeforces"</span>;</span><br><span class="line">  <span class="keyword">int</span> n = (<span class="keyword">int</span>) s.<span class="built_in">size</span>();</span><br><span class="line">  <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; <span class="title">a</span><span class="params">(n, <span class="number">1</span>)</span></span>;</span><br><span class="line">  <span class="keyword">long</span> <span class="keyword">long</span> prod = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> it = <span class="number">0</span>; prod &lt; k; it = (it + <span class="number">1</span>) % n) &#123;</span><br><span class="line">    prod = prod / a[it] * (a[it] + <span class="number">1</span>);</span><br><span class="line">    ++a[it];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; a[i]; j++) &#123;</span><br><span class="line">      <span class="built_in">cout</span> &lt;&lt; s[i];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1368D：一眼看出！哎要不是-B-题被卡了，我决定能上大分！好气"><a href="#1368D：一眼看出！哎要不是-B-题被卡了，我决定能上大分！好气" class="headerlink" title="1368D：一眼看出！哎要不是 B 题被卡了，我决定能上大分！好气"></a><a href="https://codeforces.com/contest/1368/problem/D" target="_blank" rel="noopener">1368D</a>：一眼看出！哎要不是 B 题被卡了，我决定能上大分！好气</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n)&#123;</span><br><span class="line">		<span class="keyword">int</span> a[<span class="number">20</span>]=&#123;<span class="number">0</span>&#125;,x;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">			<span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">while</span>(x)&#123;</span><br><span class="line">				<span class="keyword">if</span>(x&amp;<span class="number">1</span>) ++a[j];</span><br><span class="line">				x&gt;&gt;=<span class="number">1</span>; ++j;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		LL r=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			LL t = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">1</span>;i&lt;<span class="number">20</span>;++i,j&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">				<span class="keyword">if</span>(a[i])&#123;</span><br><span class="line">					t+=j;</span><br><span class="line">					--a[i];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			r+=t*t;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;r&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1285D：比赛的时候想到了，但是怕复杂度过补了，能过复杂度是因为每个元素-a-最多递归-log-a-次"><a href="#1285D：比赛的时候想到了，但是怕复杂度过补了，能过复杂度是因为每个元素-a-最多递归-log-a-次" class="headerlink" title="1285D：比赛的时候想到了，但是怕复杂度过补了，能过复杂度是因为每个元素 $a$ 最多递归 $\log a$ 次"></a><a href="https://codeforces.com/contest/1285/problem/D" target="_blank" rel="noopener">1285D</a>：比赛的时候想到了，但是怕复杂度过补了，能过复杂度是因为每个元素 $a$ 最多递归 $\log a$ 次</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function">LL <span class="title">solve</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;a,<span class="keyword">int</span> <span class="built_in">bit</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="built_in">bit</span>&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; l,r;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:a)&#123;</span><br><span class="line">		<span class="keyword">if</span>((x&gt;&gt;<span class="built_in">bit</span>)&amp;<span class="number">1</span>) l.push_back(x);</span><br><span class="line">		<span class="keyword">else</span> r.push_back(x);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(l.<span class="built_in">size</span>()==<span class="number">0</span>) <span class="keyword">return</span> solve(r,<span class="built_in">bit</span><span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">if</span>(r.<span class="built_in">size</span>()==<span class="number">0</span>) <span class="keyword">return</span> solve(l,<span class="built_in">bit</span><span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">min</span>(solve(l,<span class="built_in">bit</span><span class="number">-1</span>),solve(r,<span class="built_in">bit</span><span class="number">-1</span>))+(<span class="number">1</span>&lt;&lt;<span class="built_in">bit</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n)&#123;</span><br><span class="line">		<span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:a) <span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;solve(a,<span class="number">30</span>)&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1285C：找出使得-max-a-b-最小并使得-lcm-a-b-x-的最小-a-b"><a href="#1285C：找出使得-max-a-b-最小并使得-lcm-a-b-x-的最小-a-b" class="headerlink" title="1285C：找出使得$\max(a,b)$最小并使得$lcm(a,b)=x$的最小$a,b$"></a><a href="https://codeforces.com/contest/1285/problem/C" target="_blank" rel="noopener">1285C</a>：找出使得$\max(a,b)$最小并使得$lcm(a,b)=x$的最小$a,b$</h3><blockquote>
<p>将 $x$ 分解素因子可知，$\max(a,b)$ 最小的前提是，$\gcd(a,b)=1$，又因为 $x$ 的因子个数不超过$2\sqrt{x}$，搞定</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	LL n;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n)&#123;</span><br><span class="line">		LL r = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(LL i=<span class="number">1</span>;i*i&lt;=n;++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(n%i==<span class="number">0</span>&amp;&amp;__gcd(i,n/i)==<span class="number">1</span>)&#123;</span><br><span class="line">				r=i;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;r&lt;&lt;<span class="string">" "</span>&lt;&lt;n/r&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>本来不想写这个题，但是由于下题都是 <code>lcm</code> 问题，又是同一场，所以就记录一下</p>
<h3 id="1285F：一道很秀的-lcm-题，计算-displaystyle-max-1-leq-i-lt-j-leq-n-lcm-a-i-a-j"><a href="#1285F：一道很秀的-lcm-题，计算-displaystyle-max-1-leq-i-lt-j-leq-n-lcm-a-i-a-j" class="headerlink" title="1285F：一道很秀的 lcm 题，计算 $\displaystyle \max_{1\leq i&lt; j \leq n} lcm(a_i,a_j)$"></a><a href="https://codeforces.com/contest/1285/problem/F" target="_blank" rel="noopener">1285F</a>：一道很秀的 lcm 题，计算 $\displaystyle \max_{1\leq i&lt; j \leq n} lcm(a_i,a_j)$</h3><blockquote>
<p>参考这里：<a href="https://www.xht37.com/codeforces-round-613-div-2-题解/#Classical" target="_blank" rel="noopener">https://www.xht37.com/codeforces-round-613-div-2-%E9%A2%98%E8%A7%A3/#Classical</a></p>
</blockquote>
<p>通过加入 $a_i$ 的所有因子，我们可以改成计算 $\displaystyle \max_{\gcd(a_i,a_j)=1} a_ia_j$，我们将 $a_i$ 从大到小排序，然后开始遍历，用堆 s 保存之前的内容，注意到，如果堆 s 中有一个元素 t，跟当前需要遍历的元素 $a_i$ 互素，那么小于 s 中小于 $t$ 的元素讲不再能为结果做贡献。因此可以踢出栈中，现在问题是我们如何快速的记录<strong>堆 $s$ 中是否有与$a_i$ 互素的元素</strong>。记 $c_i$ 为堆中是 $i$ 的倍数的元素个数，那么堆中和$x$互素的个数为 $cop = \sum_{d|x} \mu(d) c_d$，这是因为包容排斥原理，首先所有数都是 1 的倍数，然后减去和 $x$ 的最小公约数为素数的，在加上和 $x$ 的最小公约数为两个素数相乘…。若 $cop$ 不为 0，那么就一个个的剔除，剔除的时候可以计算一下乘积（虽然不一定互素，但是不会影响的最终结果）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span>+<span class="number">2</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n)&#123;</span><br><span class="line">		<span class="keyword">bool</span> a[N]=&#123;&#125;;</span><br><span class="line">		<span class="keyword">int</span> mx=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,x;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">			a[x]=<span class="number">1</span>;</span><br><span class="line">			mx = <span class="built_in">max</span>(mx,x);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; p[mx+<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">int</span> mu[mx+<span class="number">1</span>]=&#123;&#125;,c[mx+<span class="number">1</span>]=&#123;&#125;;</span><br><span class="line">		mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=mx;++i)&#123;</span><br><span class="line">			p[i].push_back(i);</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">2</span>*i;j&lt;=mx;j+=i)&#123;</span><br><span class="line">				p[j].push_back(i);</span><br><span class="line">				a[i]|=a[j];</span><br><span class="line">				mu[j]-=mu[i];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line">		LL ans = mx;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=mx;i;--i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i])&#123;</span><br><span class="line">				<span class="keyword">int</span> cop = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:p[i]) cop+=mu[x]*c[x];</span><br><span class="line">				<span class="keyword">while</span>(cop)&#123;</span><br><span class="line">					<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:p[s.top()])&#123;</span><br><span class="line">						--c[x];</span><br><span class="line">						<span class="keyword">if</span>(i%x==<span class="number">0</span>) cop-=mu[x];</span><br><span class="line">					&#125;</span><br><span class="line">					ans = <span class="built_in">max</span>(ans,LL(i)*s.top());</span><br><span class="line">					s.pop();</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:p[i]) ++c[x];</span><br><span class="line">				s.push(i);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1370D：在长为-n-的序列中找一个长为-k-的子列，子列中奇数项最大值和偶数项最大值的最小值最小"><a href="#1370D：在长为-n-的序列中找一个长为-k-的子列，子列中奇数项最大值和偶数项最大值的最小值最小" class="headerlink" title="1370D：在长为 n 的序列中找一个长为 k 的子列，子列中奇数项最大值和偶数项最大值的最小值最小"></a><a href="https://codeforces.com/contest/1370/problem/D" target="_blank" rel="noopener">1370D</a>：在长为 n 的序列中找一个长为 k 的子列，子列中奇数项最大值和偶数项最大值的最小值最小</h3><blockquote>
<p>比赛的时候，我很快就知可以二分查找答案，但是顾前不顾尾，下面代码没过，因为当最后一个数正好是满足 <code>a[i]&lt;=m</code> 时答案就不行了！<strong>应该按照原来的逻辑去叠加啊！</strong></p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 此代码是错误代码！</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n,k;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k;</span><br><span class="line">	<span class="keyword">int</span> a[n],r=<span class="number">0</span>,l=<span class="number">1e9</span>+<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;a[i];</span><br><span class="line">		r = <span class="built_in">max</span>(r,a[i]);</span><br><span class="line">		l = <span class="built_in">min</span>(l,a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">auto</span> f = [&amp;](<span class="keyword">int</span> m)&#123;</span><br><span class="line">		<span class="keyword">int</span> now = <span class="number">-2</span>,s=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=k%<span class="number">2</span>;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i]&lt;=m)&#123;</span><br><span class="line">				<span class="keyword">if</span>(i&gt;now+<span class="number">1</span>)&#123;</span><br><span class="line">					++s;</span><br><span class="line">					now = i;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> s&gt;=k/<span class="number">2</span>;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">		<span class="keyword">int</span> m = (l+r)/<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span>(f(m)) r=m<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">else</span> l=m+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;l&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面是修正的代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n,k;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;k;</span><br><span class="line">	<span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:a) <span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">	<span class="keyword">auto</span> g = [&amp;](<span class="keyword">int</span> m,<span class="keyword">bool</span> cur)&#123;</span><br><span class="line">		<span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">			<span class="keyword">if</span>(cur)&#123;</span><br><span class="line">				cur = !cur;</span><br><span class="line">				++s;</span><br><span class="line">			&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">if</span>(a[i]&lt;=m)&#123;</span><br><span class="line">					++s;</span><br><span class="line">					cur = !cur;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> s&gt;=k;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> l = *min_element(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">	<span class="keyword">int</span> r = *max_element(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br><span class="line">   	<span class="comment">//auto lr = minmax_element(a.begin(),a.end());</span></span><br><span class="line">	<span class="comment">//int l = *lr.first,r = *lr.second;</span></span><br><span class="line">	<span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">		<span class="keyword">int</span> m = (l+r)/<span class="number">2</span>;</span><br><span class="line">		<span class="keyword">if</span>(g(m,<span class="number">0</span>)||g(m,<span class="number">1</span>)) r=m<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">else</span> l=m+<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;l&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1370E：找出最少的轮换使得字符串-s-变成-t"><a href="#1370E：找出最少的轮换使得字符串-s-变成-t" class="headerlink" title="1370E：找出最少的轮换使得字符串 s 变成 t"></a><a href="https://codeforces.com/contest/1370/problem/E" target="_blank" rel="noopener">1370E</a>：找出最少的轮换使得字符串 s 变成 t</h3><p>我一开始知道是贪心，然后我以为 <strong>是找到其中最长的连续 0 或者 1</strong>，然后发现并不是！！！</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 此代码是错误代码！</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">string</span> a,b;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;a&gt;&gt;b;</span><br><span class="line">	<span class="keyword">int</span> ab=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:a) <span class="keyword">if</span>(x==<span class="string">'1'</span>) ++ab;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:b) <span class="keyword">if</span>(x==<span class="string">'1'</span>) --ab;</span><br><span class="line">	<span class="keyword">if</span>(ab)&#123;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="built_in">endl</span>;<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">string</span> s;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i]!=b[i]) s.push_back(a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	s+=s;</span><br><span class="line">	<span class="comment">//cout&lt;&lt;s&lt;&lt;endl;</span></span><br><span class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,t;i&lt;s.<span class="built_in">size</span>();++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>((i == <span class="number">0</span>)||(s[i]!=s[i<span class="number">-1</span>])) t=<span class="number">0</span>;</span><br><span class="line">		ans = <span class="built_in">max</span>(ans,++t);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后看了<a href="https://codeforces.com/blog/entry/79107" target="_blank" rel="noopener">官方题解</a>！</p>
<p>在有解的前提下，我们可以构造取值在 $\{-1,0,1\}$ 的数组 $a$： if  $s_i = t_i,a_i = 0$，else if $s_i = 1,a_i=1$ else $a_i=-1$。因此答案就是</p>
<script type="math/tex; mode=display">
\max _{1 \leq l \leq r \leq n} |\sum_{i=l} ^r  a_i| = max(\max _{1 \leq l \leq r \leq n} \sum_{i=l} ^r  a_i,\max _{1 \leq l \leq r \leq n} \sum_{i=l} ^r  -a_i)</script><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">string</span> s,t;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;s&gt;&gt;t;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(s[i]==t[i]) <span class="keyword">continue</span>;</span><br><span class="line">		a.emplace_back(s[i]==<span class="string">'1'</span>?<span class="number">1</span>:<span class="number">-1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(accumulate(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>(),<span class="number">0</span>))&#123;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">auto</span> f = [&amp;](<span class="keyword">int</span> sign)&#123;</span><br><span class="line">		<span class="keyword">int</span> mx = <span class="number">0</span>,cur=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:a)&#123;</span><br><span class="line">			cur += sign*x;</span><br><span class="line">			mx = <span class="built_in">max</span>(mx,cur);</span><br><span class="line">			cur = <span class="built_in">max</span>(cur,<span class="number">0</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> mx;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="built_in">max</span>(f(<span class="number">1</span>),f(<span class="number">-1</span>))&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1263D：Set-lt-int-gt-集合操作范例"><a href="#1263D：Set-lt-int-gt-集合操作范例" class="headerlink" title="1263D：Set&lt;int&gt; 集合操作范例"></a><a href="https://codeforces.com/problemset/problem/1263/D" target="_blank" rel="noopener">1263D</a>：<code>Set&lt;int&gt;</code> 集合操作范例</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin)</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; a[<span class="number">26</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">		<span class="built_in">string</span> s;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;s;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;c:s) a[c-<span class="string">'a'</span>].insert(i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">set</span>&lt;<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line">	<span class="keyword">int</span> x=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(a[x].<span class="built_in">size</span>()==<span class="number">0</span>) ++x;</span><br><span class="line">	q.insert(a[x]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=x+<span class="number">1</span>;i&lt;<span class="number">26</span>;++i)&#123;</span><br><span class="line">		<span class="keyword">if</span>(a[i].<span class="built_in">size</span>()==<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">set</span>&lt;<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;&gt; p;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">auto</span> &amp;x:q)&#123;</span><br><span class="line">			<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; t;</span><br><span class="line">			set_intersection(x.<span class="built_in">begin</span>(),x.<span class="built_in">end</span>(),a[i].<span class="built_in">begin</span>(),a[i].<span class="built_in">end</span>(),inserter(t, t.<span class="built_in">begin</span>()));</span><br><span class="line">			<span class="keyword">if</span>(t.<span class="built_in">size</span>())&#123;</span><br><span class="line">				set_union(x.<span class="built_in">begin</span>(),x.<span class="built_in">end</span>(),a[i].<span class="built_in">begin</span>(),a[i].<span class="built_in">end</span>(),inserter(t, t.<span class="built_in">begin</span>()));</span><br><span class="line">				a[i] = t;</span><br><span class="line">				p.insert(x);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">set</span>&lt;<span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;&gt; t;</span><br><span class="line">		set_difference(q.<span class="built_in">begin</span>(),q.<span class="built_in">end</span>(),p.<span class="built_in">begin</span>(),p.<span class="built_in">end</span>(),inserter(t, t.<span class="built_in">begin</span>()));</span><br><span class="line">		t.insert(a[i]);</span><br><span class="line">		q = t;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;q.<span class="built_in">size</span>()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1369D-组合计数问题"><a href="#1369D-组合计数问题" class="headerlink" title="1369D:  组合计数问题"></a><a href="https://codeforces.com/contest/1369/problem/D" target="_blank" rel="noopener">1369D</a>:  组合计数问题</h3><blockquote>
<p>题解写在官方的 <a href="https://codeforces.com/blog/entry/79235#comment-648996" target="_blank" rel="noopener">教程里面</a>，代码也不想 copy 过来了。</p>
</blockquote>
<p>补充一个更好的生成函数的做法：已知 $a_n$，满足 $a_n = a_{n-1} + 2 a_{n-2} + (n \% 3==0?4:0)$，$a_0 = a_1= a_2 = 0$，计算$a_n$。</p>
<p>设 $f(x) = \sum_{n=0} ^ {\infty} a_n x^n$，则我们有</p>
<script type="math/tex; mode=display">
f(x) = \sum_{n=0} ^ {\infty} (a_{n-1} + 2 a_{n-2} ) x^n + \sum_{n=1} ^ {\infty} 4x^{3n} = xf(x) + x^2f(x) + 4 \sum_{n=1} ^ {\infty} x^{3n}</script><p>所以</p>
<script type="math/tex; mode=display">
f(x) = \frac{4 \sum_{n=1} ^ {\infty} x^{3n}}{(1-2x)(1+x)}</script><p>由于 $\frac{1}{1-x} = \sum_{n=0}^{\infty} x^n$，所以 $\frac{1}{(1-2x)(1+x)} = \frac{2}{3(1-2x)} + \frac{1}{3(1+x)} = \sum_{n=0}^{\infty} \frac{2^{n+1}+(-1)^n}{3}x^n$（推荐），$\frac{1}{(1-2x)(1+x)} = \sum_{n=0}^{\infty} (2x)^n \sum_{n=0}^{\infty}(-x)^n = \sum_{n=0}^{\infty} \frac{2^{n+1}+(-1)^n}{3}x^n$（不推荐），因此</p>
<script type="math/tex; mode=display">
f(x) = \frac{4}{3} \sum_{n=0} ^ \infty (\frac{2^{n \% 3 +1} (8^{n/3}-1)}{8-1} + \frac{(-1)^{n \% 3 +1} ((-1)^{n/3}-1)}{-1-1}) x^n</script><h3 id="1369F：博弈题"><a href="#1369F：博弈题" class="headerlink" title="1369F：博弈题"></a><a href="https://codtforcts.com/conttst/1369/probltm/F" target="_blank" rel="noopener">1369F</a>：博弈题</h3><blockquote>
<p>给定两个正整数 $s \leq t$，$A,B$ 两人依次玩游戏，每次可以从$s$变成 $s+1$ 或 $2s$，谁先严格大于 $t$，谁输了。</p>
<p>现在给你一堆的 $s_i,t_i$，$A,B$ 两人依次玩游戏，每一局输了的人作为下一局开始的人。问 $A$ 能否最后一局必赢，能否最后一局必输</p>
</blockquote>
<p>先考虑单个 $s,t$ 的情况。</p>
<p>用$f(s,t)$ 分别表示$A$ 是否有必胜策略。</p>
<ul>
<li>$t$ 为奇数，若 $s$ 为偶数，那么 $A$ 就让它变成 $s+1$，那么无论 $B$ 如何操作只能变成偶数，所以此时 $f(s,t) = 1$，若 $s$ 为奇数，显然若 $B$ 用 $A$ 刚刚的策略，则 $A$ 输，$f(s,t) = 0$。</li>
<li>$t$ 为偶数，若 $2s&gt;t$，此时只能做加法，$f(s,t) = s \mod 2$，若 $4s&gt;t \geq 2s$，此时 $f(s,t)=1$ ，因为总可以变成 $f(2s,t)=0$。若 $4s \leq t$，若 $f(s,\lfloor \frac{t}{4} \rfloor) = 1$, 则 $A$ 必有策略到达区间 $(\lfloor \frac{t}{4} \rfloor,2\lfloor \frac{t}{4} \rfloor)$ 的某一点，从而 $f(s,t)=1$, 同理若 $f(s,\lfloor \frac{t}{4} \rfloor) = 0$，则 $B$ 有 $A$ 的策略，从而 $f(s,t)=0$ （<strong>比赛的时候能想出来的人是真的虎</strong>) 。</li>
</ul>
<p>用 $g(s,t)$ 分别表示 $A$ 是否有必输的策略：若 $2s&gt;t$，则 $g(s,t)=1$，同理，若 $2s \leq t$，$f(s,\lfloor \frac{t}{2} \rfloor)=1$，则必有策略使得 $B$ 到达 $(\lfloor \frac{t}{2} \rfloor,2\lfloor \frac{t}{2} \rfloor)$ 的某一点，所以 $g(s,t) = f(s,\lfloor \frac{t}{2} \rfloor)$</p>
<p>有了这两个函数后，我们就可以从后往前依次来决定最后能否有必胜或必输的决策。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin)</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	function&lt;<span class="keyword">bool</span>(LL,LL)&gt; f = [&amp;](LL s,LL t)-&gt;<span class="keyword">bool</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(t%<span class="number">2</span>==<span class="number">1</span>) <span class="keyword">return</span> s%<span class="number">2</span>==<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="number">2</span>*s&gt;t) <span class="keyword">return</span> s%<span class="number">2</span>==<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="number">4</span>*s&gt;t) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">return</span> f(s,t/<span class="number">4</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	function&lt;<span class="keyword">bool</span>(LL,LL)&gt; g = [&amp;](LL s,LL t)-&gt;<span class="keyword">bool</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="number">2</span>*s&gt;t) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">return</span> f(s,t/<span class="number">2</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="keyword">bool</span> win=<span class="number">0</span>,lose=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)&#123;</span><br><span class="line">		LL s,t;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;s&gt;&gt;t;</span><br><span class="line">		<span class="keyword">if</span>(win^lose==<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span>(lose)&#123;</span><br><span class="line">			win = f(s,t);</span><br><span class="line">			lose = g(s,t);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			win = !f(s,t);</span><br><span class="line">			lose = !g(s,t);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;win&lt;&lt;<span class="string">" "</span>&lt;&lt;lose&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>我们可以认为一开始仅有必输策略所以让$A$先选，然后如果$A$原来有必胜且有必败策略，这后面必然一直有，若没有必胜也没有必败策略，则后面也是。所以只用考虑仅有其中之一的情形。</p>
</blockquote>
<h2 id="300iq-Contest-3"><a href="#300iq-Contest-3" class="headerlink" title="300iq Contest 3"></a><a href="https://codeforces.com/gym/102538/" target="_blank" rel="noopener">300iq Contest 3</a></h2><blockquote>
<p>罗列一下自己有兴趣的题目，<a href="300iqContest3.pdf">官方题解</a></p>
</blockquote>
<h3 id="A-Airplane-Cliques"><a href="#A-Airplane-Cliques" class="headerlink" title="A. Airplane Cliques"></a>A. Airplane Cliques</h3><p>题意：给定 $n$ 个节点的树，称两个节点是友好的，如果它们相连的边数不超过 $x$，问对任意 $1 \leq k \leq n$，有多少个元素个数为 $k$ 的集合，它们的点之间两两友好。其中 $1 \leq n \leq 300,000, 0 \leq x &lt; n$，最终答案对 998244353 取模</p>
<blockquote>
<p>看别人代码 200 多行，下次吧。</p>
</blockquote>
<h3 id="C-Cells-Blocking"><a href="#C-Cells-Blocking" class="headerlink" title="C. Cells Blocking"></a>C. Cells Blocking</h3><p>题意：从 <code>(1, 1)</code> 到 <code>(n, m)</code> 只能往右或往下走格子，然后有些格子是不能走的，让你将 2 个能走的格子变得不能走，最后使得格子 <code>(1, 1)</code> 无法到达 <code>(n, m)</code>，问有多少种变的方式。 $1 \leq m, n \leq 3000$</p>
<p>做法，首先从任意点看它是否可以到 <code>(n, m)</code>，再看任意点是否可从 <code>(1, 1)</code> 到。然后就可以选择最下和最上的两个路径，显然路径重叠的点被移除的时候 <code>(1, 1)</code> 就无法到达 <code>(n, m)</code>（如果一开始就无法到达，答案自然就是 $\text{nm} \choose 2$, nm 表示可以走的格子数)，然后最下的路径不重叠的点，必然可以必须需要删去其中的一个，删除之后再让它走最下的路径，看它与最上路径的交点，交点个数就是可选点的个数。（一个小技巧就是一开始重叠的点标记一下，不再考虑，这样就不会重复计数了）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> n, m;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">string</span>&gt; <span class="title">s</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> nm = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : s) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">		nm += <span class="built_in">std</span>::count(x.<span class="built_in">begin</span>(), x.<span class="built_in">end</span>(), <span class="string">'.'</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">a</span><span class="params">(n, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(m))</span></span>;</span><br><span class="line">	<span class="keyword">auto</span> b = a;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">queue</span>&lt;pii&gt; Q;</span><br><span class="line">	<span class="keyword">if</span> (s[n - <span class="number">1</span>][m - <span class="number">1</span>] == <span class="string">'.'</span>) &#123;</span><br><span class="line">		Q.push(&#123;n - <span class="number">1</span>, m - <span class="number">1</span>&#125;);</span><br><span class="line">		b[n - <span class="number">1</span>][m - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (!Q.empty()) &#123;</span><br><span class="line">		<span class="keyword">auto</span> [x, y] = Q.front();</span><br><span class="line">		Q.pop();</span><br><span class="line">		<span class="keyword">if</span> (x &gt; <span class="number">0</span> &amp;&amp; s[x - <span class="number">1</span>][y] == <span class="string">'.'</span> &amp;&amp; b[x - <span class="number">1</span>][y] == <span class="number">0</span>) &#123;</span><br><span class="line">			Q.push(&#123;x - <span class="number">1</span>, y&#125;);</span><br><span class="line">			b[x - <span class="number">1</span>][y] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (y &gt; <span class="number">0</span> &amp;&amp; s[x][y - <span class="number">1</span>] == <span class="string">'.'</span> &amp;&amp; b[x][y - <span class="number">1</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">			Q.push(&#123;x, y - <span class="number">1</span>&#125;);</span><br><span class="line">			b[x][y - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (b[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="built_in">print</span>(<span class="number">1l</span>l * nm * (nm - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (s[<span class="number">0</span>][<span class="number">0</span>] == <span class="string">'.'</span>) &#123;</span><br><span class="line">		Q.push(&#123;<span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">		a[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (!Q.empty()) &#123;</span><br><span class="line">		<span class="keyword">auto</span> [x, y] = Q.front();</span><br><span class="line">		Q.pop();</span><br><span class="line">		<span class="keyword">if</span> (x + <span class="number">1</span> &lt; n &amp;&amp; s[x + <span class="number">1</span>][y] == <span class="string">'.'</span> &amp;&amp; a[x + <span class="number">1</span>][y] == <span class="number">0</span>) &#123;</span><br><span class="line">			Q.push(&#123;x + <span class="number">1</span>, y&#125;);</span><br><span class="line">			a[x + <span class="number">1</span>][y] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (y + <span class="number">1</span> &lt; m &amp;&amp; s[x][y + <span class="number">1</span>] == <span class="string">'.'</span> &amp;&amp; a[x][y + <span class="number">1</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">			Q.push(&#123;x, y + <span class="number">1</span>&#125;);</span><br><span class="line">			a[x][y + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;pii&gt; leftRoad, rightRoad;</span><br><span class="line">	leftRoad.push_back(&#123;<span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">	<span class="keyword">while</span> (leftRoad.back() != <span class="built_in">std</span>::make_pair(n - <span class="number">1</span>, m - <span class="number">1</span>)) &#123;</span><br><span class="line">		<span class="keyword">auto</span> [x, y] = leftRoad.back();</span><br><span class="line">		<span class="keyword">if</span> (x + <span class="number">1</span> &lt; n &amp;&amp; b[x + <span class="number">1</span>][y]) leftRoad.push_back(&#123;x + <span class="number">1</span>, y&#125;);</span><br><span class="line">		<span class="keyword">else</span> leftRoad.push_back(&#123;x, y + <span class="number">1</span>&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	rightRoad.push_back(&#123;<span class="number">0</span>, <span class="number">0</span>&#125;);</span><br><span class="line">	<span class="keyword">while</span> (rightRoad.back() != <span class="built_in">std</span>::make_pair(n - <span class="number">1</span>, m - <span class="number">1</span>)) &#123;</span><br><span class="line">		<span class="keyword">auto</span> [x, y] = rightRoad.back();</span><br><span class="line">		<span class="keyword">if</span> (y + <span class="number">1</span> &lt; m &amp;&amp; b[x][y + <span class="number">1</span>]) rightRoad.push_back(&#123;x, y + <span class="number">1</span>&#125;);</span><br><span class="line">		<span class="keyword">else</span> rightRoad.push_back(&#123;x + <span class="number">1</span>, y&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">cnt</span><span class="params">(n + m - <span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="keyword">int</span> nm1 = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i != rightRoad.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">		<span class="keyword">if</span> (leftRoad[i] == rightRoad[i]) ++nm1;</span><br><span class="line">		<span class="keyword">else</span> cnt[i] = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	LL r = <span class="number">1l</span>l * nm1 * (nm - nm1) + <span class="number">1l</span>l * nm1 * (nm1 - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">	<span class="keyword">auto</span> f = [&amp;](pii p) &#123;</span><br><span class="line">		<span class="keyword">auto</span> [x, y] = p;</span><br><span class="line">		<span class="keyword">int</span> r = cnt[x + y] * (rightRoad[x + y] == p);</span><br><span class="line">		<span class="keyword">while</span> (x + y) &#123;</span><br><span class="line">			<span class="keyword">if</span> (y &gt; <span class="number">0</span> &amp;&amp; a[x][y - <span class="number">1</span>]) &#123;</span><br><span class="line">				r += cnt[x + y - <span class="number">1</span>] * (rightRoad[x + y - <span class="number">1</span>] == <span class="built_in">std</span>::make_pair(x, y - <span class="number">1</span>));</span><br><span class="line">				--y;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				r += cnt[x - <span class="number">1</span> + y] * (rightRoad[x - <span class="number">1</span> + y] == <span class="built_in">std</span>::make_pair(x - <span class="number">1</span>, y));</span><br><span class="line">				--x;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		x = p.first; y = p.second;</span><br><span class="line">		<span class="keyword">while</span> (x + y &lt; n + m - <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span> ((x + <span class="number">1</span> &lt; n) &amp;&amp; b[x + <span class="number">1</span>][y]) &#123;</span><br><span class="line">				r += cnt[x + <span class="number">1</span> + y] * (rightRoad[x + <span class="number">1</span> + y] == <span class="built_in">std</span>::make_pair(x + <span class="number">1</span>, y));</span><br><span class="line">				++x;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				r += cnt[x + y + <span class="number">1</span>] * (rightRoad[x + y + <span class="number">1</span>] == <span class="built_in">std</span>::make_pair(x, y + <span class="number">1</span>));</span><br><span class="line">				++y;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n + m - <span class="number">1</span>; ++i) <span class="keyword">if</span>(leftRoad[i] != rightRoad[i]) &#123;</span><br><span class="line">		<span class="keyword">auto</span> [x, y] = leftRoad[i];</span><br><span class="line">		--x; ++y;</span><br><span class="line">		<span class="keyword">while</span> (a[x][y] == <span class="number">0</span> || b[x][y] == <span class="number">0</span>) &#123;</span><br><span class="line">			--x; ++y;</span><br><span class="line">		&#125;</span><br><span class="line">		r += f(&#123;x, y&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(r);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="E-Easy-Win"><a href="#E-Easy-Win" class="headerlink" title="E. Easy Win"></a>E. Easy Win</h3><blockquote>
<p>SG 函数-博弈问题</p>
</blockquote>
<p>题意：有 $n$ 堆石子 $(a_1, \cdots, a_n)$（$a_i \leq n$），每次最少选 1 个，最多选 $x$ 个，最后谁没法选谁输，问对于所有的 $1 \leq x \leq n$，先手赢还是先手输。其中 $1 \leq n \leq 500,000$</p>
<p>首先，对每一个具体的 $x$ 答案是 $f(x) = (a_1 \mod x + 1) \oplus \cdots \oplus (a_n \mod x + 1)$ 是否为 0. 原因可参考之前的博文： <a href="/nimSgFunction/" title="SG 函数之取石子博弈">SG 函数之取石子博弈</a></p>
<p>为了优化时间复杂度，我们逐位计算 $f(x)$（即 计算 $f(x) \And 2^{j}$ 的值），首先我们对 $a_i$ 去重，用 $c_i = |\{t | a_t = i \}|$，令 $y = x + 1$。所以此时 $f(x) \And 2^{j} = \sum_{i = 1}^n c[i] (i \mod y) \mod 2 \cdot 2^{j}$<br>我们将 $[0, n]$ 分成 $[0, y), [y, 2y), \cdots, [ky, n]$，注意到若 $ky \leq a_i &lt; (k + 1) y$，那么 $a_i \equiv a_i - ky \mod y$，如果对于每个区间我们在预处理的前提下，能在 $O(1)$ 时间复杂度计算出每个区间的值，那么我们就能在 $O(n \log^2 n)$ 解决此问题。注意到区间 $[ky, (k+1)y)$ 对答案的贡献是：那些满足 $ky \leq t &lt; (k+1)y$，且 $t - ky$ 包含 j 位的那些 $c_t$ 的和。我们定义 $\displaystyle f_{i, j} = \sum_{x \geq i, (x - i) \And (2^j) \neq 0} c_x$，那么由于 $(x - i) \And 2^{j} \neq 0$ 等价于 $(x - i \pm 2^{j+1} \neq 0)$。所以有状态转移：</p>
<script type="math/tex; mode=display">
f_{i, j} = f_{i + 2^{j + 1}} + \sum_{t = i + 2^{j}}^{i + 2 ^{j + 1} - 1} c_t</script><p>然后区间 $[ky, (k+1)y)$ 对答案的贡献就是 $f_{ky, j} - f_{t, j} - \sum_{i = \min((k + 1)y, t - 2^{j})}^{t - 1} c_i$，其中 $t = ky + \lfloor \frac{y}{2^{j + 1}} \rfloor$ 是不小于 $(k + 1) y$ 且与 $ky$ 模 $2^{j + 1}$ 次数最小的值。后面那个求和是因为那部分的和中 $i - ky$ 必然有 $j$ 位。搞定！</p>
<blockquote>
<p>下面代码并不完全和上面解释一致，是因为我们值关心每一个位置是否为 0，用加减不方便，直接异或就行，也就是说其实下面很多 <code>int</code> 都可以换成 <code>bool</code>，不过 <code>std::vector&lt;bool&gt;</code> 不是 bool 型的向量，用起来不方便就没这么做了。</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	std::vector&lt;int&gt; c(n + 1), s(n + 1);</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, x; i &lt; n; ++i) &#123;</span><br><span class="line">		<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">		c[x] ^= <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	s[n] = c[n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) s[i] = s[i + <span class="number">1</span>] ^ c[i];</span><br><span class="line">	<span class="keyword">auto</span> sum = [&amp;](<span class="keyword">int</span> x) &#123;</span><br><span class="line">		<span class="keyword">return</span> x &gt; n ? <span class="number">0</span> : s[x];</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">r</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> <span class="built_in">bit</span> = <span class="number">0</span>; (<span class="number">1</span> &lt;&lt; <span class="built_in">bit</span>) &lt;= n; ++<span class="built_in">bit</span>) &#123;</span><br><span class="line">		<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">f</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">		<span class="keyword">auto</span> fum = [&amp;](<span class="keyword">int</span> x) &#123;</span><br><span class="line">			<span class="keyword">return</span> x &gt; n ? <span class="number">0</span> : f[x];</span><br><span class="line">		&#125;;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">			f[i] = fum(i + (<span class="number">2</span> &lt;&lt; <span class="built_in">bit</span>)) ^ sum(i + (<span class="number">1</span> &lt;&lt; <span class="built_in">bit</span>)) ^ sum(i + (<span class="number">2</span> &lt;&lt; <span class="built_in">bit</span>));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>, y = <span class="number">2</span>; x &lt; n; ++x, ++y) <span class="keyword">if</span> (r[x] == <span class="number">0</span> &amp;&amp; y &gt; (<span class="number">1</span> &lt;&lt; <span class="built_in">bit</span>)) &#123;</span><br><span class="line">			<span class="keyword">int</span> sy = <span class="number">0</span>, <span class="built_in">step</span> = (y + (<span class="number">2</span> &lt;&lt; <span class="built_in">bit</span>) - <span class="number">1</span>) &gt;&gt; <span class="built_in">bit</span> + <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k * y &lt;= n; ++k) &#123;</span><br><span class="line">				<span class="keyword">int</span> t = k * y + (<span class="built_in">step</span> &lt;&lt; <span class="built_in">bit</span> + <span class="number">1</span>);</span><br><span class="line">				sy ^= f[k * y] ^ fum(t) ^ sum(<span class="built_in">std</span>::<span class="built_in">max</span>((k + <span class="number">1</span>) * y, t - (<span class="number">1</span> &lt;&lt; <span class="built_in">bit</span>))) ^ sum(t);</span><br><span class="line">			&#125;</span><br><span class="line">			r[x] |= sy;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> x : r) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; (x ? <span class="string">"Alice "</span> : <span class="string">"Bob "</span>);</span><br><span class="line">	<span class="built_in">println</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="I-Ignore-Submasks"><a href="#I-Ignore-Submasks" class="headerlink" title="I. Ignore Submasks"></a>I. Ignore Submasks</h3><blockquote>
<p>本场最简单的一题</p>
</blockquote>
<p>题意：给定序列 $a_1, \cdots, a_n$ （$0 \leq a_i &lt; 2^k$），记 $f(x)$ 为使得 $a_i \And x \neq a_i$ 的最小的 $i$，如果没有就为 0，求 $\sum_{i = 0}^{2^k - 1} f(i)$，对答案取模 998244353，其中 $1 \leq n \leq 100, 1 \leq k \leq 60$</p>
<p>做法：相当于一开始有 $k$ 个位是自由的，假设当前还有 $r$ 个位是自由的，$a_i$ 占有其中 c 个自由位，然后其它的自由位随便取，所以它对结果的贡献就是 $(2^r - 1) \cdot 2^{k - r} \cdot i$，注意 $k \leq 60$，很多地方记得加 <code>ll</code>。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> watch(x) std::cout &lt;&lt; (#x) &lt;&lt; <span class="meta-string">" is "</span> &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> print(x) std::cout &lt;&lt; (x) &lt;&lt; std::endl</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> println std::cout &lt;&lt; std::endl</span></span><br><span class="line"><span class="keyword">using</span> LL = <span class="keyword">long</span> <span class="keyword">long</span>;</span><br><span class="line"><span class="keyword">using</span> pii = <span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;;</span><br><span class="line"><span class="keyword">using</span> pll = <span class="built_in">std</span>::pair&lt;LL, LL&gt;;</span><br><span class="line"><span class="keyword">const</span> LL M = <span class="number">998244353</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="comment">//freopen("in","r",stdin);</span></span><br><span class="line">	<span class="built_in">std</span>::ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span>.tie(<span class="literal">nullptr</span>);</span><br><span class="line">	<span class="keyword">int</span> n, k;</span><br><span class="line">	<span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;LL&gt; <span class="title">a</span><span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> &amp;x : a) <span class="built_in">std</span>::<span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">	<span class="function"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt; <span class="title">v</span><span class="params">(k, <span class="literal">true</span>)</span></span>;</span><br><span class="line">	LL r = <span class="number">0</span>, id = <span class="number">0</span>, rest = k;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> x : a) &#123;</span><br><span class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">			<span class="keyword">if</span> ((x &amp; (<span class="number">1l</span>l &lt;&lt; i)) &amp;&amp; v[i]) &#123;</span><br><span class="line">				v[i] = <span class="literal">false</span>;</span><br><span class="line">				++cnt;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		r += ((<span class="number">1l</span>l &lt;&lt; cnt) - <span class="number">1</span>) % M * ((<span class="number">1l</span>l &lt;&lt; (rest -= cnt)) % M) % M * (++id) % M;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(r % M);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="补充和强化知识"><a href="#补充和强化知识" class="headerlink" title="补充和强化知识"></a>补充和强化知识</h2><ul>
<li>需要补充：图论</li>
<li>需要强化：二分法，动态规划，代码能力，找公式速度，读题速度。</li>
<li>需要模板：高斯消元法 C++ 版。</li>
<li>水题刷题速度太慢！（题刷少了，每天一套 Codeforces since 2020/6/8）</li>
<li>不细心坑自己，让自己不自信！</li>
<li>系统的学习了一下 STL，总结出好用的部分！（2020/6/21）<a href="/templateOfCpp/" title="放在 C++模板博文中">放在 C++模板博文中</a> </li>
<li><code>vector&lt;bool&gt;</code> 不是容器！</li>
<li><strong>用指法敲代码</strong></li>
<li><strong>急需各种图论算法好用的模板: 看 Jiangly 的代码找模板？</strong></li>
</ul>
<blockquote>
<p>在 <a href="https://oi-wiki.org/" target="_blank" rel="noopener">OI-wiki</a> 复习和学习算法，在 <a href="https://codeforces.com" target="_blank" rel="noopener">codeforces</a> 训练算法和编程能力。</p>
</blockquote>
<h2 id="图论"><a href="#图论" class="headerlink" title="图论"></a>图论</h2><h3 id="图的存储"><a href="#图的存储" class="headerlink" title="图的存储"></a>图的存储</h3><ul>
<li>直接 tuple 类型数组直接存边，vector 类型直接 <code>push_back</code> 貌似不错啊！（见上面 1363E 的例子）</li>
<li>邻接矩阵（只能用于无重边的图）</li>
<li>链式前向星（推荐，优雅）</li>
</ul>
<p>前两种都很基础，我们一般用 <strong>链式前向星</strong> 来存储，<a href="https://oi-wiki.org/graph/save/" target="_blank" rel="noopener">oi-wiki 上的例子</a></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// head[u] 和 cnt 的初始值都为 -1</span></span><br><span class="line"><span class="keyword">int</span> head[N],to[M]</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">	nxt[++cnt] = head[u];  <span class="comment">// 当前边的后继</span></span><br><span class="line">	head[u] = cnt;         <span class="comment">// 起点 u 的第一条边</span></span><br><span class="line">	to[cnt] = v;           <span class="comment">// 当前边的终点</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历 u 的出边</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = head[u]; ~i; i = nxt[i]) &#123;  <span class="comment">// ~i 表示 i != -1</span></span><br><span class="line">	<span class="keyword">int</span> v = to[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是，自从我会 C++17 后，我们可以这么写（优雅）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N =<span class="number">1e5</span>;   <span class="comment">// 顶点数</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">1e6</span>;  <span class="comment">// 边数，在树中是 2*(n-1)</span></span><br><span class="line"><span class="comment">// head[u] 和 cnt 的初始值都为 -1</span></span><br><span class="line"><span class="keyword">int</span> head[N],cnt,nxt[M];</span><br><span class="line">tuple&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; edge[M];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">	cnt = <span class="number">-1</span>;</span><br><span class="line">	<span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">	nxt[++cnt] = head[u];</span><br><span class="line">	head[u] = cnt;</span><br><span class="line">	edge[cnt] = &#123;v,w&#125;; <span class="comment">// 也可以存入u但没必要</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 遍历 u 的出边</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">vis</span><span class="params">(<span class="keyword">int</span> u)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = head[u];~i;i=nxt[i]) &#123;</span><br><span class="line">		<span class="keyword">auto</span> [v,w] = edge[i];</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;u&lt;&lt;<span class="string">" "</span>&lt;&lt;v&lt;&lt;<span class="string">" "</span>&lt;&lt;w&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>存双向边时 <code>i ^ 1</code> 即是 <code>i</code> 的反边。</p>
</blockquote>
<h3 id="DFS（深度优先搜索）"><a href="#DFS（深度优先搜索）" class="headerlink" title="DFS（深度优先搜索）"></a>DFS（深度优先搜索）</h3><p>递归的调用自己，要用到 <strong>栈</strong></p>
<p>在 Windows 上，通常的方法是在 <strong>编译选项</strong> 中加入 <code>-Wl,--stack=1000000000</code> </p>
<p>在 Linux 上，通常的方法是在运行程序前 <strong>在终端内</strong> 执行 <code>ulimit -s unlimited</code> （WSL 下无法设置可惜）</p>
<h3 id="BFS（广度优先搜索）"><a href="#BFS（广度优先搜索）" class="headerlink" title="BFS（广度优先搜索）"></a>BFS（广度优先搜索）</h3><p>用 <code>queue</code> 保存节点，先进先出。队列为空。</p>
<p>用 <code>priority_queue</code> 保存节点，可用于优化 Dijkstra 算法。</p>
<h3 id="无根树的-Prufer-序列"><a href="#无根树的-Prufer-序列" class="headerlink" title="无根树的 Prufer 序列"></a>无根树的 Prufer 序列</h3><blockquote>
<p>$n$ 个节点的无根树和长度为 $n-2$，数值在 $1 \to n$ 的序列有一一对应</p>
<p>构造方式：删除编号最小的叶子节点，并记录它的父节点。</p>
</blockquote>
<p>之前在<a href="/catWithPy/" title="猫咪状态数">猫咪状态数</a> 中有记录过，代码可以见 <a href="https://oi-wiki.org/graph/prufer/" target="_blank" rel="noopener">这里</a></p>
<h3 id="有根树的-Euler-序列"><a href="#有根树的-Euler-序列" class="headerlink" title="有根树的 Euler 序列"></a>有根树的 Euler 序列</h3><p>通过 DFS，可以把一个有根树转化成长度为 $2n-1$，数值在 $1 \to n$ 的序列。</p>
<h3 id="最近公共祖先简称-LCA（Lowest-Common-Ancestor）"><a href="#最近公共祖先简称-LCA（Lowest-Common-Ancestor）" class="headerlink" title="最近公共祖先简称 LCA（Lowest Common Ancestor）"></a>最近公共祖先简称 LCA（Lowest Common Ancestor）</h3><ul>
<li>策略 1：其中一个节点一直往上标记父辈到根，然后另一个节点往上找父辈，直到找到首次被标记过的节点</li>
<li>策略 2：标记没个节点的深度，深度高的往上到同一层，然后一起一步步上去，直到是公共节点</li>
<li>策略 3：做一次 DFS 得到 Euler 序列，然后就变成找区间最小值问题了（可以使用线段树）</li>
<li>其他：倍增（记录 <code>fa[u][i]</code>：表示 <code>u</code> 的第$2^i$祖先），Tarjan 算法，动态树</li>
</ul>
<h3 id="有向图的拓扑排序之-Kahn-算法"><a href="#有向图的拓扑排序之-Kahn-算法" class="headerlink" title="有向图的拓扑排序之 Kahn 算法"></a>有向图的拓扑排序之 Kahn 算法</h3><p>给定有向图，然后把节点按照顺序排列，使得任意有向边的起点在终点前。</p>
<p>做法：维护一个入度为 0 的节点集合，一次删除节点（加入拓扑序列），删除的时候它连接的所有点入度减 1，为 0 就加入节点集合。</p>
<blockquote>
<p>一个有向图是无环图，当且仅当它存在拓扑排序。</p>
</blockquote>
<h3 id="有向图最小生成树的-Kruskal-算法（更推荐）"><a href="#有向图最小生成树的-Kruskal-算法（更推荐）" class="headerlink" title="有向图最小生成树的 Kruskal 算法（更推荐）"></a>有向图最小生成树的 Kruskal 算法（更推荐）</h3><p>把边排序，每次加入最短边，如果加入不构成环，就加入，否则不加。</p>
<p>需要（带路径压缩）并查集维护。</p>
<h3 id="（有向图）最小生成树的-Prim-算法"><a href="#（有向图）最小生成树的-Prim-算法" class="headerlink" title="（有向图）最小生成树的 Prim 算法"></a>（有向图）最小生成树的 Prim 算法</h3><p>讲节点分为两类：已加入和未加入。每次从未加入的节点中找一个和已知节点最近的边，然后加入该节点，连接这条边。(初始加入节点任意)</p>
<h3 id="（有向图）的次小生成树（下次一定）"><a href="#（有向图）的次小生成树（下次一定）" class="headerlink" title="（有向图）的次小生成树（下次一定）"></a>（有向图）的次小生成树（下次一定）</h3><h3 id="最小树形图（有向图的最小生成树）的-朱刘算法"><a href="#最小树形图（有向图的最小生成树）的-朱刘算法" class="headerlink" title="最小树形图（有向图的最小生成树）的 朱刘算法"></a>最小树形图（有向图的最小生成树）的 <a href="https://blog.csdn.net/dajiangyou123456/article/details/105137781?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase" target="_blank" rel="noopener">朱刘算法</a></h3><ol>
<li>找入度为 0 的 root 节点（唯一，否则不存在最小树形图）</li>
<li>除了 root 节点外，找出每个点的最小入边</li>
<li>检测是否有环，有环则缩点，更新新节点的距离</li>
<li>重复上述过程</li>
</ol>
<h3 id="强连通分量的-Kosaraju-算法"><a href="#强连通分量的-Kosaraju-算法" class="headerlink" title="强连通分量的 Kosaraju 算法"></a><a href="https://oi-wiki.org/graph/scc/#_3" target="_blank" rel="noopener">强连通分量的 Kosaraju 算法</a></h3><p>Kosaraju 算法依靠两次简单的 DFS 实现。</p>
<p>第一次 DFS，选取任意顶点作为起点，遍历所有未访问过的顶点，并在回溯之前给顶点编号，也就是后序遍历。</p>
<p>第二次 DFS，对于反向后的图，以标号最大的顶点作为起点开始 DFS。这样遍历到的顶点集合就是一个强连通分量。对于所有未访问过的结点，选取标号最大的，重复上述过程。</p>
<p>两次 DFS 结束后，强连通分量就找出来了，Kosaraju 算法的时间复杂度为 $O(m+n)$。</p>
<p>实现</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// g 是原图，g2 是反图</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">  vis[u] = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> v : g[u])</span><br><span class="line">    <span class="keyword">if</span> (!vis[v]) dfs1(v);</span><br><span class="line">  s.push_back(u);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">  color[u] = sccCnt;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> v : g2[u])</span><br><span class="line">    <span class="keyword">if</span> (!color[v]) dfs2(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">kosaraju</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  sccCnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    <span class="keyword">if</span> (!vis[i]) dfs1(i);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i)</span><br><span class="line">    <span class="keyword">if</span> (!color[s[i]]) &#123;</span><br><span class="line">      ++sccCnt;</span><br><span class="line">      dfs2(s[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>我们可以将一张图的每个强连通分量都缩成一个点，然后这张图会变成一个有向无环图</p>
</blockquote>
<h3 id="强连通分量的-Tarjan-算法"><a href="#强连通分量的-Tarjan-算法" class="headerlink" title="强连通分量的 Tarjan 算法"></a>强连通分量的 Tarjan 算法</h3><h3 id="二分图的匈牙利算法：dfs-硬搞"><a href="#二分图的匈牙利算法：dfs-硬搞" class="headerlink" title="二分图的匈牙利算法：dfs 硬搞"></a>二分图的匈牙利算法：dfs 硬搞</h3><h3 id="Kirchhoff-矩阵树定理：解决了一张图的生成树个数计数问题"><a href="#Kirchhoff-矩阵树定理：解决了一张图的生成树个数计数问题" class="headerlink" title="Kirchhoff 矩阵树定理：解决了一张图的生成树个数计数问题"></a>Kirchhoff 矩阵树定理：解决了一张图的生成树个数计数问题</h3><h2 id="生成函数"><a href="#生成函数" class="headerlink" title="生成函数"></a>生成函数</h2><p>在 codeforces 上 <code>zscoder</code> 大佬给了一个 <a href="https://codeforces.com/blog/entry/77468" target="_blank" rel="noopener">入门教程</a> 和 <a href="https://codeforces.com/blog/entry/77551" target="_blank" rel="noopener">进阶教程</a> 还有 <code>MiFaFaOvO</code> 的 <a href="https://codeforces.com/blog/entry/76447" target="_blank" rel="noopener">终极教程</a></p>
<p>生成函数分两种：Original generating function，Expentional generating function，选择哪一种是看问题中是否牵扯组合数。无论哪一种都能保存原数列的全部信息，并且由于级数可以使用微积分和常微分方程的技术，所以会变得更好处理。然后大概率可以优化算法复杂度 $O(n^2) \to O(n \log n)$ </p>
<p>关于生成函数多项式的处理：<a href="https://cp-algorithms.com/algebra/polynomial.html" target="_blank" rel="noopener">https://cp-algorithms.com/algebra/polynomial.html</a></p>
<p>多项式高效运算模板：<a href="https://github.com/e-maxx-eng/e-maxx-eng-aux/blob/master/src/polynomial.cpp" target="_blank" rel="noopener">https://github.com/e-maxx-eng/e-maxx-eng-aux/blob/master/src/polynomial.cpp</a></p>
<p><strong>生成函数一般的处理思路</strong>：计算生成函数，分解成有分母不超过二次的分式之和，然后每一个二次的分母部分找一个递推数列来搞定。</p>
<p><a href="https://oi-wiki.org/math/poly/intro/" target="_blank" rel="noopener">OI-wiki 多项式运算</a></p>
<h2 id="耻辱记录"><a href="#耻辱记录" class="headerlink" title="耻辱记录"></a>耻辱记录</h2><ul>
<li>2020/5/24 水题竟然也能被卡，傻子吧我！</li>
<li>被 <code>lower_bound</code> 坑了，也怪自己，<code>lower_bound(a.begin(),a.end(),x)-a</code> ：对于单调递增的序列，返回第一个大于等于<code>x</code>的序号。<code>upper_bound</code> 返回的是第一个大于 <code>x</code> 的序号，所以讲道理，upper_bound 更好用！</li>
<li>2020/6/1 低级错误，把 <code>int</code> 型变量放在 <code>bool</code> 型后面定义了！结果找了半天的错误！！导致少做一题。给了自己几巴掌</li>
<li><a href="https://codeforces.com/contest/1379" target="_blank" rel="noopener">Codeforces Round #657 (Div. 2)</a>：只做了一题？？？被 A 题卡了一个多小时？？？</li>
<li><a href="https://codeforces.com/contest/1397" target="_blank" rel="noopener">Codeforces Round #666 (Div. 2)</a>：犯了一堆低级错误</li>
<li><a href="https://codeforces.com/contest/1407" target="_blank" rel="noopener">Codeforces Round #669 (Div. 2)</a>：由读题引发的一系列低级错误！</li>
<li><a href="https://codeforces.com/contest/1438" target="_blank" rel="noopener">Codeforces Round #682 (Div. 2)</a>：10 分钟后没过题，被 C 卡了！！！不定闹钟的坏处！</li>
<li><a href="https://codeforces.com/contest/1456" target="_blank" rel="noopener">Codeforces Round #687 (Div. 1, based on Technocup 2021 Elimination Round 2)</a>：首场 Div1，惨败（跟 jiangly 分到一个 room），还被人 hack 了！</li>
<li><a href="https://codeforces.com/contest/1461" target="_blank" rel="noopener">Codeforces Round #689 (Div. 2, based on Zed Code Competition)</a>，又被 b 题卡，真的菜！</li>
</ul>
<h2 id="记录"><a href="#记录" class="headerlink" title="记录"></a>记录</h2><ul>
<li><a href="https://codeforces.com/contest/1428" target="_blank" rel="noopener">Codeforces Raif Round 1 (Div. 1 + Div. 2)</a> 是一场非常好，但是我没做好的一场比赛</li>
<li><a href="https://codeforces.com/contest/1366" target="_blank" rel="noopener">Educational Codeforces Round 89 (Rated for Div. 2)</a>：我竟然有做 5 题的实力！，但是因为网络原因我只做了 4 题。最后一个差一点，后面 1A 补上了。可惜。不过也还行加油！</li>
<li><a href="https://codeforces.com/contest/1367" target="_blank" rel="noopener">Codeforces Round #650 (Div. 3)</a>：第一次两小时内做 5 题，全部 1A，虽然是 div3！(竟然最后只加了 131 分)</li>
<li><a href="https://codeforces.com/contest/1370" target="_blank" rel="noopener">Codeforces Round #651 (Div. 2)</a>：唯一一次<del>不加不减</del>（过几小时之后它又减了我一分），但是，收获颇多的一次。</li>
<li><a href="https://codeforces.com/contest/1373" target="_blank" rel="noopener">Educational Codeforces Round 90 (Rated for Div. 2)</a>：做了 4 题，因为第五题没做出来，所以没交题！</li>
<li><a href="https://codeforces.com/contest/1371" target="_blank" rel="noopener">Codeforces Round #654 (Div. 2)</a>：好烦啊，又是结束后 5 分钟做出第五题。</li>
<li>目前，打字（代码）速度是限制我做 5 题的瓶颈！</li>
<li>提高码字速度，多总结，最近不要主动刷新题了。（2020/7/5)</li>
<li><a href="https://codeforces.com/contest/1251" target="_blank" rel="noopener">Educational Codeforces Round 75 (Rated for Div. 2)</a>: 第一次补完题目 （2020/7/9)</li>
<li><a href="https://codeforces.com/contest/1399" target="_blank" rel="noopener">Codeforces Round #661 (Div. 3)</a> 补完题目</li>
<li>图论，树上的问题也没那么可怕，就是麻烦点</li>
<li><a href="https://codeforces.com/contest/1430" target="_blank" rel="noopener">Educational Codeforces Round 96 (Rated for Div2)</a>：第一次 Div2 做 5 题，但是因为提交问题和低级错误，导致用时太久从而没有一个好的排名。</li>
<li><a href="https://codeforces.com/contest/1447" target="_blank" rel="noopener">Code(forces Round #683 (Div. 2, by Meet IT)</a>：首次进前 100</li>
<li><a href="https://codeforces.com/contest/1440" target="_blank" rel="noopener">Codeforces Round #684 (Div. 2)</a>：首次成为 Candidate Master</li>
<li><a href="https://codeforces.com/contest/1462" target="_blank" rel="noopener">Codeforces Round #690 (Div. 3)</a>: 1:39:54 AK</li>
<li><a href="https://codeforces.com/contest/1465" target="_blank" rel="noopener">Codeforces Round #692 (Div. 2, based on Technocup 2021 Elimination Round 3)</a> 第 47 名，首次进前 50。</li>
<li><a href="https://codeforces.com/contest/1466" target="_blank" rel="noopener">Good Bye 2020</a>：被一道简单的 DP C 题，卡了一个小时最后也没搞定，吐了。</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">dna049</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://dna049.com/codeforces/">https://dna049.com/codeforces/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://dna049.com" target="_blank">dna049</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Math/">Math</a><a class="post-meta__tags" href="/tags/C/">C++</a><a class="post-meta__tags" href="/tags/Codeforces/">Codeforces</a><a class="post-meta__tags" href="/tags/%E5%9B%BE%E8%AE%BA/">图论</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/08/31/3K2pQYJoyl81Cwf.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/rewardAlipay.png" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/rewardAlipay.png" alt="下次"/></a><div class="post-qr-code-desc">下次</div></li><li class="reward-item"><a href="/img/rewardWechat.png" target="_blank"><img class="post-qr-code-img" data-lazy-src="/img/rewardWechat.png" alt="一定"/></a><div class="post-qr-code-desc">一定</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/quadraticModEquation/"><img class="prev-cover" data-lazy-src="https://i.loli.net/2020/08/31/3K2pQYJoyl81Cwf.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">$x^2 \equiv a \mod n$ 何时有解</div></div></a></div><div class="next-post pull-right"><a href="/dynamicProgramming/"><img class="next-cover" data-lazy-src="https://i.loli.net/2020/08/31/3K2pQYJoyl81Cwf.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">动态规划</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/simplex/" title="线性规划的单纯形法"><img class="relatedPosts_cover" data-lazy-src="https://i.loli.net/2020/08/31/3K2pQYJoyl81Cwf.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-06</div><div class="relatedPosts_title">线性规划的单纯形法</div></div></a></div><div class="relatedPosts_item"><a href="/nft/" title="快速数论变换"><img class="relatedPosts_cover" data-lazy-src="https://i.loli.net/2020/08/31/3K2pQYJoyl81Cwf.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-06-02</div><div class="relatedPosts_title">快速数论变换</div></div></a></div><div class="relatedPosts_item"><a href="/dynamicProgramming/" title="动态规划"><img class="relatedPosts_cover" data-lazy-src="https://i.loli.net/2020/08/31/3K2pQYJoyl81Cwf.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-21</div><div class="relatedPosts_title">动态规划</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="utterances-wrap"></div></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"> <div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="https://hexo.io/" target="_blank" title="由 Hexo 强力驱动" data-pjax-state=""><span class="badge-subject">Powered</span><span class="badge-value bg-blue">Hexo</span></a></div><div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="https://github.com/chachabai/hexo-theme-butterfly" target="_blank" title="主题" data-pjax-state=""><span class="badge-subject">Theme</span><span class="badge-value bg-blueviolet">Butterfly</span></a></div><div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="https://github.com/" target="_blank" title="静态网页托管于 GitHub Pages 和 Coding Pages" data-pjax-state=""><span class="badge-subject">Hosted</span><span class="badge-value bg-brightgreen">GitHub</span></a></div><div class="footer_custom_text"></div><div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="/" target="_blank" title="运行时间" data-pjax-state=""><span class="badge-subject">Since</span><span class="badge-value bg-orange">2015</span></a></div><div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="/" target="_blank" title="本人博客" data-pjax-state=""><span class="badge-subject">Author</span><span class="badge-value bg-gradient">dna049</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  var script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    $.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js', function () {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script><script>function loadUtterances () {
  let ele = document.createElement('script')
  ele.setAttribute('id', 'utterances_comment')
  ele.setAttribute('src', 'https://utteranc.es/client.js')
  ele.setAttribute('repo', 'chachabai/chachabai.github.io')
  ele.setAttribute('issue-term', 'pathname')
  let nowTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'photon-dark' : 'github-light'
  ele.setAttribute('theme', nowTheme)
  ele.setAttribute('crossorigin', 'anonymous')
  ele.setAttribute('async', 'true')
  document.getElementById('utterances-wrap').insertAdjacentElement('afterbegin',ele)
}

function utterancesTheme () {
  if (document.querySelector('.utterances-frame')) {
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'photon-dark' : 'github-light'
    const message = {
      type: 'set-theme',
      theme: theme
    };
    const iframe = document.querySelector('.utterances-frame');
    iframe.contentWindow.postMessage(message, 'https://utteranc.es');
  }
}

if ('Utterances' === 'Utterances' || !false) {
  if (false) loadComment(document.getElementById('utterances-wrap'), loadUtterances)
  else loadUtterances()
} else {
  function loadOtherComment () {
    loadUtterances()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script data-pjax src="https://cdn.jsdelivr.net/gh/Justlovesmile/CDN@latest/js/fish.js"></script><script src="/js/third-party/click_heart.js" async="async"></script><script src="/js/third-party/ClickShowText.js" async="async"></script></div></body></html>